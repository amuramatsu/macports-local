--- texk/xdvik/AJ16.c.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/AJ16.c
@@ -0,0 +1,2338 @@
+/*
+
+Copyright (c) 2011-2013 Hironori KITAGAWA
+
+Permission is hereby granted, free of charge, to any person obtaining
+a copy of this software and associated documentation files (the
+"Software"), to deal in the Software without restriction, including
+without limitation the rights to use, copy, modify, merge, publish,
+distribute, sublicense, and/or sell copies of the Software, and to
+permit persons to whom the Software is furnished to do so, subject to
+the following conditions:
+
+The above copyright notice and this permission notice shall be
+included in all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
+LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
+OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
+WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+
+*/
+
+/* This file was generated by tounimap2h.lua.
+Used ToUnicode table is: Adobe-Japan1-UCS2.*/
+
+static unsigned short AJ162uni_table[] = {
+  65533, 32, 33, 34, 35, 36, 37, 38, 39, 40, 
+  41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 
+  51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 
+  61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 
+  71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 
+  81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 
+  91, 165, 93, 94, 95, 96, 97, 98, 99, 100, 
+  101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 
+  111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 
+  121, 122, 123, 166, 125, 771, 8217, 92, 8216, 124, 
+  126, 161, 162, 163, 8260, 402, 167, 164, 8220, 171, 
+  8249, 8250, 64257, 64258, 8210, 8224, 8225, 183, 182, 8226, 
+  8218, 8222, 8221, 187, 8230, 8240, 191, 769, 770, 175, 
+  774, 775, 776, 778, 184, 779, 808, 780, 822, 198, 
+  170, 321, 216, 338, 186, 230, 305, 322, 248, 339, 
+  223, 45, 169, 172, 174, 176, 177, 178, 179, 181, 
+  185, 188, 189, 190, 192, 193, 194, 195, 196, 197, 
+  199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 
+  209, 210, 211, 212, 213, 214, 215, 217, 218, 219, 
+  220, 221, 222, 224, 225, 226, 227, 228, 229, 231, 
+  232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 
+  242, 243, 244, 245, 246, 247, 249, 250, 251, 252, 
+  253, 254, 255, 352, 376, 381, 773, 353, 8482, 382, 
+  48, 32, 33, 34, 35, 36, 37, 38, 39, 40, 
+  41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 
+  51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 
+  61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 
+  71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 
+  81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 
+  91, 165, 93, 94, 95, 96, 97, 98, 99, 100, 
+  101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 
+  111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 
+  121, 122, 123, 124, 125, 8254, 65376, 65377, 65378, 65379, 
+  65380, 65381, 65382, 65383, 65384, 65385, 65386, 65387, 65388, 65389, 
+  65390, 65391, 65392, 65393, 65394, 65395, 65396, 65397, 65398, 65399, 
+  65400, 65401, 65402, 65403, 65404, 65405, 65406, 65407, 65408, 65409, 
+  65410, 65411, 65412, 65413, 65414, 65415, 65416, 65417, 65418, 65419, 
+  65420, 65421, 65422, 65423, 65424, 65425, 65426, 65427, 65428, 65429, 
+  65430, 65431, 65432, 65433, 65434, 65435, 65436, 65437, 65438, 65439, 
+  65344, 12528, 12529, 12526, 12459, 12465, 12532, 12460, 12462, 12464, 
+  12466, 12468, 12470, 12472, 12474, 12476, 12478, 12480, 12482, 12485, 
+  12487, 12489, 12496, 12497, 12499, 12500, 12502, 12503, 12505, 12506, 
+  12508, 12509, 65376, 12317, 12318, 9472, 9473, 9474, 9475, 9476, 
+  9477, 9478, 9479, 9480, 9481, 9482, 9483, 9484, 9485, 9486, 
+  9487, 9488, 9489, 9490, 9491, 9492, 9493, 9494, 9495, 9496, 
+  9497, 9498, 9499, 9500, 9501, 9502, 9503, 9504, 9505, 9506, 
+  9507, 9508, 9509, 9510, 9511, 9512, 9513, 9514, 9515, 9516, 
+  9517, 9518, 9519, 9520, 9521, 9522, 9523, 9524, 9525, 9526, 
+  9527, 9528, 9529, 9530, 9531, 9532, 9533, 9534, 9535, 9536, 
+  9537, 9538, 9539, 9540, 9541, 9542, 9543, 9544, 9545, 9546, 
+  9547, 8242, 168, 8246, 91, 93, 12296, 12297, 12298, 12299, 
+  12302, 12303, 12304, 12305, 8210, 65376, 12434, 12353, 12355, 12357, 
+  12359, 12361, 12419, 12421, 12423, 12387, 12354, 12356, 12358, 12360, 
+  12362, 12363, 12365, 12367, 12369, 12371, 12373, 12375, 12377, 12379, 
+  12381, 12383, 12385, 12388, 12390, 12392, 12394, 12395, 12396, 12397, 
+  12398, 12399, 12402, 12405, 12408, 12411, 12414, 12415, 12416, 12417, 
+  12418, 12420, 12422, 12424, 12425, 12426, 12427, 12428, 12429, 12431, 
+  12435, 12432, 12433, 12430, 12364, 12366, 12368, 12370, 12372, 12374, 
+  12392, 12378, 12380, 12382, 12384, 12386, 12389, 12391, 12393, 12400, 
+  12401, 12403, 12404, 12406, 12407, 12409, 12410, 12412, 12413, 196, 
+  249, 233, 237, 223, 231, 199, 209, 241, 162, 163, 
+  243, 250, 161, 191, 189, 214, 220, 228, 235, 239, 
+  246, 220, 226, 234, 238, 244, 252, 224, 233, 9650, 
+  225, 126, 48, 12288, 12289, 12290, 65292, 65294, 12539, 65306, 
+  65307, 65311, 65281, 12443, 12444, 180, 65344, 168, 65342, 8254, 
+  65343, 12541, 12542, 12445, 12446, 12291, 20189, 12293, 12294, 12295, 
+  12540, 8213, 8208, 65295, 65340, 65374, 8214, 65372, 8230, 8229, 
+  8216, 8217, 8220, 8221, 65288, 65289, 12308, 12309, 65339, 65341, 
+  65371, 65373, 12296, 12297, 12298, 12299, 12300, 12301, 12302, 12303, 
+  12304, 12305, 65291, 65293, 177, 215, 247, 65309, 8800, 65308, 
+  65310, 8806, 8807, 8734, 8756, 9794, 9792, 176, 8242, 8243, 
+  8451, 65509, 65284, 162, 163, 65285, 65283, 65286, 65290, 65312, 
+  167, 9734, 9733, 9675, 9679, 9678, 9671, 9670, 9633, 9632, 
+  9651, 9650, 9661, 9660, 8251, 12306, 8594, 8592, 8593, 8595, 
+  12307, 8712, 8715, 8838, 8839, 8834, 8835, 8746, 8745, 8743, 
+  8744, 172, 8658, 8660, 8704, 8707, 8736, 8869, 8978, 8706, 
+  8711, 8801, 8786, 8810, 8811, 8730, 8765, 8733, 8757, 8747, 
+  8748, 8491, 8240, 9839, 9837, 9834, 8224, 8225, 182, 9711, 
+  65296, 65297, 65298, 65299, 65300, 65301, 65302, 65303, 65304, 65305, 
+  65313, 65314, 65315, 65316, 65317, 65318, 65319, 65320, 65321, 65322, 
+  65323, 65324, 65325, 65326, 65327, 65328, 65329, 65330, 65331, 65332, 
+  65333, 65334, 65335, 65336, 65337, 65338, 65345, 65346, 65347, 65348, 
+  65349, 65350, 65351, 65352, 65353, 65354, 65355, 65356, 65357, 65358, 
+  65359, 65360, 65361, 65362, 65363, 65364, 65365, 65366, 65367, 65368, 
+  65369, 65370, 12353, 12354, 12355, 12356, 12357, 12358, 12359, 12360, 
+  12361, 12362, 12363, 12364, 12365, 12366, 12367, 12368, 12369, 12370, 
+  12371, 12372, 12373, 12374, 12375, 12376, 12377, 12378, 12379, 12380, 
+  12381, 12382, 12383, 12384, 12385, 12386, 12387, 12388, 12389, 12390, 
+  12391, 12392, 12393, 12394, 12395, 12396, 12397, 12398, 12399, 12400, 
+  12401, 12402, 12403, 12404, 12405, 12406, 12407, 12408, 12409, 12410, 
+  12411, 12412, 12413, 12414, 12415, 12416, 12417, 12418, 12419, 12420, 
+  12421, 12422, 12423, 12424, 12425, 12426, 12427, 12428, 12429, 12430, 
+  12431, 12432, 12433, 12434, 12435, 12449, 12450, 12451, 12452, 12453, 
+  12454, 12455, 12456, 12457, 12458, 12459, 12460, 12461, 12462, 12463, 
+  12464, 12465, 12466, 12467, 12468, 12469, 12470, 12471, 12472, 12473, 
+  12474, 12475, 12476, 12477, 12478, 12479, 12480, 12481, 12482, 12483, 
+  12484, 12485, 12486, 12487, 12488, 12489, 12490, 12491, 12492, 12493, 
+  12494, 12495, 12496, 12497, 12498, 12499, 12500, 12501, 12502, 12503, 
+  12504, 12505, 12506, 12507, 12508, 12509, 12510, 12511, 12512, 12513, 
+  12514, 12515, 12516, 12517, 12518, 12519, 12520, 12521, 12522, 12523, 
+  12524, 12525, 12526, 12527, 12528, 12529, 12530, 12531, 12532, 12533, 
+  12534, 913, 914, 915, 916, 917, 918, 919, 920, 921, 
+  922, 923, 924, 925, 926, 927, 928, 929, 931, 932, 
+  933, 934, 935, 936, 937, 945, 946, 947, 948, 949, 
+  950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 
+  960, 961, 963, 964, 965, 966, 967, 968, 969, 1040, 
+  1041, 1042, 1043, 1044, 1045, 1025, 1046, 1047, 1048, 1049, 
+  1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 
+  1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 
+  1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1105, 1078, 
+  1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 
+  1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 
+  1099, 1100, 1101, 1102, 1103, 20124, 21782, 23043, 38463, 21696, 
+  24859, 25384, 23030, 36898, 33909, 33564, 31312, 24746, 25569, 28197, 
+  26093, 33894, 33446, 39925, 26771, 22311, 26017, 25201, 23451, 22992, 
+  34427, 39156, 32098, 32190, 39822, 25110, 31903, 34999, 23433, 24245, 
+  25353, 26263, 26696, 38343, 38797, 26447, 20197, 20234, 20301, 20381, 
+  20553, 22258, 22839, 22996, 23041, 23561, 24799, 24847, 24944, 26131, 
+  26885, 28858, 30031, 30064, 31227, 32173, 32239, 32963, 33806, 34915, 
+  35586, 36949, 36986, 21307, 20117, 20133, 22495, 32946, 37057, 30959, 
+  19968, 22769, 28322, 36920, 31282, 33576, 33419, 39983, 20801, 21360, 
+  21693, 21729, 22240, 23035, 24341, 39154, 28139, 32996, 34093, 38498, 
+  38512, 38560, 38907, 21515, 21491, 23431, 28879, 32701, 36802, 38632, 
+  21359, 40284, 31418, 19985, 30867, 33276, 28198, 22040, 21764, 27421, 
+  34074, 39995, 23013, 21417, 28006, 29916, 38287, 22082, 20113, 36939, 
+  38642, 33615, 39180, 21473, 21942, 23344, 24433, 26144, 26355, 26628, 
+  27704, 27891, 27945, 29787, 30408, 31310, 38964, 33521, 34907, 35424, 
+  37613, 28082, 30123, 30410, 39365, 24742, 35585, 36234, 38322, 27022, 
+  21421, 20870, 22290, 22576, 22852, 23476, 24310, 24616, 25513, 25588, 
+  27839, 28436, 28814, 28948, 29017, 29141, 29503, 32257, 33398, 33489, 
+  34199, 36960, 37467, 40219, 22633, 26044, 27738, 29989, 20985, 22830, 
+  22885, 24448, 24540, 25276, 26106, 27178, 27431, 27572, 29579, 32705, 
+  35158, 40236, 40206, 40644, 23713, 27798, 33659, 20740, 23627, 25014, 
+  33222, 26742, 29281, 20057, 20474, 21368, 24681, 28201, 31311, 38899, 
+  19979, 21270, 20206, 20309, 20285, 20385, 20339, 21152, 21487, 22025, 
+  22799, 23233, 23478, 23521, 31185, 26247, 26524, 26550, 27468, 27827, 
+  28779, 29634, 31117, 31166, 31292, 31623, 33457, 33499, 33540, 33655, 
+  33775, 33747, 34662, 35506, 22057, 36008, 36838, 36942, 38686, 34442, 
+  20420, 23784, 25105, 29273, 30011, 33253, 33469, 34558, 36032, 38597, 
+  39187, 39381, 20171, 20250, 35299, 22238, 22602, 22730, 24315, 24555, 
+  24618, 24724, 24674, 25040, 25106, 25296, 25913, 39745, 26214, 26800, 
+  28023, 28784, 30028, 30342, 32117, 33445, 34809, 38283, 38542, 35997, 
+  20977, 21182, 22806, 21683, 23475, 23830, 24936, 27010, 28079, 30861, 
+  33995, 34903, 35442, 37799, 39608, 28012, 39336, 34521, 22435, 26623, 
+  34510, 37390, 21123, 22151, 21508, 24275, 25313, 25785, 26684, 26680, 
+  27579, 29554, 30906, 31339, 35226, 35282, 36203, 36611, 37101, 38307, 
+  38548, 38761, 23398, 23731, 27005, 38989, 38990, 25499, 31520, 27179, 
+  27263, 26806, 39949, 28511, 21106, 21917, 24688, 25324, 27963, 28167, 
+  28369, 33883, 35088, 36676, 19988, 39993, 21494, 26907, 27194, 38788, 
+  26666, 20828, 31427, 33970, 37340, 37772, 22107, 40232, 26658, 33541, 
+  33841, 31909, 21000, 33477, 29926, 20094, 20355, 20896, 23506, 21002, 
+  21208, 21223, 24059, 21914, 22570, 23014, 23436, 23448, 23515, 24178, 
+  24185, 24739, 24863, 24931, 25022, 25563, 25954, 26577, 26707, 26874, 
+  27454, 27475, 27735, 28450, 28567, 28485, 29872, 29976, 30435, 30475, 
+  31487, 31649, 31777, 32233, 32566, 32752, 32925, 33382, 33694, 35251, 
+  35532, 36011, 36996, 37969, 38291, 38289, 38306, 38501, 38867, 39208, 
+  33304, 20024, 21547, 23736, 24012, 29609, 30284, 30524, 23721, 32747, 
+  36107, 38593, 38929, 38996, 39000, 20225, 20238, 21361, 21916, 22120, 
+  22522, 22855, 23305, 23492, 23696, 24076, 24190, 24524, 25582, 26426, 
+  26071, 26082, 26399, 26827, 26820, 27231, 24112, 27589, 27671, 27773, 
+  30079, 31048, 23395, 31232, 32000, 24509, 35215, 35352, 36020, 36215, 
+  36556, 36637, 39138, 39438, 39740, 20096, 20605, 20736, 22931, 23452, 
+  25135, 25216, 25836, 27450, 29344, 30097, 31047, 32681, 34811, 35516, 
+  35696, 25516, 33738, 38816, 21513, 21507, 21931, 26708, 27224, 35440, 
+  30759, 26485, 40653, 21364, 23458, 33050, 34384, 36870, 19992, 20037, 
+  20167, 20241, 21450, 21560, 23470, 24339, 24613, 25937, 26429, 27714, 
+  27762, 27875, 28792, 29699, 31350, 31406, 31496, 32026, 31998, 32102, 
+  26087, 29275, 21435, 23621, 24040, 25298, 25312, 25369, 28192, 34394, 
+  35377, 36317, 37624, 28417, 31142, 39770, 20136, 20139, 20140, 20379, 
+  20384, 20689, 20807, 31478, 20849, 20982, 21332, 21281, 21375, 21483, 
+  21932, 22659, 23777, 24375, 24394, 24623, 24656, 24685, 25375, 25945, 
+  27211, 27841, 29378, 29421, 30703, 33016, 33029, 33288, 34126, 37111, 
+  37857, 38911, 39255, 39514, 20208, 20957, 23597, 26241, 26989, 23616, 
+  26354, 26997, 29577, 26704, 31873, 20677, 21220, 22343, 24062, 37670, 
+  26020, 27427, 27453, 29748, 31105, 31165, 31563, 32202, 33465, 33740, 
+  34943, 35167, 35641, 36817, 37329, 21535, 37504, 20061, 20534, 21477, 
+  21306, 29399, 29590, 30697, 33510, 36527, 39366, 39368, 39378, 20855, 
+  24858, 34398, 21936, 31354, 20598, 23507, 36935, 38533, 20018, 27355, 
+  37351, 23633, 23624, 25496, 31391, 27795, 38772, 36705, 31402, 29066, 
+  38536, 31874, 26647, 32368, 26705, 37740, 21234, 21531, 34219, 35347, 
+  32676, 36557, 37089, 21350, 34952, 31041, 20418, 20670, 21009, 20804, 
+  21843, 22317, 29674, 22411, 22865, 24418, 24452, 24693, 24950, 24935, 
+  25001, 25522, 25658, 25964, 26223, 26690, 28179, 30054, 31293, 31995, 
+  32076, 32153, 32331, 32619, 33550, 33610, 34509, 35336, 35427, 35686, 
+  36605, 38938, 40335, 33464, 36814, 39912, 21127, 25119, 25731, 28608, 
+  38553, 26689, 20625, 27424, 27770, 28500, 31348, 32080, 34880, 35363, 
+  26376, 20214, 20537, 20518, 20581, 20860, 21048, 21091, 21927, 22287, 
+  22533, 23244, 24314, 25010, 25080, 25331, 25458, 26908, 27177, 29309, 
+  29356, 29486, 30740, 30831, 32121, 30476, 32937, 35211, 35609, 36066, 
+  36562, 36963, 37749, 38522, 38997, 39443, 40568, 20803, 21407, 21427, 
+  24187, 24358, 28187, 28304, 29572, 29694, 32067, 33335, 35328, 35578, 
+  38480, 20046, 20491, 21476, 21628, 22266, 22993, 23396, 24049, 24235, 
+  24359, 25144, 25925, 26543, 28246, 29392, 31946, 34996, 32929, 32993, 
+  33776, 34382, 35463, 36328, 37431, 38599, 39015, 40723, 20116, 20114, 
+  20237, 21320, 21577, 21566, 23087, 24460, 24481, 24735, 26791, 27278, 
+  29786, 30849, 35486, 35492, 35703, 37264, 20062, 39881, 20132, 20348, 
+  20399, 20505, 20502, 20809, 20844, 21151, 21177, 21246, 21402, 21475, 
+  21521, 21518, 21897, 22353, 22434, 22909, 23380, 23389, 23439, 24037, 
+  24039, 24055, 24184, 24195, 24218, 24247, 24344, 24658, 24908, 25239, 
+  25304, 25511, 25915, 26114, 26179, 26356, 26477, 26657, 26775, 27083, 
+  27743, 27946, 28009, 28207, 28317, 30002, 30343, 30828, 31295, 31968, 
+  32005, 32024, 32094, 32177, 32789, 32771, 32943, 32945, 33108, 33167, 
+  33322, 33618, 34892, 34913, 35611, 36002, 36092, 37066, 37237, 37489, 
+  30783, 37628, 38308, 38477, 38917, 39321, 39640, 40251, 21083, 21163, 
+  21495, 21512, 22741, 25335, 28640, 35946, 36703, 40633, 20811, 21051, 
+  21578, 22269, 31296, 37239, 40288, 40658, 29508, 28425, 33136, 29969, 
+  24573, 24794, 39592, 29403, 36796, 27492, 38915, 20170, 22256, 22372, 
+  22718, 23130, 24680, 25031, 26127, 26118, 26681, 26801, 28151, 30165, 
+  32058, 33390, 39746, 20123, 20304, 21449, 21766, 23919, 24038, 24046, 
+  26619, 27801, 29811, 30722, 35408, 37782, 35039, 22352, 24231, 25387, 
+  20661, 20652, 20877, 26368, 21705, 22622, 22971, 23472, 24425, 25165, 
+  25505, 26685, 27507, 28168, 28797, 37319, 29312, 30741, 30758, 31085, 
+  25998, 32048, 33756, 35009, 36617, 38555, 21092, 22312, 26448, 32618, 
+  36001, 20916, 22338, 38442, 22586, 27018, 32948, 21682, 23822, 22524, 
+  30869, 40442, 20316, 21066, 21643, 25662, 26152, 26388, 26613, 31364, 
+  31574, 32034, 37679, 26716, 39853, 31545, 21273, 20874, 21047, 23519, 
+  25334, 25774, 25830, 26413, 27578, 34217, 38609, 30352, 39894, 25420, 
+  37638, 39851, 30399, 26194, 19977, 20632, 21442, 23665, 24808, 25746, 
+  25955, 26719, 29158, 29642, 29987, 31639, 32386, 34453, 35715, 36059, 
+  37240, 39184, 26028, 26283, 27531, 20181, 20180, 20282, 20351, 21050, 
+  21496, 21490, 21987, 22235, 22763, 22987, 22985, 23039, 23376, 23629, 
+  24066, 24107, 24535, 24605, 25351, 25903, 23388, 26031, 26045, 26088, 
+  26525, 27490, 27515, 27663, 29509, 31049, 31169, 31992, 32025, 32043, 
+  32930, 33026, 33267, 35222, 35422, 35433, 35430, 35468, 35566, 36039, 
+  36060, 38604, 39164, 27503, 20107, 20284, 20365, 20816, 23383, 23546, 
+  24904, 25345, 26178, 27425, 28363, 27835, 29246, 29885, 30164, 30913, 
+  31034, 32780, 32819, 33258, 33940, 36766, 27728, 40575, 24335, 35672, 
+  40235, 31482, 36600, 23437, 38635, 19971, 21489, 22519, 22833, 23241, 
+  23460, 24713, 28287, 28422, 30142, 36074, 23455, 34048, 31712, 20594, 
+  26612, 33437, 23649, 34122, 32286, 33294, 20889, 23556, 25448, 36198, 
+  26012, 29038, 31038, 32023, 32773, 35613, 36554, 36974, 34503, 37034, 
+  20511, 21242, 23610, 26451, 28796, 29237, 37196, 37320, 37675, 33509, 
+  23490, 24369, 24825, 20027, 21462, 23432, 25163, 26417, 27530, 29417, 
+  29664, 31278, 33131, 36259, 37202, 39318, 20754, 21463, 21610, 23551, 
+  25480, 27193, 32172, 38656, 22234, 21454, 21608, 23447, 23601, 24030, 
+  20462, 24833, 25342, 27954, 31168, 31179, 32066, 32333, 32722, 33261, 
+  33311, 33936, 34886, 35186, 35728, 36468, 36655, 36913, 37195, 37228, 
+  38598, 37276, 20160, 20303, 20805, 21313, 24467, 25102, 26580, 27713, 
+  28171, 29539, 32294, 37325, 37507, 21460, 22809, 23487, 28113, 31069, 
+  32302, 31899, 22654, 29087, 20986, 34899, 36848, 20426, 23803, 26149, 
+  30636, 31459, 33308, 39423, 20934, 24490, 26092, 26991, 27529, 28147, 
+  28310, 28516, 30462, 32020, 24033, 36981, 37255, 38918, 20966, 21021, 
+  25152, 26257, 26329, 28186, 24246, 32210, 32626, 26360, 34223, 34295, 
+  35576, 21161, 21465, 22899, 24207, 24464, 24661, 37604, 38500, 20663, 
+  20767, 21213, 21280, 21319, 21484, 21736, 21830, 21809, 22039, 22888, 
+  22974, 23100, 23477, 23558, 23567, 23569, 23578, 24196, 24202, 24288, 
+  24432, 25215, 25220, 25307, 25484, 25463, 26119, 26124, 26157, 26230, 
+  26494, 26786, 27167, 27189, 27836, 28040, 28169, 28248, 28988, 28966, 
+  29031, 30151, 30465, 30813, 30977, 31077, 31216, 31456, 31505, 31911, 
+  32057, 32918, 33750, 33931, 34121, 34909, 35059, 35359, 35388, 35412, 
+  35443, 35937, 36062, 37284, 37478, 37758, 37912, 38556, 38808, 19978, 
+  19976, 19998, 20055, 20887, 21104, 22478, 22580, 22732, 23330, 24120, 
+  24773, 25854, 26465, 26454, 27972, 29366, 30067, 31331, 33976, 35698, 
+  37304, 37664, 22065, 22516, 39166, 25325, 26893, 27542, 29165, 32340, 
+  32887, 33394, 35302, 39135, 34645, 36785, 23611, 20280, 20449, 20405, 
+  21767, 23072, 23517, 23529, 24515, 24910, 25391, 26032, 26187, 26862, 
+  27035, 28024, 28145, 30003, 30137, 30495, 31070, 31206, 32051, 33251, 
+  33455, 34218, 35242, 35386, 36523, 36763, 36914, 37341, 38663, 20154, 
+  20161, 20995, 22645, 22764, 23563, 29978, 23613, 33102, 35338, 36805, 
+  38499, 38765, 31525, 35535, 38920, 37218, 22259, 21416, 36887, 21561, 
+  22402, 24101, 25512, 27700, 28810, 30561, 31883, 32736, 34928, 36930, 
+  37204, 37648, 37656, 38543, 29790, 39620, 23815, 23913, 25968, 26530, 
+  36264, 38619, 25454, 26441, 26905, 33733, 38935, 38592, 35070, 28548, 
+  25722, 23544, 19990, 28716, 30045, 26159, 20932, 21046, 21218, 22995, 
+  24449, 24615, 25104, 25919, 25972, 26143, 26228, 26866, 26646, 27491, 
+  28165, 29298, 29983, 30427, 31934, 32854, 22768, 35069, 35199, 35488, 
+  35475, 35531, 36893, 37266, 38738, 38745, 25993, 31246, 33030, 38587, 
+  24109, 24796, 25114, 26021, 26132, 26512, 30707, 31309, 31821, 32318, 
+  33034, 36012, 36196, 36321, 36447, 30889, 20999, 25305, 25509, 25666, 
+  25240, 35373, 31363, 31680, 35500, 38634, 32118, 33292, 34633, 20185, 
+  20808, 21315, 21344, 23459, 23554, 23574, 24029, 25126, 25159, 25776, 
+  26643, 26676, 27849, 27973, 27927, 26579, 28508, 29006, 29053, 26059, 
+  31359, 31661, 32218, 32330, 32680, 33146, 33307, 33337, 34214, 35438, 
+  36046, 36341, 36984, 36983, 37549, 37521, 38275, 39854, 21069, 21892, 
+  28472, 28982, 20840, 31109, 32341, 33203, 31950, 22092, 22609, 23720, 
+  25514, 26366, 26365, 26970, 29401, 30095, 30094, 30990, 31062, 31199, 
+  31895, 32032, 32068, 34311, 35380, 38459, 36961, 40736, 20711, 21109, 
+  21452, 21474, 20489, 21930, 22766, 22863, 29245, 23435, 23652, 21277, 
+  24803, 24819, 25436, 25475, 25407, 25531, 25805, 26089, 26361, 24035, 
+  27085, 27133, 28437, 29157, 20105, 30185, 30456, 31379, 31967, 32207, 
+  32156, 32865, 33609, 33624, 33900, 33980, 34299, 35013, 36208, 36865, 
+  36973, 37783, 38684, 39442, 20687, 22679, 24974, 33235, 34101, 36104, 
+  36896, 20419, 20596, 21063, 21363, 24687, 25417, 26463, 28204, 36275, 
+  36895, 20439, 23646, 36042, 26063, 32154, 21330, 34966, 20854, 25539, 
+  23384, 23403, 23562, 25613, 26449, 36956, 20182, 22810, 22826, 27760, 
+  35409, 21822, 22549, 22949, 24816, 25171, 26561, 33333, 26965, 38464, 
+  39364, 39464, 20307, 22534, 23550, 32784, 23729, 24111, 24453, 24608, 
+  24907, 25140, 26367, 27888, 28382, 32974, 33151, 33492, 34955, 36024, 
+  36864, 36910, 38538, 40667, 39899, 20195, 21488, 22823, 31532, 37261, 
+  38988, 40441, 28381, 28711, 21331, 21828, 23429, 25176, 25246, 25299, 
+  27810, 28655, 29730, 35351, 37944, 28609, 35582, 33592, 20967, 34552, 
+  21482, 21481, 20294, 36948, 36784, 22890, 33073, 24061, 31466, 36799, 
+  26842, 35895, 29432, 40008, 27197, 35504, 20025, 21336, 22022, 22374, 
+  25285, 25506, 26086, 27470, 28129, 28251, 28845, 30701, 31471, 31658, 
+  32187, 32829, 32966, 34507, 35477, 37723, 22243, 22727, 24382, 26029, 
+  26262, 27264, 27573, 30007, 35527, 20516, 30693, 22320, 24347, 24677, 
+  26234, 27744, 30196, 31258, 32622, 33268, 34584, 36933, 39347, 31689, 
+  30044, 31481, 31569, 33988, 36880, 31209, 31378, 33590, 23265, 30528, 
+  20013, 20210, 23449, 24544, 25277, 26172, 26609, 27880, 34411, 34935, 
+  35387, 37198, 37619, 39376, 27159, 28710, 29482, 33511, 33879, 36015, 
+  19969, 20806, 20939, 21899, 23541, 24086, 24115, 24193, 24340, 24373, 
+  24427, 24500, 25074, 25361, 26274, 26397, 28526, 29266, 30010, 30522, 
+  32884, 33081, 33144, 34678, 35519, 35548, 36229, 36339, 37530, 38263, 
+  38914, 40165, 21189, 25431, 30452, 26389, 27784, 29645, 36035, 37806, 
+  38515, 27941, 22684, 26894, 27084, 36861, 37786, 30171, 36890, 22618, 
+  26626, 25524, 27131, 20291, 28460, 26584, 36795, 34086, 32180, 37716, 
+  26943, 28528, 22378, 22775, 23340, 32044, 29226, 21514, 37347, 40372, 
+  20141, 20302, 20572, 20597, 21059, 35998, 21576, 22564, 23450, 24093, 
+  24213, 24237, 24311, 24351, 24716, 25269, 25402, 25552, 26799, 27712, 
+  30855, 31118, 31243, 32224, 33351, 35330, 35558, 36420, 36883, 37048, 
+  37165, 37336, 40718, 27877, 25688, 25826, 25973, 28404, 30340, 31515, 
+  36969, 37841, 28346, 21746, 24505, 25764, 36685, 36845, 37444, 20856, 
+  22635, 22825, 23637, 24215, 28155, 32399, 29980, 36028, 36578, 39003, 
+  28857, 20253, 27583, 28593, 30000, 38651, 20814, 21520, 22581, 22615, 
+  22956, 23648, 24466, 26007, 26460, 28193, 30331, 33759, 36077, 36884, 
+  37117, 37709, 30757, 30778, 21162, 24230, 22303, 22900, 24594, 20498, 
+  20826, 20908, 20941, 20992, 21776, 22612, 22616, 22871, 23445, 23798, 
+  23947, 24764, 25237, 25645, 26481, 26691, 26812, 26847, 30423, 28120, 
+  28271, 28059, 28783, 29128, 24403, 30168, 31095, 31561, 31572, 31570, 
+  31958, 32113, 21040, 33891, 34153, 34276, 35342, 35588, 35910, 36367, 
+  36867, 36879, 37913, 38518, 38957, 39472, 38360, 20685, 21205, 21516, 
+  22530, 23566, 24999, 25758, 27934, 30643, 31461, 33012, 33796, 36947, 
+  37509, 23776, 40199, 21311, 24471, 24499, 28060, 29305, 30563, 31167, 
+  31716, 27602, 29420, 35501, 26627, 27233, 20984, 31361, 26932, 23626, 
+  40182, 33515, 23493, 37193, 28702, 22136, 23663, 24775, 25958, 27788, 
+  35930, 36929, 38931, 21585, 26311, 37389, 22856, 37027, 20869, 20045, 
+  20970, 34201, 35598, 28760, 25466, 37707, 26978, 39348, 32260, 30071, 
+  21335, 26976, 36575, 38627, 27741, 20108, 23612, 24336, 36841, 21250, 
+  36049, 32905, 34425, 24319, 26085, 20083, 20837, 22914, 23615, 38894, 
+  20219, 22922, 24525, 35469, 28641, 31152, 31074, 23527, 33905, 29483, 
+  29105, 24180, 24565, 25467, 25754, 29123, 31896, 20035, 24316, 20043, 
+  22492, 22178, 24745, 28611, 32013, 33021, 33075, 33215, 36786, 35223, 
+  34468, 24052, 25226, 25773, 35207, 26487, 27874, 27966, 29750, 30772, 
+  23110, 32629, 33453, 39340, 20467, 24259, 25309, 25490, 25943, 26479, 
+  30403, 29260, 32972, 32954, 36649, 37197, 20493, 22521, 23186, 26757, 
+  26995, 29028, 29437, 36023, 22770, 36064, 38506, 36889, 34687, 31204, 
+  30695, 33833, 20271, 21093, 21338, 25293, 26575, 27850, 30333, 31636, 
+  31893, 33334, 34180, 36843, 26333, 28448, 29190, 32283, 33707, 39361, 
+  40614, 20989, 31665, 30834, 31672, 32903, 31560, 27368, 24161, 32908, 
+  30033, 30048, 20843, 37474, 28300, 30330, 37271, 39658, 20240, 32624, 
+  25244, 31567, 38309, 40169, 22138, 22617, 34532, 38588, 20276, 21028, 
+  21322, 21453, 21467, 24070, 25644, 26001, 26495, 27710, 27726, 29256, 
+  29359, 29677, 30036, 32321, 33324, 34281, 36009, 31684, 37318, 29033, 
+  38930, 39151, 25405, 26217, 30058, 30436, 30928, 34115, 34542, 21290, 
+  21329, 21542, 22915, 24199, 24444, 24754, 25161, 25209, 25259, 26000, 
+  27604, 27852, 30130, 30382, 30865, 31192, 32203, 32631, 32933, 34987, 
+  35513, 36027, 36991, 38750, 39131, 27147, 31800, 20633, 23614, 24494, 
+  26503, 27608, 29749, 30473, 32654, 40763, 26570, 31255, 21305, 30091, 
+  39661, 24422, 33181, 33777, 32920, 24380, 24517, 30050, 31558, 36924, 
+  26727, 23019, 23195, 32016, 30334, 35628, 20469, 24426, 27161, 27703, 
+  28418, 29922, 31080, 34920, 35413, 35961, 24287, 25551, 30149, 31186, 
+  33495, 37672, 37618, 33948, 34541, 39981, 21697, 24428, 25996, 27996, 
+  28693, 36007, 36051, 38971, 25935, 29942, 19981, 20184, 22496, 22827, 
+  23142, 23500, 20904, 24067, 24220, 24598, 25206, 25975, 26023, 26222, 
+  28014, 29238, 31526, 33104, 33178, 33433, 35676, 36000, 36070, 36212, 
+  38428, 38468, 20398, 25771, 27494, 33310, 33889, 34154, 37096, 23553, 
+  26963, 39080, 33914, 34135, 20239, 21103, 24489, 24133, 26381, 31119, 
+  33145, 35079, 35206, 28149, 24343, 25173, 27832, 20175, 29289, 39826, 
+  20998, 21563, 22132, 22707, 24996, 25198, 28954, 22894, 31881, 31966, 
+  32027, 38640, 25991, 32862, 19993, 20341, 20853, 22592, 24163, 24179, 
+  24330, 26564, 20006, 34109, 38281, 38491, 31859, 38913, 20731, 22721, 
+  30294, 30887, 21029, 30629, 34065, 31622, 20559, 22793, 29255, 31687, 
+  32232, 36794, 36820, 36941, 20415, 21193, 23081, 24321, 38829, 20445, 
+  33303, 37610, 22275, 25429, 27497, 29995, 35036, 36628, 31298, 21215, 
+  22675, 24917, 25098, 26286, 27597, 31807, 33769, 20515, 20472, 21253, 
+  21574, 22577, 22857, 23453, 23792, 23791, 23849, 24214, 25265, 25447, 
+  25918, 26041, 26379, 27861, 27873, 28921, 30770, 32299, 32990, 33459, 
+  33804, 34028, 34562, 35090, 35370, 35914, 37030, 37586, 39165, 40179, 
+  40300, 20047, 20129, 20621, 21078, 22346, 22952, 24125, 24536, 24537, 
+  25151, 26292, 26395, 26576, 26834, 20882, 32033, 32938, 33192, 35584, 
+  35980, 36031, 37502, 38450, 21536, 38956, 21271, 20693, 21340, 22696, 
+  25778, 26420, 29287, 30566, 31302, 37350, 21187, 27809, 27526, 22528, 
+  24140, 22868, 26412, 32763, 20961, 30406, 25705, 30952, 39764, 40635, 
+  22475, 22969, 26151, 26522, 27598, 21737, 27097, 24149, 33180, 26517, 
+  39850, 26622, 40018, 26717, 20134, 20451, 21448, 25273, 26411, 27819, 
+  36804, 20397, 32365, 40639, 19975, 24930, 28288, 28459, 34067, 21619, 
+  26410, 39749, 24051, 31637, 23724, 23494, 34588, 28234, 34001, 31252, 
+  33032, 22937, 31885, 27665, 30496, 21209, 22818, 28961, 29279, 30683, 
+  38695, 40289, 26891, 23167, 23064, 20901, 21517, 21629, 26126, 30431, 
+  36855, 37528, 40180, 23018, 29277, 28357, 20813, 26825, 32191, 32236, 
+  38754, 40634, 25720, 27169, 33538, 22916, 23391, 27611, 29467, 30450, 
+  32178, 32791, 33945, 20786, 26408, 40665, 30446, 26466, 21247, 39173, 
+  23588, 25147, 31870, 36016, 21839, 24758, 32011, 38272, 21249, 20063, 
+  20918, 22812, 29242, 32822, 37326, 24357, 30690, 21380, 24441, 32004, 
+  34220, 35379, 36493, 38742, 26611, 34222, 37971, 24841, 24840, 27833, 
+  30290, 35565, 36664, 21807, 20305, 20778, 21191, 21451, 23461, 24189, 
+  24736, 24962, 25558, 26377, 26586, 28263, 28044, 29494, 29495, 30001, 
+  31056, 35029, 35480, 36938, 37009, 37109, 38596, 34701, 22805, 20104, 
+  20313, 19982, 35465, 36671, 38928, 20653, 24188, 22934, 23481, 24248, 
+  25562, 25594, 25793, 26332, 26954, 27096, 27915, 28342, 29076, 29992, 
+  31407, 32650, 32768, 33865, 33993, 35201, 35617, 36362, 36965, 38525, 
+  39178, 24958, 25233, 27442, 27779, 28020, 32716, 32764, 28096, 32645, 
+  34746, 35064, 26469, 33713, 38972, 38647, 27931, 32097, 33853, 37226, 
+  20081, 21365, 23888, 27396, 28651, 34253, 34349, 35239, 21033, 21519, 
+  23653, 26446, 26792, 29702, 29827, 30178, 35023, 35041, 37324, 38626, 
+  38520, 24459, 29575, 31435, 33870, 25504, 30053, 21129, 27969, 28316, 
+  29705, 30041, 30827, 31890, 38534, 31452, 40845, 20406, 24942, 26053, 
+  34396, 20102, 20142, 20698, 20001, 20940, 23534, 26009, 26753, 28092, 
+  29471, 30274, 30637, 31260, 31975, 33391, 35538, 36988, 37327, 38517, 
+  38936, 21147, 32209, 20523, 21400, 26519, 28107, 29136, 29747, 33256, 
+  36650, 38563, 40023, 40607, 29792, 22593, 28057, 32047, 39006, 20196, 
+  20278, 20363, 20919, 21169, 23994, 24604, 29618, 31036, 33491, 37428, 
+  38583, 38646, 38666, 40599, 40802, 26278, 27508, 21015, 21155, 28872, 
+  35010, 24265, 24651, 24976, 28451, 29001, 31806, 32244, 32879, 34030, 
+  36899, 37676, 21570, 39791, 27347, 28809, 36034, 36335, 38706, 21172, 
+  23105, 24266, 24324, 26391, 27004, 27028, 28010, 28431, 29282, 29436, 
+  31725, 32769, 32894, 34635, 37070, 20845, 40595, 31108, 32907, 37682, 
+  35542, 20525, 21644, 35441, 27498, 36036, 33031, 24785, 26528, 40434, 
+  20121, 20120, 39952, 35435, 34241, 34152, 26880, 28286, 30871, 33109, 
+  24332, 19984, 19989, 20010, 20017, 20022, 20028, 20031, 20034, 20054, 
+  20056, 20098, 20101, 35947, 20106, 33298, 24333, 20110, 20126, 20127, 
+  20128, 20130, 20144, 20147, 20150, 20174, 20173, 20164, 20166, 20162, 
+  20183, 20190, 20205, 20191, 20215, 20233, 20314, 20272, 20315, 20317, 
+  20311, 20295, 20342, 20360, 20367, 20376, 20347, 20329, 20336, 20369, 
+  20335, 20358, 20374, 20760, 20436, 20447, 20430, 20440, 20443, 20433, 
+  20442, 20432, 20452, 20453, 20506, 20520, 20500, 20522, 20517, 20485, 
+  20252, 20470, 20513, 20521, 20524, 20478, 20463, 20497, 20486, 20547, 
+  20551, 26371, 20565, 20560, 20552, 20570, 20566, 20588, 20600, 20608, 
+  20634, 20613, 20660, 20658, 20681, 20682, 20659, 20674, 20694, 20702, 
+  20709, 20717, 20707, 20718, 20729, 20725, 20745, 20737, 20738, 20758, 
+  20757, 20756, 20762, 20769, 20794, 20791, 20796, 20795, 20799, 20800, 
+  20818, 20812, 20820, 20834, 31480, 20841, 20842, 20846, 20864, 20866, 
+  22232, 20876, 20873, 20879, 20881, 20883, 20885, 20886, 20900, 20902, 
+  20898, 20905, 20906, 20907, 20915, 20913, 20914, 20912, 20917, 20925, 
+  20933, 20937, 20955, 20960, 34389, 20969, 20973, 20976, 20981, 20990, 
+  20996, 21003, 21012, 21006, 21031, 21034, 21038, 21043, 21049, 21071, 
+  21060, 21067, 21068, 21086, 21076, 21098, 21108, 21097, 21107, 21119, 
+  21117, 21133, 21140, 21138, 21105, 21128, 21137, 36776, 36775, 21164, 
+  21165, 21180, 21173, 21185, 21197, 21207, 21214, 21219, 21222, 39149, 
+  21216, 21235, 21237, 21240, 21241, 21254, 21256, 30008, 21261, 21264, 
+  21263, 21269, 21274, 21283, 21295, 21297, 21299, 21304, 21312, 21318, 
+  21317, 19991, 21321, 21325, 20950, 21342, 21353, 21358, 22808, 21371, 
+  21367, 21378, 21398, 21408, 21414, 21413, 21422, 21424, 21430, 21443, 
+  31762, 38617, 21471, 26364, 29166, 21486, 21480, 21485, 21498, 21505, 
+  21565, 21568, 21548, 21549, 21564, 21550, 21558, 21545, 21533, 21582, 
+  21647, 21621, 21646, 21599, 21617, 21623, 21616, 21650, 21627, 21632, 
+  21622, 21636, 21648, 21638, 21703, 21666, 21688, 21669, 21676, 21700, 
+  21704, 21672, 21675, 21698, 21668, 21694, 21692, 21720, 21733, 21734, 
+  21775, 21780, 21757, 21742, 21741, 21754, 21730, 21817, 21824, 21859, 
+  21836, 21806, 21852, 21829, 21846, 21847, 21816, 21811, 21853, 21913, 
+  21888, 21679, 21898, 21919, 21883, 21886, 21912, 21918, 21934, 21884, 
+  21891, 21929, 21895, 21928, 21978, 21957, 21983, 21956, 21980, 21988, 
+  21972, 22036, 22007, 22038, 22014, 22013, 22043, 22009, 22094, 22096, 
+  29151, 22068, 22070, 22066, 22072, 22123, 22116, 22063, 22124, 22122, 
+  22150, 22144, 22154, 22176, 22164, 22159, 22181, 22190, 22198, 22196, 
+  22210, 22204, 22209, 22211, 22208, 22216, 22222, 22225, 22227, 22231, 
+  22254, 22265, 22272, 22271, 22276, 22281, 22280, 22283, 22285, 22291, 
+  22296, 22294, 21959, 22300, 22310, 22327, 22328, 22350, 22331, 22336, 
+  22351, 22377, 22464, 22408, 22369, 22399, 22409, 22419, 22432, 22451, 
+  22436, 22442, 22448, 22467, 22470, 22484, 22482, 22483, 22538, 22486, 
+  22499, 22539, 22553, 22557, 22642, 22561, 22626, 22603, 22640, 27584, 
+  22610, 22589, 22649, 22661, 22713, 22687, 22699, 22714, 22750, 22715, 
+  22712, 22702, 22725, 22739, 22737, 22743, 22745, 22744, 22757, 22748, 
+  22756, 22751, 22767, 22778, 22777, 22779, 22780, 22781, 22786, 22794, 
+  22800, 22811, 26790, 22821, 22828, 22829, 22834, 22840, 22846, 31442, 
+  22869, 22864, 22862, 22874, 22872, 22882, 22880, 22887, 22892, 22889, 
+  22904, 22913, 22941, 20318, 20395, 22947, 22962, 22982, 23016, 23004, 
+  22925, 23001, 23002, 23077, 23071, 23057, 23068, 23049, 23066, 23104, 
+  23148, 23113, 23093, 23094, 23138, 23146, 23194, 23228, 23230, 23243, 
+  23234, 23229, 23267, 23255, 23270, 23273, 23254, 23290, 23291, 23308, 
+  23307, 23318, 23346, 23248, 23338, 23350, 23358, 23363, 23365, 23360, 
+  23377, 23381, 23386, 23387, 23397, 23401, 23408, 23411, 23413, 23416, 
+  25992, 23418, 23424, 23427, 23462, 23480, 23491, 23495, 23497, 23508, 
+  23504, 23524, 23526, 23522, 23518, 23525, 23531, 23536, 23542, 23539, 
+  23557, 23559, 23560, 23565, 23571, 23584, 23586, 23592, 23608, 23609, 
+  23617, 23622, 23630, 23635, 23632, 23631, 23409, 23660, 23662, 20066, 
+  23670, 23673, 23692, 23697, 23700, 22939, 23723, 23739, 23734, 23740, 
+  23735, 23749, 23742, 23751, 23769, 23785, 23805, 23802, 23789, 23948, 
+  23786, 23819, 23829, 23831, 23900, 23839, 23835, 23825, 23828, 23842, 
+  23834, 23833, 23832, 23884, 23890, 23886, 23883, 23916, 23923, 23926, 
+  23943, 23940, 23938, 23970, 23965, 23980, 23982, 23997, 23952, 23991, 
+  23996, 24009, 24013, 24019, 24018, 24022, 24027, 24043, 24050, 24053, 
+  24075, 24090, 24089, 24081, 24091, 24118, 24119, 24132, 24131, 24128, 
+  24142, 24151, 24148, 24159, 24162, 24164, 24135, 24181, 24182, 24186, 
+  40636, 24191, 24224, 24257, 24258, 24264, 24272, 24271, 24278, 24291, 
+  24285, 24282, 24283, 24290, 24289, 24296, 24297, 24300, 24305, 24307, 
+  24304, 24308, 24312, 24318, 24323, 24329, 24413, 24412, 24331, 24337, 
+  24342, 24361, 24365, 24376, 24385, 24392, 24396, 24398, 24367, 24401, 
+  24406, 24407, 24409, 24417, 24429, 24435, 24439, 24451, 24450, 24447, 
+  24458, 24456, 24465, 24455, 24478, 24473, 24472, 24480, 24488, 24493, 
+  24508, 24534, 24571, 24548, 24568, 24561, 24541, 24755, 24575, 24609, 
+  24672, 24601, 24592, 24617, 24590, 24625, 24603, 24597, 24619, 24614, 
+  24591, 24634, 24666, 24641, 24682, 24695, 24671, 24650, 24646, 24653, 
+  24675, 24643, 24676, 24642, 24684, 24683, 24665, 24705, 24717, 24807, 
+  24707, 24730, 24708, 24731, 24726, 24727, 24722, 24743, 24715, 24801, 
+  24760, 24800, 24787, 24756, 24560, 24765, 24774, 24757, 24792, 24909, 
+  24853, 24838, 24822, 24823, 24832, 24820, 24826, 24835, 24865, 24827, 
+  24817, 24845, 24846, 24903, 24894, 24872, 24871, 24906, 24895, 24892, 
+  24876, 24884, 24893, 24898, 24900, 24947, 24951, 24920, 24921, 24922, 
+  24939, 24948, 24943, 24933, 24945, 24927, 24925, 24915, 24949, 24985, 
+  24982, 24967, 25004, 24980, 24986, 24970, 24977, 25003, 25006, 25036, 
+  25034, 25033, 25079, 25032, 25027, 25030, 25018, 25035, 32633, 25037, 
+  25062, 25059, 25078, 25082, 25076, 25087, 25085, 25084, 25086, 25088, 
+  25096, 25097, 25101, 25100, 25108, 25115, 25118, 25121, 25130, 25134, 
+  25136, 25138, 25139, 25153, 25166, 25182, 25187, 25179, 25184, 25192, 
+  25212, 25218, 25225, 25214, 25234, 25235, 25238, 25300, 25219, 25236, 
+  25303, 25297, 25275, 25295, 25343, 25286, 25812, 25288, 25308, 25292, 
+  25290, 25282, 25287, 25243, 25289, 25356, 25326, 25329, 25383, 25346, 
+  25352, 25327, 25333, 25424, 25406, 25421, 25628, 25423, 25494, 25486, 
+  25472, 25515, 25462, 25507, 25487, 25481, 25503, 25525, 25451, 25449, 
+  25534, 25577, 25536, 25542, 25571, 25545, 25554, 25590, 25540, 25622, 
+  25652, 25606, 25619, 25638, 25654, 25885, 25623, 25640, 25615, 25703, 
+  25711, 25718, 25678, 25898, 25749, 25747, 25765, 25769, 25736, 25788, 
+  25818, 25810, 25797, 25799, 25787, 25816, 25794, 25841, 25831, 33289, 
+  25824, 25825, 25260, 25827, 25839, 25900, 25846, 25844, 25842, 25850, 
+  25856, 25853, 25880, 25884, 25861, 25892, 25891, 25899, 25908, 25909, 
+  25911, 25910, 25912, 30027, 25928, 25942, 25941, 25933, 25944, 25950, 
+  25949, 25970, 25976, 25986, 25987, 35722, 26011, 26015, 26027, 26039, 
+  26051, 26054, 26049, 26052, 26060, 26066, 26075, 26073, 26080, 26081, 
+  26097, 26482, 26122, 26115, 26107, 26483, 26165, 26166, 26164, 26140, 
+  26191, 26180, 26185, 26177, 26206, 26205, 26212, 26215, 26216, 26207, 
+  26210, 26224, 26243, 26248, 26254, 26249, 26244, 26264, 26269, 26305, 
+  26297, 26313, 26302, 26300, 26308, 26296, 26326, 26330, 26336, 26175, 
+  26342, 26345, 26352, 26357, 26359, 26383, 26390, 26398, 26406, 26407, 
+  38712, 26414, 26431, 26422, 26433, 26424, 26423, 26438, 26462, 26464, 
+  26457, 26467, 26468, 26505, 26480, 26537, 26492, 26474, 26508, 26507, 
+  26534, 26529, 26501, 26551, 26607, 26548, 26604, 26547, 26601, 26552, 
+  26596, 26590, 26589, 26594, 26606, 26553, 26574, 26566, 26599, 27292, 
+  26654, 26694, 26665, 26688, 26701, 26674, 26702, 26803, 26667, 26713, 
+  26723, 26743, 26751, 26783, 26767, 26797, 26772, 26781, 26779, 26755, 
+  27310, 26809, 26740, 26805, 26784, 26810, 26895, 26765, 26750, 26881, 
+  26826, 26888, 26840, 26914, 26918, 26849, 26892, 26829, 26836, 26855, 
+  26837, 26934, 26898, 26884, 26839, 26851, 26917, 26873, 26848, 26863, 
+  26920, 26922, 26906, 26915, 26913, 26822, 27001, 26999, 26972, 27000, 
+  26987, 26964, 27006, 26990, 26937, 26996, 26941, 26969, 26928, 26977, 
+  26974, 26973, 27009, 26986, 27058, 27054, 27088, 27071, 27073, 27091, 
+  27070, 27086, 23528, 27082, 27101, 27067, 27075, 27047, 27182, 27025, 
+  27040, 27036, 27029, 27060, 27102, 27112, 27138, 27163, 27135, 27402, 
+  27129, 27122, 27111, 27141, 27057, 27166, 27117, 27156, 27115, 27146, 
+  27154, 27329, 27171, 27155, 27204, 27148, 27250, 27190, 27256, 27207, 
+  27234, 27225, 27238, 27208, 27192, 27170, 27280, 27277, 27296, 27268, 
+  27298, 27299, 27287, 34327, 27323, 27331, 27330, 27320, 27315, 27308, 
+  27358, 27345, 27359, 27306, 27354, 27370, 27387, 27397, 34326, 27386, 
+  27410, 27414, 39729, 27423, 27448, 27447, 30428, 27449, 39150, 27463, 
+  27459, 27465, 27472, 27481, 27476, 27483, 27487, 27489, 27512, 27513, 
+  27519, 27520, 27524, 27523, 27533, 27544, 27541, 27550, 27556, 27562, 
+  27563, 27567, 27570, 27569, 27571, 27575, 27580, 27590, 27595, 27603, 
+  27615, 27628, 27627, 27635, 27631, 40638, 27656, 27667, 27668, 27675, 
+  27684, 27683, 27742, 27733, 27746, 27754, 27778, 27789, 27802, 27777, 
+  27803, 27774, 27752, 27763, 27794, 27792, 27844, 27889, 27859, 27837, 
+  27863, 27845, 27869, 27822, 27825, 27838, 27834, 27867, 27887, 27865, 
+  27882, 27935, 34893, 27958, 27947, 27965, 27960, 27929, 27957, 27955, 
+  27922, 27916, 28003, 28051, 28004, 27994, 28025, 27993, 28046, 28053, 
+  28644, 28037, 28153, 28181, 28170, 28085, 28103, 28134, 28088, 28102, 
+  28140, 28126, 28108, 28136, 28114, 28101, 28154, 28121, 28132, 28117, 
+  28138, 28142, 28205, 28270, 28206, 28185, 28274, 28255, 28222, 28195, 
+  28267, 28203, 28278, 28237, 28191, 28227, 28218, 28238, 28196, 28415, 
+  28189, 28216, 28290, 28330, 28312, 28361, 28343, 28371, 28349, 28335, 
+  28356, 28338, 28372, 28373, 28303, 28325, 28354, 28319, 28481, 28433, 
+  28748, 28396, 28408, 28414, 28479, 28402, 28465, 28399, 28466, 28364, 
+  28478, 28435, 28407, 28550, 28538, 28536, 28545, 28544, 28527, 28507, 
+  28659, 28525, 28546, 28540, 28504, 28558, 28561, 28610, 28518, 28595, 
+  28579, 28577, 28580, 28601, 28614, 28586, 28639, 28629, 28652, 28628, 
+  28632, 28657, 28654, 28635, 28681, 28683, 28666, 28689, 28673, 28687, 
+  28670, 28699, 28698, 28532, 28701, 28696, 28703, 28720, 28734, 28722, 
+  28753, 28771, 28825, 28818, 28847, 28913, 28844, 28856, 28851, 28846, 
+  28895, 28875, 28893, 28889, 28937, 28925, 28956, 28953, 29029, 29013, 
+  29064, 29030, 29026, 29004, 29014, 29036, 29071, 29179, 29060, 29077, 
+  29096, 29100, 29143, 29113, 29118, 29138, 29129, 29140, 29134, 29152, 
+  29164, 29159, 29173, 29180, 29177, 29183, 29197, 29200, 29211, 29224, 
+  29229, 29228, 29232, 29234, 29243, 29244, 29247, 29248, 29254, 29259, 
+  29272, 29300, 29310, 29314, 29313, 29319, 29330, 29334, 29346, 29351, 
+  29369, 29362, 29379, 29382, 29380, 29390, 29394, 29410, 29408, 29409, 
+  29433, 29431, 20495, 29463, 29450, 29468, 29462, 29469, 29492, 29487, 
+  29481, 29477, 29502, 29518, 29519, 40664, 29527, 29546, 29544, 29552, 
+  29560, 29557, 29563, 29562, 29640, 29619, 29646, 29627, 29632, 29669, 
+  29678, 29662, 29858, 29701, 29807, 29733, 29688, 29746, 29754, 29781, 
+  29759, 29791, 29785, 29761, 29788, 29801, 29808, 29795, 29802, 29814, 
+  29822, 29835, 29854, 29863, 29898, 29903, 29908, 29681, 29920, 29923, 
+  29927, 29929, 29934, 29938, 29936, 29937, 29944, 29943, 29956, 29955, 
+  29957, 29964, 29966, 29965, 29973, 29971, 29982, 29990, 29996, 30012, 
+  30020, 30029, 30026, 30025, 30043, 30022, 30042, 30057, 30052, 30055, 
+  30059, 30061, 30072, 30070, 30086, 30087, 30068, 30090, 30089, 30082, 
+  30100, 30106, 30109, 30117, 30115, 30146, 30131, 30147, 30133, 30141, 
+  30136, 30140, 30129, 30157, 30154, 30162, 30169, 30179, 30174, 30206, 
+  30207, 30204, 30209, 30192, 30202, 30194, 30195, 30219, 30221, 30217, 
+  30239, 30247, 30240, 30241, 30242, 30244, 30260, 30256, 30267, 30279, 
+  30280, 30278, 30300, 30296, 30305, 30306, 30312, 30313, 30314, 30311, 
+  30316, 30320, 30322, 30326, 30328, 30332, 30336, 30339, 30344, 30347, 
+  30350, 30358, 30355, 30361, 30362, 30384, 30388, 30392, 30393, 30394, 
+  30402, 30413, 30422, 30418, 30430, 30433, 30437, 30439, 30442, 34351, 
+  30459, 30472, 30471, 30468, 30505, 30500, 30494, 30501, 30502, 30491, 
+  30519, 30520, 30535, 30554, 30568, 30571, 30555, 30565, 30591, 30590, 
+  30585, 30606, 30603, 30609, 30624, 30622, 30640, 30646, 30649, 30655, 
+  30652, 30653, 30651, 30663, 30669, 30679, 30682, 30684, 30691, 30702, 
+  30716, 30732, 30738, 31014, 30752, 31018, 30789, 30862, 30836, 30854, 
+  30844, 30874, 30860, 30883, 30901, 30890, 30895, 30929, 30918, 30923, 
+  30932, 30910, 30908, 30917, 30922, 30956, 30951, 30938, 30973, 30964, 
+  30983, 30994, 30993, 31001, 31020, 31019, 31040, 31072, 31063, 31071, 
+  31066, 31061, 31059, 31098, 31103, 31114, 31133, 31143, 40779, 31146, 
+  31150, 31155, 31161, 31162, 31177, 31189, 31207, 31212, 31201, 31203, 
+  31240, 31245, 31256, 31257, 31264, 31263, 31104, 31281, 31291, 31294, 
+  31287, 31299, 31319, 31305, 31329, 31330, 31337, 40861, 31344, 31353, 
+  31357, 31368, 31383, 31381, 31384, 31382, 31401, 31432, 31408, 31414, 
+  31429, 31428, 31423, 36995, 31431, 31434, 31437, 31439, 31445, 31443, 
+  31449, 31450, 31453, 31457, 31458, 31462, 31469, 31472, 31490, 31503, 
+  31498, 31494, 31539, 31512, 31513, 31518, 31541, 31528, 31542, 31568, 
+  31610, 31492, 31565, 31499, 31564, 31557, 31605, 31589, 31604, 31591, 
+  31600, 31601, 31596, 31598, 31645, 31640, 31647, 31629, 31644, 31642, 
+  31627, 31634, 31631, 31581, 31641, 31691, 31681, 31692, 31695, 31668, 
+  31686, 31709, 31721, 31761, 31764, 31718, 31717, 31840, 31744, 31751, 
+  31763, 31731, 31735, 31767, 31757, 31734, 31779, 31783, 31786, 31775, 
+  31799, 31787, 31805, 31820, 31811, 31828, 31823, 31808, 31824, 31832, 
+  31839, 31844, 31830, 31845, 31852, 31861, 31875, 31888, 31908, 31917, 
+  31906, 31915, 31905, 31912, 31923, 31922, 31921, 31918, 31929, 31933, 
+  31936, 31941, 31938, 31960, 31954, 31964, 31970, 39739, 31983, 31986, 
+  31988, 31990, 31994, 32006, 32002, 32028, 32021, 32010, 32069, 32075, 
+  32046, 32050, 32063, 32053, 32070, 32115, 32086, 32078, 32114, 32104, 
+  32110, 32079, 32099, 32147, 32137, 32091, 32143, 32125, 32155, 32186, 
+  32174, 32163, 32181, 32199, 32189, 32171, 32317, 32162, 32175, 32220, 
+  32184, 32159, 32176, 32216, 32221, 32228, 32222, 32251, 32242, 32225, 
+  32261, 32266, 32291, 32289, 32274, 32305, 32287, 32265, 32267, 32290, 
+  32326, 32358, 32315, 32309, 32313, 32323, 32311, 32306, 32314, 32359, 
+  32349, 32342, 32350, 32345, 32346, 32377, 32362, 32361, 32380, 32379, 
+  32387, 32213, 32381, 36782, 32383, 32392, 32393, 32396, 32402, 32400, 
+  32403, 32404, 32406, 32398, 32411, 32412, 32568, 32570, 32581, 32588, 
+  32589, 32590, 32592, 32593, 32597, 32596, 32600, 32607, 32608, 32616, 
+  32617, 32615, 32632, 32642, 32646, 32643, 32648, 32647, 32652, 32660, 
+  32670, 32669, 32666, 32675, 32687, 32690, 32697, 32686, 32694, 32696, 
+  35697, 32709, 32710, 32714, 32725, 32724, 32737, 32742, 32745, 32755, 
+  32761, 39132, 32774, 32772, 32779, 32786, 32792, 32793, 32796, 32801, 
+  32808, 32831, 32827, 32842, 32838, 32850, 32856, 32858, 32863, 32866, 
+  32872, 32883, 32882, 32880, 32886, 32889, 32893, 32895, 32900, 32902, 
+  32901, 32923, 32915, 32922, 32941, 20880, 32940, 32987, 32997, 32985, 
+  32989, 32964, 32986, 32982, 33033, 33007, 33009, 33051, 33065, 33059, 
+  33071, 33099, 38539, 33094, 33086, 33107, 33105, 33020, 33137, 33134, 
+  33125, 33126, 33140, 33155, 33160, 33162, 33152, 33154, 33184, 33173, 
+  33188, 33187, 33119, 33171, 33193, 33200, 33205, 33214, 33208, 33213, 
+  33216, 33218, 33210, 33225, 33229, 33233, 33241, 33240, 33224, 33242, 
+  33247, 33248, 33255, 33274, 33275, 33278, 33281, 33282, 33285, 33287, 
+  33290, 33293, 33296, 33302, 33321, 33323, 33336, 33331, 33344, 33369, 
+  33368, 33373, 33370, 33375, 33380, 33378, 33384, 33386, 33387, 33326, 
+  33393, 33399, 33400, 33406, 33421, 33426, 33451, 33439, 33467, 33452, 
+  33505, 33507, 33503, 33490, 33524, 33523, 33530, 33683, 33539, 33531, 
+  33529, 33502, 33542, 33500, 33545, 33497, 33589, 33588, 33558, 33586, 
+  33585, 33600, 33593, 33616, 33605, 33583, 33579, 33559, 33560, 33669, 
+  33690, 33706, 33695, 33698, 33686, 33571, 33678, 33671, 33674, 33660, 
+  33717, 33651, 33653, 33696, 33673, 33704, 33780, 33811, 33771, 33742, 
+  33789, 33795, 33752, 33803, 33729, 33783, 33799, 33760, 33778, 33805, 
+  33826, 33824, 33725, 33848, 34054, 33787, 33901, 33834, 33852, 34138, 
+  33924, 33911, 33899, 33965, 33902, 33922, 33897, 33862, 33836, 33903, 
+  33913, 33845, 33994, 33890, 33977, 33983, 33951, 34009, 33997, 33979, 
+  34010, 34000, 33985, 33990, 34006, 33953, 34081, 34047, 34036, 34071, 
+  34072, 34092, 34079, 34069, 34068, 34044, 34112, 34147, 34136, 34120, 
+  34113, 34306, 34123, 34133, 34176, 34212, 34184, 34193, 34186, 34216, 
+  34157, 34196, 34203, 34282, 34183, 34204, 34167, 34174, 34192, 34249, 
+  34234, 34255, 34233, 34256, 34261, 34269, 34277, 34268, 34297, 34314, 
+  34323, 34315, 34302, 34298, 34310, 34338, 34330, 34352, 34367, 34381, 
+  20053, 34388, 34399, 34407, 34417, 34451, 34467, 34473, 34474, 34443, 
+  34444, 34486, 34479, 34500, 34502, 34480, 34505, 34851, 34475, 34516, 
+  34526, 34537, 34540, 34527, 34523, 34543, 34578, 34566, 34568, 34560, 
+  34563, 34555, 34577, 34569, 34573, 34553, 34570, 34612, 34623, 34615, 
+  34619, 34597, 34601, 34586, 34656, 34655, 34680, 34636, 34638, 34676, 
+  34647, 34664, 34670, 34649, 34643, 34659, 34666, 34821, 34722, 34719, 
+  34690, 34735, 34763, 34749, 34752, 34768, 38614, 34731, 34756, 34739, 
+  34759, 34758, 34747, 34799, 34802, 34784, 34831, 34829, 34814, 34806, 
+  34807, 34830, 34770, 34833, 34838, 34837, 34850, 34849, 34865, 34870, 
+  34873, 34855, 34875, 34884, 34882, 34898, 34905, 34910, 34914, 34923, 
+  34945, 34942, 34974, 34933, 34941, 34997, 34930, 34946, 34967, 34962, 
+  34990, 34969, 34978, 34957, 34980, 34992, 35007, 34993, 35011, 35012, 
+  35028, 35032, 35033, 35037, 35065, 35074, 35068, 35060, 35048, 35058, 
+  35076, 35084, 35082, 35091, 35139, 35102, 35109, 35114, 35115, 35137, 
+  35140, 35131, 35126, 35128, 35148, 35101, 35168, 35166, 35174, 35172, 
+  35181, 35178, 35183, 35188, 35191, 35198, 35203, 35208, 35210, 35219, 
+  35224, 35233, 35241, 35238, 35244, 35247, 35250, 35258, 35261, 35263, 
+  35264, 35290, 35292, 35293, 35303, 35316, 35320, 35331, 35350, 35344, 
+  35340, 35355, 35357, 35365, 35382, 35393, 35419, 35410, 35398, 35400, 
+  35452, 35437, 35436, 35426, 35461, 35458, 35460, 35496, 35489, 35473, 
+  35493, 35494, 35482, 35491, 35524, 35533, 35522, 35546, 35563, 35571, 
+  35559, 35556, 35569, 35604, 35552, 35554, 35575, 35550, 35547, 35596, 
+  35591, 35610, 35553, 35606, 35600, 35607, 35616, 35635, 38827, 35622, 
+  35627, 35646, 35624, 35649, 35660, 35663, 35662, 35657, 35670, 35675, 
+  35674, 35691, 35679, 35692, 35695, 35700, 35709, 35712, 35724, 35726, 
+  35730, 35731, 35734, 35737, 35738, 35898, 35905, 35903, 35912, 35916, 
+  35918, 35920, 35925, 35938, 35948, 35960, 35962, 35970, 35977, 35973, 
+  35978, 35981, 35982, 35988, 35964, 35992, 25117, 36013, 36010, 36029, 
+  36018, 36019, 36014, 36022, 36040, 36033, 36068, 36067, 36058, 36093, 
+  36090, 36091, 36100, 36101, 36106, 36103, 36111, 36109, 36112, 40782, 
+  36115, 36045, 36116, 36118, 36199, 36205, 36209, 36211, 36225, 36249, 
+  36290, 36286, 36282, 36303, 36314, 36310, 36300, 36315, 36299, 36330, 
+  36331, 36319, 36323, 36348, 36360, 36361, 36351, 36381, 36382, 36368, 
+  36383, 36418, 36405, 36400, 36404, 36426, 36423, 36425, 36428, 36432, 
+  36424, 36441, 36452, 36448, 36394, 36451, 36437, 36470, 36466, 36476, 
+  36481, 36487, 36485, 36484, 36491, 36490, 36499, 36497, 36500, 36505, 
+  36522, 36513, 36524, 36528, 36550, 36529, 36542, 36549, 36552, 36555, 
+  36571, 36579, 36604, 36603, 36587, 36606, 36618, 36613, 36629, 36626, 
+  36633, 36627, 36636, 36639, 36635, 36620, 36646, 36659, 36667, 36665, 
+  36677, 36674, 36670, 36684, 36681, 36678, 36686, 36695, 36700, 36706, 
+  36707, 36708, 36764, 36767, 36771, 36781, 36783, 36791, 36826, 36837, 
+  36834, 36842, 36847, 36999, 36852, 36869, 36857, 36858, 36881, 36885, 
+  36897, 36877, 36894, 36886, 36875, 36903, 36918, 36917, 36921, 36856, 
+  36943, 36944, 36945, 36946, 36878, 36937, 36926, 36950, 36952, 36958, 
+  36968, 36975, 36982, 38568, 36978, 36994, 36989, 36993, 36992, 37002, 
+  37001, 37007, 37032, 37039, 37041, 37045, 37090, 37092, 25160, 37083, 
+  37122, 37138, 37145, 37170, 37168, 37194, 37206, 37208, 37219, 37221, 
+  37225, 37235, 37234, 37259, 37257, 37250, 37282, 37291, 37295, 37290, 
+  37301, 37300, 37306, 37312, 37313, 37321, 37323, 37328, 37334, 37343, 
+  37345, 37339, 37372, 37365, 37366, 37406, 37375, 37396, 37420, 37397, 
+  37393, 37470, 37463, 37445, 37449, 37476, 37448, 37525, 37439, 37451, 
+  37456, 37532, 37526, 37523, 37531, 37466, 37583, 37561, 37559, 37609, 
+  37647, 37626, 37700, 37678, 37657, 37666, 37658, 37667, 37690, 37685, 
+  37691, 37724, 37728, 37756, 37742, 37718, 37808, 37804, 37805, 37780, 
+  37817, 37846, 37847, 37864, 37861, 37848, 37827, 37853, 37840, 37832, 
+  37860, 37914, 37908, 37907, 37891, 37895, 37904, 37942, 37931, 37941, 
+  37921, 37946, 37953, 37970, 37956, 37979, 37984, 37986, 37982, 37994, 
+  37417, 38000, 38005, 38007, 38013, 37978, 38012, 38014, 38017, 38015, 
+  38274, 38279, 38282, 38292, 38294, 38296, 38297, 38304, 38312, 38311, 
+  38317, 38332, 38331, 38329, 38334, 38346, 28662, 38339, 38349, 38348, 
+  38357, 38356, 38358, 38364, 38369, 38373, 38370, 38433, 38440, 38446, 
+  38447, 38466, 38476, 38479, 38475, 38519, 38492, 38494, 38493, 38495, 
+  38502, 38514, 38508, 38541, 38552, 38549, 38551, 38570, 38567, 38577, 
+  38578, 38576, 38580, 38582, 38584, 38585, 38606, 38603, 38601, 38605, 
+  35149, 38620, 38669, 38613, 38649, 38660, 38662, 38664, 38675, 38670, 
+  38673, 38671, 38678, 38681, 38692, 38698, 38704, 38713, 38717, 38718, 
+  38724, 38726, 38728, 38722, 38729, 38748, 38752, 38756, 38758, 38760, 
+  21202, 38763, 38769, 38777, 38789, 38780, 38785, 38778, 38790, 38795, 
+  38799, 38800, 38812, 38824, 38822, 38819, 38835, 38836, 38851, 38854, 
+  38856, 38859, 38876, 38893, 40783, 38898, 31455, 38902, 38901, 38927, 
+  38924, 38968, 38948, 38945, 38967, 38973, 38982, 38991, 38987, 39019, 
+  39023, 39024, 39025, 39028, 39027, 39082, 39087, 39089, 39094, 39108, 
+  39107, 39110, 39145, 39147, 39171, 39177, 39186, 39188, 39192, 39201, 
+  39197, 39198, 39204, 39200, 39212, 39214, 39229, 39230, 39234, 39241, 
+  39237, 39248, 39243, 39249, 39250, 39244, 39253, 39319, 39320, 39333, 
+  39341, 39342, 39356, 39391, 39387, 39389, 39384, 39377, 39405, 39406, 
+  39409, 39410, 39419, 39416, 39425, 39439, 39429, 39394, 39449, 39467, 
+  39479, 39493, 39490, 39488, 39491, 39486, 39509, 39501, 39515, 39511, 
+  39519, 39522, 39525, 39524, 39529, 39531, 39530, 39597, 39600, 39612, 
+  39616, 39631, 39633, 39635, 39636, 39646, 39647, 39650, 39651, 39654, 
+  39663, 39659, 39662, 39668, 39665, 39671, 39675, 39686, 39704, 39706, 
+  39711, 39714, 39715, 39717, 39719, 39720, 39721, 39722, 39726, 39727, 
+  39730, 39748, 39747, 39759, 39757, 39758, 39761, 39768, 39796, 39827, 
+  39811, 39825, 39830, 39831, 39839, 39840, 39848, 39860, 39872, 39882, 
+  39865, 39878, 39887, 39889, 39890, 39907, 39906, 39908, 39892, 39905, 
+  39994, 39922, 39921, 39920, 39957, 39956, 39945, 39955, 39948, 39942, 
+  39944, 39954, 39946, 39940, 39982, 39963, 39973, 39972, 39969, 39984, 
+  40007, 39986, 40006, 39998, 40026, 40032, 40039, 40054, 40056, 40167, 
+  40172, 40176, 40201, 40200, 40171, 40195, 40198, 40234, 40230, 40367, 
+  40227, 40223, 40260, 40213, 40210, 40257, 40255, 40254, 40262, 40264, 
+  40285, 40286, 40292, 40273, 40272, 40281, 40306, 40329, 40327, 40363, 
+  40303, 40314, 40346, 40356, 40361, 40370, 40388, 40385, 40379, 40376, 
+  40378, 40390, 40399, 40386, 40409, 40403, 40440, 40422, 40429, 40431, 
+  40445, 40474, 40475, 40478, 40565, 40569, 40573, 40577, 40584, 40587, 
+  40588, 40594, 40597, 40593, 40605, 40613, 40617, 40632, 40618, 40621, 
+  38753, 40652, 40654, 40655, 40656, 40660, 40668, 40670, 40669, 40672, 
+  40677, 40680, 40687, 40692, 40694, 40695, 40697, 40699, 40700, 40701, 
+  40711, 40712, 30391, 40725, 40737, 40748, 40766, 40778, 40786, 40788, 
+  40803, 40799, 40800, 40801, 40806, 40807, 40812, 40810, 40823, 40818, 
+  40822, 40853, 40860, 40864, 22575, 27079, 36953, 29796, 9794, 9472, 
+  9473, 9474, 9475, 9476, 9477, 9478, 9479, 9480, 9481, 9482, 
+  9483, 9484, 9485, 9486, 9487, 9488, 9489, 9490, 9491, 9492, 
+  9493, 9494, 9495, 9496, 9497, 9498, 9499, 9500, 9501, 9502, 
+  9503, 9504, 9505, 9506, 9507, 9508, 9509, 9510, 9511, 9512, 
+  9513, 9514, 9515, 9516, 9517, 9518, 9519, 9520, 9521, 9522, 
+  9523, 9524, 9525, 9526, 9527, 9528, 9529, 9530, 9531, 9532, 
+  9533, 9534, 9535, 9536, 9537, 9538, 9539, 9540, 9541, 9542, 
+  9543, 9544, 9545, 9546, 9547, 9312, 9313, 9314, 9315, 9316, 
+  9317, 9318, 9319, 9320, 9321, 9322, 9323, 9324, 9325, 9326, 
+  9327, 9328, 9329, 9330, 9331, 8544, 8545, 8546, 8547, 8548, 
+  8549, 8550, 8551, 8552, 8553, 13129, 13076, 13090, 13133, 13080, 
+  13095, 13059, 13110, 13137, 13143, 13069, 13094, 13091, 13099, 13130, 
+  13115, 13212, 13213, 13214, 13198, 13199, 13252, 13217, 12317, 12319, 
+  8470, 13261, 8481, 12964, 12965, 12966, 12967, 12968, 12849, 12850, 
+  12857, 13182, 13181, 13180, 8750, 8721, 8730, 8869, 8736, 8735, 
+  8895, 8745, 8746, 21854, 39156, 28322, 39983, 28139, 36802, 27421, 
+  21417, 0, 22082, 39180, 28976, 35158, 40407, 36838, 24674, 25296, 
+  26214, 64054, 33883, 38788, 22169, 15694, 32752, 32747, 24509, 31047, 
+  20448, 21375, 20677, 36544, 21936, 0, 23633, 38772, 31041, 24935, 
+  0, 32363, 33606, 0, 20518, 23244, 25458, 40572, 35578, 24055, 
+  26171, 28317, 40628, 40288, 29969, 37319, 27018, 26629, 34217, 39894, 
+  37638, 29642, 21489, 23650, 36974, 0, 28796, 32353, 37195, 26329, 
+  64070, 34223, 34295, 21736, 24288, 26786, 34083, 37292, 38808, 34645, 
+  38765, 36887, 32736, 25722, 36893, 34796, 25776, 26643, 29006, 29053, 
+  35438, 22092, 36961, 21109, 25620, 30185, 36956, 39506, 33151, 40667, 
+  21828, 28655, 64074, 34552, 0, 36799, 26842, 40008, 27197, 31774, 
+  35387, 28710, 20939, 25431, 27084, 37786, 64016, 25681, 37165, 25826, 
+  63980, 22625, 39002, 22581, 0, 33759, 36077, 22616, 31153, 40199, 
+  28678, 28702, 22136, 36929, 38931, 37027, 35598, 28760, 26978, 31152, 
+  22218, 29260, 36889, 31204, 21085, 31672, 28497, 37297, 25405, 25161, 
+  27147, 26570, 31255, 36924, 23195, 35628, 24287, 28693, 64106, 34109, 
+  30629, 23081, 24214, 27873, 34028, 38960, 40018, 40629, 20786, 39173, 
+  31870, 37971, 24840, 30290, 29495, 29076, 32768, 33802, 63939, 63890, 
+  63891, 63897, 27028, 34847, 0, 20873, 0, 0, 21817, 21811, 
+  21988, 22066, 22181, 22539, 23230, 0, 23643, 24164, 24727, 25449, 
+  25606, 25890, 25987, 26534, 26618, 26779, 26766, 28270, 0, 0, 
+  29646, 29956, 29965, 29973, 30355, 30844, 31281, 40861, 31641, 31888, 
+  31918, 32155, 32174, 32159, 32724, 33326, 33421, 33490, 33571, 33653, 
+  34071, 34110, 34690, 34770, 35082, 35247, 35550, 35649, 36314, 36361, 
+  36627, 36842, 36999, 36952, 25160, 37313, 38331, 30562, 38692, 38752, 
+  38769, 38948, 39726, 39831, 39922, 40618, 40860, 12289, 12290, 8254, 
+  65343, 12540, 8213, 8208, 12316, 8214, 65372, 8230, 8229, 65288, 
+  65289, 12308, 12309, 65095, 65096, 65371, 65373, 12296, 12297, 12298, 
+  12299, 12300, 12301, 12302, 12303, 12304, 12305, 65309, 12353, 12355, 
+  12357, 12359, 12361, 12387, 12419, 12421, 12423, 12430, 12449, 12451, 
+  12453, 12455, 12457, 12483, 12515, 12517, 12519, 12526, 12533, 12534, 
+  13129, 13076, 13090, 13133, 13080, 13095, 13059, 13110, 13137, 13143, 
+  13069, 13094, 13091, 13099, 13130, 13115, 12317, 12318, 12436, 12437, 
+  12438, 33446, 33576, 22099, 21417, 29273, 27762, 31496, 39255, 25331, 
+  39184, 38765, 29053, 31359, 31661, 25539, 33759, 31074, 21467, 31687, 
+  36804, 31806, 20682, 21269, 21929, 22190, 22553, 22811, 23592, 24272, 
+  24271, 25153, 26305, 27656, 28195, 28396, 31383, 31709, 32745, 33826, 
+  34649, 34830, 34770, 39449, 40621, 65508, 65287, 65282, 4520, 9665, 
+  9655, 8681, 8679, 8678, 8680, 9634, 9831, 9825, 9828, 9826, 
+  13216, 13218, 13220, 13221, 13207, 8467, 13208, 13235, 13234, 13233, 
+  13232, 13189, 13190, 13191, 13259, 13200, 13268, 13206, 13090, 13078, 
+  13080, 13077, 13059, 13091, 13143, 13122, 13113, 13115, 13056, 13105, 
+  13127, 13086, 13098, 13261, 13183, 8481, 9742, 12342, 12320, 169, 
+  174, 0, 9352, 9353, 9354, 9355, 9356, 9357, 9358, 9359, 
+  9360, 9332, 9333, 9334, 9335, 9336, 9337, 9338, 9339, 9340, 
+  9341, 9342, 9343, 9344, 9345, 9346, 9347, 9348, 9349, 9350, 
+  9351, 12881, 8560, 8561, 8562, 8563, 8564, 8565, 8566, 8567, 
+  8568, 8569, 12882, 12883, 12884, 12885, 12886, 12887, 12888, 12889, 
+  12890, 12891, 9372, 9373, 9374, 9375, 9376, 9377, 9378, 9379, 
+  9380, 9381, 9382, 9383, 9384, 9385, 9386, 9387, 9388, 9389, 
+  9390, 9391, 9392, 9393, 9394, 9395, 9396, 9397, 12867, 12861, 
+  12863, 12852, 12856, 12851, 12860, 12866, 12862, 12854, 12853, 12859, 
+  12864, 12858, 12976, 12973, 12969, 12975, 12948, 12970, 12952, 12971, 
+  12946, 12945, 12947, 12972, 12974, 12950, 9129, 9128, 9127, 65080, 
+  9133, 9132, 9131, 65080, 9131, 9132, 9133, 65080, 9127, 9128, 
+  9129, 65080, 13260, 13061, 189, 188, 13215, 13219, 13222, 0, 
+  0, 12958, 13192, 13193, 13256, 8749, 21360, 12848, 12842, 12843, 
+  12844, 12845, 12846, 12847, 12855, 12865, 10145, 11013, 11014, 11015, 
+  9673, 9824, 9829, 9827, 9830, 9728, 9729, 9730, 9731, 9758, 
+  9756, 9757, 9759, 12953, 9450, 8554, 8555, 65296, 65296, 12288, 
+  9601, 9602, 9603, 9604, 9605, 9606, 9607, 9608, 9615, 9614, 
+  9613, 9612, 9611, 9610, 9609, 9620, 9621, 9581, 9582, 9584, 
+  9583, 9552, 9566, 9578, 9569, 9698, 9699, 9701, 9700, 9679, 
+  3792, 9585, 9586, 9587, 12437, 12438, 36898, 36795, 65292, 176, 
+  12307, 12444, 12443, 8242, 65294, 8216, 8217, 8220, 8221, 8220, 
+  8222, 8216, 8218, 8243, 20956, 29081, 10102, 10103, 10104, 10105, 
+  10106, 10107, 10108, 10109, 10110, 0, 0, 0, 8570, 8571, 
+  0, 0, 0, 8575, 8458, 8457, 0, 8507, 12292, 8646, 
+  8644, 8645, 0, 12535, 12536, 12537, 12538, 22823, 23567, 12957, 
+  25511, 0, 0, 13179, 13183, 0, 0, 13107, 13134, 13090, 
+  13078, 13061, 13061, 13061, 13107, 13134, 13134, 13134, 13059, 13080, 
+  13077, 13113, 13113, 13113, 13143, 13122, 13122, 13122, 13091, 13115, 
+  13056, 13086, 13086, 13086, 13098, 13098, 13098, 13127, 13105, 32394, 
+  35100, 37704, 37512, 34012, 20425, 28859, 26161, 26824, 37625, 26363, 
+  24389, 20008, 20193, 20220, 20224, 20227, 20281, 20310, 20370, 20362, 
+  20378, 20372, 20429, 20544, 20514, 20479, 20510, 20550, 20592, 20546, 
+  20628, 20724, 20696, 20810, 20836, 20893, 20926, 20972, 21013, 21148, 
+  21158, 21184, 21211, 21248, 21255, 21284, 21362, 21395, 21426, 21469, 
+  64014, 21660, 21642, 21673, 21759, 21894, 22361, 22373, 22444, 22472, 
+  22471, 64015, 22618, 22686, 22706, 22795, 22867, 22875, 22877, 22883, 
+  22948, 22970, 23382, 23488, 29999, 23512, 23515, 23582, 23718, 23738, 
+  23797, 23847, 23891, 64017, 23874, 23917, 23992, 23993, 24016, 24353, 
+  24372, 24423, 24503, 24542, 24669, 24709, 24714, 24798, 24789, 24864, 
+  24818, 24849, 24887, 24880, 24984, 25107, 25254, 25589, 25696, 25757, 
+  25806, 25934, 26112, 26133, 26121, 26158, 26142, 26148, 26213, 26199, 
+  26201, 64018, 26227, 26265, 26272, 26290, 26303, 26362, 26382, 26391, 
+  26470, 26555, 26706, 26560, 26625, 26692, 26831, 64019, 26984, 64020, 
+  27032, 27106, 27184, 27243, 27206, 27251, 27262, 27362, 27364, 27606, 
+  27711, 27740, 27782, 27759, 27866, 27908, 28039, 28015, 28054, 28076, 
+  28111, 28152, 28146, 28156, 28217, 28252, 28199, 28220, 28351, 28552, 
+  28597, 28661, 28677, 28679, 28712, 28805, 28843, 28943, 28932, 29020, 
+  28998, 28999, 0, 29121, 29182, 29361, 29374, 29476, 64022, 29559, 
+  29629, 29641, 29654, 29667, 29650, 29703, 29685, 29734, 29738, 29737, 
+  29742, 29794, 29833, 29855, 29953, 30063, 30338, 30364, 30366, 30363, 
+  30374, 64023, 30534, 21167, 30753, 30798, 30820, 30842, 31024, 64024, 
+  64025, 64026, 31124, 64027, 31131, 31441, 31463, 64028, 31467, 31646, 
+  64029, 32072, 32092, 32183, 32160, 32214, 32338, 32583, 32673, 64030, 
+  33537, 33634, 33663, 33735, 33782, 33864, 33972, 34131, 34137, 34155, 
+  64031, 34224, 64032, 64033, 34823, 35061, 35346, 35383, 35449, 35495, 
+  35518, 35551, 64034, 35574, 35667, 35711, 36080, 36084, 36114, 36214, 
+  64035, 36559, 64036, 64037, 36967, 37086, 64038, 37141, 37159, 37338, 
+  37335, 37342, 37357, 37358, 37348, 37349, 37382, 37392, 37386, 37434, 
+  37440, 37436, 37454, 37465, 37457, 37433, 37479, 37543, 37495, 37496, 
+  37607, 37591, 37593, 37584, 64039, 37589, 37600, 37587, 37669, 37665, 
+  37627, 64040, 37662, 37631, 37661, 37634, 37744, 37719, 37796, 37830, 
+  37854, 37880, 37937, 37957, 37960, 38290, 38534, 64041, 38557, 38575, 
+  38707, 38715, 38723, 38733, 38735, 38737, 38741, 38999, 39013, 64042, 
+  64043, 39207, 64044, 39326, 39502, 39641, 39644, 39797, 39794, 39823, 
+  39857, 39867, 39936, 40304, 40299, 64045, 40473, 40657, 172, 92, 
+  32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 
+  42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
+  52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 
+  62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 
+  72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 
+  82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
+  165, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
+  102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 
+  112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 
+  122, 123, 166, 125, 771, 8217, 92, 8216, 124, 126, 
+  161, 162, 163, 8260, 402, 167, 164, 8220, 171, 8249, 
+  8250, 64257, 64258, 8210, 8224, 8225, 183, 182, 8226, 8218, 
+  8222, 8221, 187, 8230, 8240, 191, 769, 770, 175, 774, 
+  775, 776, 778, 184, 779, 808, 780, 822, 198, 170, 
+  321, 216, 338, 186, 230, 305, 322, 248, 339, 223, 
+  45, 169, 172, 174, 176, 177, 178, 179, 181, 185, 
+  188, 189, 190, 192, 193, 194, 195, 196, 197, 199, 
+  200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 
+  210, 211, 212, 213, 214, 215, 217, 218, 219, 220, 
+  221, 222, 224, 225, 226, 227, 228, 229, 231, 232, 
+  233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 
+  243, 244, 245, 246, 247, 249, 250, 251, 252, 253, 
+  254, 255, 352, 376, 381, 773, 353, 8482, 382, 48, 
+  8194, 33, 34, 35, 36, 37, 38, 39, 40, 41, 
+  42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
+  52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 
+  62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 
+  72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 
+  82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
+  165, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
+  102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 
+  112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 
+  122, 123, 124, 125, 8254, 65344, 8242, 168, 8246, 196, 
+  249, 233, 237, 223, 231, 199, 209, 241, 162, 163, 
+  243, 250, 161, 191, 189, 214, 220, 228, 235, 239, 
+  246, 220, 226, 234, 238, 244, 252, 224, 233, 225, 
+  126, 48, 172, 92, 65376, 65377, 65378, 65379, 65380, 65381, 
+  65382, 65383, 65384, 65385, 65386, 65387, 65388, 65389, 65390, 65391, 
+  65392, 65393, 65394, 65395, 65396, 65397, 65398, 65399, 65400, 65401, 
+  65402, 65403, 65404, 65405, 65406, 65407, 65408, 65409, 65410, 65411, 
+  65412, 65413, 65414, 65415, 65416, 65417, 65418, 65419, 65420, 65421, 
+  65422, 65423, 65424, 65425, 65426, 65427, 65428, 65429, 65430, 65431, 
+  65432, 65433, 65434, 65435, 65436, 65437, 65438, 65439, 12528, 12529, 
+  12526, 12459, 12465, 12532, 12460, 12462, 12464, 12466, 12468, 12470, 
+  12472, 12474, 12476, 12478, 12480, 12482, 12485, 12487, 12489, 12496, 
+  12497, 12499, 12500, 12502, 12503, 12505, 12506, 12508, 12509, 65376, 
+  12434, 12353, 12355, 12357, 12359, 12361, 12419, 12421, 12423, 12387, 
+  12354, 12356, 12358, 12360, 12362, 12363, 12365, 12367, 12369, 12371, 
+  12373, 12375, 12377, 12379, 12381, 12383, 12385, 12388, 12390, 12392, 
+  12394, 12395, 12396, 12397, 12398, 12399, 12402, 12405, 12408, 12411, 
+  12414, 12415, 12416, 12417, 12418, 12420, 12422, 12424, 12425, 12426, 
+  12427, 12428, 12429, 12431, 12435, 12432, 12433, 12430, 12364, 12366, 
+  12368, 12370, 12372, 12374, 12392, 12378, 12380, 12382, 12384, 12386, 
+  12389, 12391, 12393, 12400, 12401, 12403, 12404, 12406, 12407, 12409, 
+  12410, 12412, 12413, 12317, 12318, 91, 93, 12296, 12297, 12298, 
+  12299, 12302, 12303, 12304, 12305, 8210, 65376, 9472, 9473, 9474, 
+  9475, 9476, 9477, 9478, 9479, 9480, 9481, 9482, 9483, 9484, 
+  9485, 9486, 9487, 9488, 9489, 9490, 9491, 9492, 9493, 9494, 
+  9495, 9496, 9497, 9498, 9499, 9500, 9501, 9502, 9503, 9504, 
+  9505, 9506, 9507, 9508, 9509, 9510, 9511, 9512, 9513, 9514, 
+  9515, 9516, 9517, 9518, 9519, 9520, 9521, 9522, 9523, 9524, 
+  9525, 9526, 9527, 9528, 9529, 9530, 9531, 9532, 9533, 9534, 
+  9535, 9536, 9537, 9538, 9539, 9540, 9541, 9542, 9543, 9544, 
+  9545, 9546, 9547, 9650, 8364, 8486, 8242, 8243, 64256, 64259, 
+  64260, 257, 299, 363, 275, 333, 256, 298, 362, 274, 
+  332, 8539, 8540, 8541, 8542, 8531, 8532, 8304, 8308, 8309, 
+  8310, 8311, 8312, 8313, 8320, 8321, 8322, 8323, 8324, 8325, 
+  8326, 8327, 8328, 8329, 461, 282, 0, 7868, 463, 0, 
+  296, 465, 0, 467, 366, 360, 462, 283, 0, 7869, 
+  464, 0, 297, 466, 0, 468, 367, 361, 593, 8049, 
+  8048, 509, 230, 596, 596, 596, 601, 601, 601, 602, 
+  602, 602, 603, 8051, 8050, 567, 331, 629, 652, 652, 
+  652, 658, 643, 720, 32, 33, 34, 35, 36, 37, 
+  38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 
+  48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 
+  58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 
+  68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 
+  78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 
+  88, 89, 90, 91, 165, 93, 94, 95, 96, 97, 
+  98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 
+  108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 
+  118, 119, 120, 121, 122, 123, 166, 125, 771, 8217, 
+  92, 8216, 124, 126, 161, 162, 163, 8260, 402, 167, 
+  164, 8220, 171, 8249, 8250, 64257, 64258, 8210, 8224, 8225, 
+  183, 182, 8226, 8218, 8222, 8221, 187, 8230, 8240, 191, 
+  769, 770, 175, 774, 775, 776, 778, 184, 779, 808, 
+  780, 822, 198, 170, 321, 216, 338, 186, 230, 305, 
+  322, 248, 339, 223, 45, 169, 172, 174, 176, 177, 
+  178, 179, 181, 185, 188, 189, 190, 192, 193, 194, 
+  195, 196, 197, 199, 200, 201, 202, 203, 204, 205, 
+  206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 
+  217, 218, 219, 220, 221, 222, 224, 225, 226, 227, 
+  228, 229, 231, 232, 233, 234, 235, 236, 237, 238, 
+  239, 240, 241, 242, 243, 244, 245, 246, 247, 249, 
+  250, 251, 252, 253, 254, 255, 352, 376, 381, 773, 
+  353, 8482, 382, 48, 8364, 8486, 8242, 8243, 64256, 64259, 
+  64260, 257, 299, 363, 275, 333, 256, 298, 362, 274, 
+  332, 8539, 8540, 8541, 8542, 8531, 8532, 8304, 8308, 8309, 
+  8310, 8311, 8312, 8313, 8320, 8321, 8322, 8323, 8324, 8325, 
+  8326, 8327, 8328, 8329, 461, 282, 0, 7868, 463, 0, 
+  296, 465, 0, 467, 366, 360, 462, 283, 0, 7869, 
+  464, 0, 297, 466, 0, 468, 367, 361, 48, 49, 
+  50, 51, 52, 53, 54, 55, 56, 57, 822, 45, 
+  61, 44, 40, 41, 46, 47, 58, 59, 48, 49, 
+  50, 51, 52, 53, 54, 55, 56, 57, 822, 45, 
+  61, 44, 40, 41, 46, 47, 58, 59, 183, 8364, 
+  0, 8531, 8532, 190, 8533, 8534, 8535, 8536, 8537, 8538, 
+  0, 0, 0, 0, 0, 0, 8539, 8540, 8541, 8542, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 48, 49, 50, 51, 52, 53, 54, 55, 
+  56, 57, 48, 8547, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 8560, 8561, 8562, 8563, 8564, 8565, 
+  8566, 8567, 8568, 8569, 8570, 8571, 0, 0, 0, 8544, 
+  8545, 8546, 8547, 8548, 8549, 8550, 8551, 8552, 8553, 8554, 
+  8555, 0, 0, 0, 65, 66, 67, 68, 69, 70, 
+  71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 
+  81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 
+  12354, 12356, 12358, 12360, 12362, 12363, 12365, 12367, 12369, 12371, 
+  12373, 12375, 12377, 12379, 12381, 12383, 12385, 12388, 12390, 12392, 
+  12394, 12395, 12396, 12397, 12398, 12399, 12402, 12405, 12408, 12411, 
+  12414, 12415, 12416, 12417, 12418, 12420, 12422, 12424, 12425, 12426, 
+  12427, 12428, 12429, 12431, 12432, 12433, 12434, 12435, 12450, 12452, 
+  12454, 12456, 12458, 12459, 12461, 12463, 12465, 12467, 12469, 12471, 
+  12473, 12475, 12477, 12479, 12481, 12484, 12486, 12488, 12490, 12491, 
+  12492, 12493, 12494, 12495, 12498, 12501, 12504, 12507, 12510, 12511, 
+  12512, 12513, 12514, 12516, 12518, 12520, 12521, 12522, 12523, 12524, 
+  12525, 12527, 12528, 12529, 12530, 12531, 12832, 12833, 12834, 12835, 
+  12836, 12837, 12838, 12839, 12840, 12841, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 21942, 21512, 27883, 21839, 
+  31572, 20363, 48, 49, 50, 51, 52, 53, 54, 55, 
+  56, 57, 48, 49, 50, 51, 52, 53, 54, 55, 
+  56, 57, 12387, 25165, 12295, 19968, 20108, 19977, 22235, 20116, 
+  20845, 19971, 20843, 20061, 21313, 12295, 19968, 20108, 19977, 22235, 
+  20116, 20845, 19971, 20843, 20061, 21313, 12295, 19968, 20108, 19977, 
+  22235, 20116, 20845, 19971, 20843, 20061, 12388, 25165, 19968, 20108, 
+  19977, 22235, 20116, 20845, 19971, 20843, 20061, 21313, 12295, 19968, 
+  20108, 19977, 22235, 20116, 20845, 19971, 20843, 20061, 21313, 12467, 
+  12387, 12483, 12457, 0, 0, 9312, 9313, 9314, 9315, 9316, 
+  9317, 9318, 9319, 9320, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 9424, 9425, 9426, 9427, 9428, 9429, 9430, 
+  9431, 9432, 9433, 9434, 9435, 9436, 9437, 9438, 9439, 9440, 
+  9441, 9442, 9443, 9444, 9445, 9446, 9447, 9448, 9449, 9398, 
+  9399, 9400, 9401, 9402, 9403, 9404, 9405, 9406, 9407, 9408, 
+  9409, 9410, 9411, 9412, 9413, 9414, 9415, 9416, 9417, 9418, 
+  9419, 9420, 9421, 9422, 9423, 12354, 12356, 12358, 12360, 12362, 
+  12363, 12365, 12367, 12369, 12371, 12373, 12375, 12377, 12379, 12381, 
+  12383, 12385, 12388, 12390, 12392, 12394, 12395, 12396, 12397, 12398, 
+  12399, 12402, 12405, 12408, 12411, 12414, 12415, 12416, 12417, 12418, 
+  12420, 12422, 12424, 12425, 12426, 12427, 12428, 12429, 12431, 12432, 
+  12433, 12434, 12435, 13008, 13009, 13010, 13011, 13012, 13013, 13014, 
+  13015, 13016, 13017, 13018, 13019, 13020, 13021, 13022, 13023, 13024, 
+  13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 
+  13035, 13036, 13037, 13038, 13039, 13040, 13041, 13042, 13043, 13044, 
+  13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 
+  12531, 12928, 12929, 12930, 12931, 12932, 12933, 12934, 12935, 12936, 
+  12937, 12944, 12938, 12939, 12940, 12941, 12942, 12943, 35519, 12959, 
+  21103, 28187, 27161, 27424, 22522, 31105, 12960, 12961, 12955, 12954, 
+  12963, 12962, 12951, 20986, 12956, 12949, 28168, 22679, 21839, 31572, 
+  20363, 38651, 9676, 9471, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 97, 98, 99, 100, 101, 
+  102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 
+  112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 
+  122, 65, 66, 67, 68, 69, 70, 71, 72, 73, 
+  74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 
+  84, 85, 86, 87, 88, 89, 90, 12354, 12356, 12358, 
+  12360, 12362, 12363, 12365, 12367, 12369, 12371, 12373, 12375, 12377, 
+  12379, 12381, 12383, 12385, 12388, 12390, 12392, 12394, 12395, 12396, 
+  12397, 12398, 12399, 12402, 12405, 12408, 12411, 12414, 12415, 12416, 
+  12417, 12418, 12420, 12422, 12424, 12425, 12426, 12427, 12428, 12429, 
+  12431, 12432, 12433, 12434, 12435, 12450, 12452, 12454, 12456, 12458, 
+  12459, 12461, 12463, 12465, 12467, 12469, 12471, 12473, 12475, 12477, 
+  12479, 12481, 12484, 12486, 12488, 12490, 12491, 12492, 12493, 12494, 
+  12495, 12498, 12501, 12504, 12507, 12510, 12511, 12512, 12513, 12514, 
+  12516, 12518, 12520, 12521, 12522, 12523, 12524, 12525, 12527, 12528, 
+  12529, 12530, 12531, 26085, 26376, 28779, 27700, 26408, 37329, 22303, 
+  21839, 31572, 20363, 9679, 48, 0, 49, 0, 50, 0, 
+  51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 
+  56, 0, 57, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 97, 98, 99, 100, 101, 
+  102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 
+  112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 
+  122, 65, 66, 67, 68, 69, 70, 71, 72, 73, 
+  74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 
+  84, 85, 86, 87, 88, 89, 90, 12354, 12356, 12358, 
+  12360, 12362, 12363, 12365, 12367, 12369, 12371, 12373, 12375, 12377, 
+  12379, 12381, 12383, 12385, 12388, 12390, 12392, 12394, 12395, 12396, 
+  12397, 12398, 12399, 12402, 12405, 12408, 12411, 12414, 12415, 12416, 
+  12417, 12418, 12420, 12422, 12424, 12425, 12426, 12427, 12428, 12429, 
+  12431, 12432, 12433, 12434, 12435, 12450, 12452, 12454, 12456, 12458, 
+  12459, 12461, 12463, 12465, 12467, 12469, 12471, 12473, 12475, 12477, 
+  12479, 12481, 12484, 12486, 12488, 12490, 12491, 12492, 12493, 12494, 
+  12495, 12498, 12501, 12504, 12507, 12510, 12511, 12512, 12513, 12514, 
+  12516, 12518, 12520, 12521, 12522, 12523, 12524, 12525, 12527, 12528, 
+  12529, 12530, 12531, 26085, 26376, 28779, 27700, 26408, 37329, 22303, 
+  36000, 21213, 21839, 31572, 20363, 8414, 9633, 48, 0, 49, 
+  0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 
+  0, 55, 0, 56, 0, 57, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 97, 98, 
+  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 
+  109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 
+  119, 120, 121, 122, 65, 66, 67, 68, 69, 70, 
+  71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 
+  81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 
+  12354, 12356, 12358, 12360, 12362, 12363, 12365, 12367, 12369, 12371, 
+  12373, 12375, 12377, 12379, 12381, 12383, 12385, 12388, 12390, 12392, 
+  12394, 12395, 12396, 12397, 12398, 12399, 12402, 12405, 12408, 12411, 
+  12414, 12415, 12416, 12417, 12418, 12420, 12422, 12424, 12425, 12426, 
+  12427, 12428, 12429, 12431, 12432, 12433, 12434, 12435, 12450, 12452, 
+  12454, 12456, 12458, 12459, 12461, 12463, 12465, 12467, 12469, 12471, 
+  12473, 12475, 12477, 12479, 12481, 12484, 12486, 12488, 12490, 12491, 
+  12492, 12493, 12494, 12495, 12498, 12501, 12504, 12507, 12510, 12511, 
+  12512, 12513, 12514, 12516, 12518, 12520, 12521, 12522, 12523, 12524, 
+  12525, 12527, 12528, 12529, 12530, 12531, 26085, 26376, 28779, 27700, 
+  26408, 37329, 22303, 21839, 31572, 20363, 9632, 48, 0, 49, 
+  0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 
+  0, 55, 0, 56, 0, 57, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 97, 98, 
+  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 
+  109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 
+  119, 120, 121, 122, 65, 66, 67, 68, 69, 70, 
+  71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 
+  81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 
+  12354, 12356, 12358, 12360, 12362, 12363, 12365, 12367, 12369, 12371, 
+  12373, 12375, 12377, 12379, 12381, 12383, 12385, 12388, 12390, 12392, 
+  12394, 12395, 12396, 12397, 12398, 12399, 12402, 12405, 12408, 12411, 
+  12414, 12415, 12416, 12417, 12418, 12420, 12422, 12424, 12425, 12426, 
+  12427, 12428, 12429, 12431, 12432, 12433, 12434, 12435, 12450, 12452, 
+  12454, 12456, 12458, 12459, 12461, 12463, 12465, 12467, 12469, 12471, 
+  12473, 12475, 12477, 12479, 12481, 12484, 12486, 12488, 12490, 12491, 
+  12492, 12493, 12494, 12495, 12498, 12501, 12504, 12507, 12510, 12511, 
+  12512, 12513, 12514, 12516, 12518, 12520, 12521, 12522, 12523, 12524, 
+  12525, 12527, 12528, 12529, 12530, 12531, 26085, 26376, 28779, 27700, 
+  26408, 37329, 22303, 21839, 31572, 20363, 48, 0, 49, 0, 
+  50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 
+  55, 0, 56, 0, 57, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 97, 98, 99, 
+  100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 
+  110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 
+  120, 121, 122, 65, 66, 67, 68, 69, 70, 71, 
+  72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 
+  82, 83, 84, 85, 86, 87, 88, 89, 90, 12354, 
+  12356, 12358, 12360, 12362, 12363, 12365, 12367, 12369, 12371, 12373, 
+  12375, 12377, 12379, 12381, 12383, 12385, 12388, 12390, 12392, 12394, 
+  12395, 12396, 12397, 12398, 12399, 12402, 12405, 12408, 12411, 12414, 
+  12415, 12416, 12417, 12418, 12420, 12422, 12424, 12425, 12426, 12427, 
+  12428, 12429, 12431, 12432, 12433, 12434, 12435, 12450, 12452, 12454, 
+  12456, 12458, 12459, 12461, 12463, 12465, 12467, 12469, 12471, 12473, 
+  12475, 12477, 12479, 12481, 12484, 12486, 12488, 12490, 12491, 12492, 
+  12493, 12494, 12495, 12498, 12501, 12504, 12507, 12510, 12511, 12512, 
+  12513, 12514, 12516, 12518, 12520, 12521, 12522, 12523, 12524, 12525, 
+  12527, 12528, 12529, 12530, 12531, 26085, 26376, 28779, 27700, 26408, 
+  37329, 22303, 21839, 31572, 20363, 9632, 13250, 13261, 8470, 0, 
+  13272, 13274, 8481, 8482, 0, 8448, 13250, 0, 13252, 8453, 
+  13207, 13169, 13208, 8467, 13197, 13211, 13206, 0, 0, 13271, 
+  13272, 0, 0, 0, 13057, 13058, 13060, 13062, 0, 13064, 
+  0, 13063, 13066, 0, 13065, 0, 13067, 0, 13068, 13070, 
+  13071, 13072, 13073, 13074, 13075, 0, 13079, 0, 13081, 0, 
+  13082, 13083, 13084, 13085, 13087, 13088, 13089, 13092, 0, 13093, 
+  0, 0, 13096, 13097, 0, 13101, 0, 0, 13102, 13103, 
+  13104, 13106, 0, 0, 13108, 13109, 13116, 0, 0, 0, 
+  13111, 0, 13112, 13114, 13117, 13121, 13118, 13119, 13120, 13123, 
+  13124, 13125, 13126, 13128, 13131, 13132, 13135, 13136, 0, 0, 
+  13138, 13140, 0, 0, 13139, 13141, 13142, 0, 13057, 13058, 
+  13060, 13062, 0, 13064, 0, 13063, 13066, 0, 13065, 0, 
+  13067, 0, 13068, 13070, 13071, 13072, 13073, 13074, 13075, 0, 
+  13079, 0, 13081, 0, 13082, 13083, 13084, 13085, 13087, 13088, 
+  13089, 13092, 0, 13093, 0, 0, 13096, 13097, 0, 13101, 
+  0, 0, 13102, 13103, 13104, 13106, 0, 0, 13108, 13109, 
+  13116, 0, 0, 0, 13111, 0, 13112, 13114, 13117, 13121, 
+  13118, 13119, 13120, 13123, 13124, 13125, 13126, 13128, 13131, 13132, 
+  13135, 13136, 0, 0, 13138, 13140, 0, 0, 13139, 13141, 
+  13142, 13182, 13181, 13180, 13179, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 45, 61, 8451, 9792, 9794, 12307, 12306, 
+  12300, 12301, 12302, 12303, 12314, 12315, 12312, 12313, 65288, 65289, 
+  12317, 12318, 8216, 8217, 8220, 8221, 39, 34, 0, 8501, 
+  976, 8714, 8463, 181, 981, 987, 977, 0, 9832, 9833, 
+  9836, 65306, 169, 169, 174, 174, 12347, 12347, 12339, 12340, 
+  12341, 8252, 8265, 33, 8252, 8265, 9290, 0, 8723, 8800, 
+  8771, 8818, 8819, 12300, 12301, 12302, 12303, 12314, 12315, 12312, 
+  12313, 65375, 65376, 12300, 12301, 12302, 12303, 12314, 12315, 12312, 
+  12313, 65375, 65376, 9115, 9117, 9118, 9120, 9117, 9115, 9120, 
+  9118, 9121, 9123, 9124, 9126, 9123, 9121, 9126, 9124, 9121, 
+  9123, 9124, 9126, 9123, 9121, 9126, 9124, 65372, 8213, 12317, 
+  12318, 8216, 8217, 8216, 8217, 9986, 9986, 9986, 9986, 12349, 
+  12306, 12447, 21325, 8711, 8709, 8864, 8854, 8856, 8853, 8855, 
+  8862, 8853, 9888, 9651, 9664, 9654, 8678, 8680, 8679, 8681, 
+  8656, 8596, 8600, 8601, 8598, 8599, 8652, 8651, 8644, 8645, 
+  8592, 8594, 8593, 8595, 8596, 8597, 9476, 9478, 12336, 8967, 
+  12336, 8967, 12336, 8967, 12336, 8967, 12336, 8967, 10048, 10047, 
+  9633, 9632, 9633, 9633, 9633, 9633, 9633, 9643, 9632, 9642, 
+  10010, 10010, 9671, 9670, 9671, 9671, 9671, 9671, 9671, 9670, 
+  9670, 9678, 9673, 9675, 9702, 9679, 8226, 10070, 10070, 10070, 
+  10070, 12296, 12297, 12296, 12297, 12298, 12299, 12298, 12299, 12371, 
+  12371, 12467, 12467, 12445, 12446, 12353, 12354, 12355, 12356, 12357, 
+  12358, 12359, 12360, 12361, 12362, 12437, 12363, 12364, 12365, 12366, 
+  12367, 12368, 12438, 12369, 12370, 12371, 12371, 12372, 12373, 12374, 
+  12375, 12376, 12377, 12378, 12379, 12380, 12381, 12382, 12383, 12384, 
+  12385, 12386, 12387, 12388, 12389, 12390, 12391, 12392, 12393, 12394, 
+  12395, 12396, 12397, 12398, 12399, 12400, 12401, 12402, 12403, 12404, 
+  12405, 12406, 12407, 12408, 12409, 12410, 12411, 12412, 12413, 12414, 
+  12415, 12416, 12417, 12418, 12419, 12420, 12421, 12422, 12423, 12424, 
+  12425, 12426, 12427, 12428, 12429, 12430, 12431, 12432, 12433, 12434, 
+  12435, 12436, 12541, 12542, 12540, 12449, 12450, 12451, 12452, 12453, 
+  12454, 12455, 12456, 12457, 12458, 12533, 12459, 12460, 12461, 12462, 
+  12463, 12464, 12534, 12465, 12466, 12467, 12467, 12468, 12469, 12470, 
+  12471, 12472, 12473, 12474, 12475, 12476, 12477, 12478, 12479, 12480, 
+  12481, 12482, 12483, 12484, 12485, 12486, 12487, 12488, 12489, 12490, 
+  12491, 12492, 12493, 12494, 12495, 12496, 12497, 12498, 12499, 12500, 
+  12501, 12502, 12503, 12504, 12505, 12506, 12507, 12508, 12509, 12510, 
+  12511, 12512, 12513, 12514, 12515, 12516, 12517, 12518, 12519, 12520, 
+  12521, 12522, 12523, 12524, 12525, 12526, 12527, 12528, 12529, 12530, 
+  12531, 12532, 12535, 12536, 12537, 12538, 12445, 12446, 12353, 12354, 
+  12355, 12356, 12357, 12358, 12359, 12360, 12361, 12362, 12437, 12363, 
+  12364, 12365, 12366, 12367, 12368, 12438, 12369, 12370, 12371, 12371, 
+  12372, 12373, 12374, 12375, 12376, 12377, 12378, 12379, 12380, 12381, 
+  12382, 12383, 12384, 12385, 12386, 12387, 12388, 12389, 12390, 12391, 
+  12392, 12393, 12394, 12395, 12396, 12397, 12398, 12399, 12400, 12401, 
+  12402, 12403, 12404, 12405, 12406, 12407, 12408, 12409, 12410, 12411, 
+  12412, 12413, 12414, 12415, 12416, 12417, 12418, 12419, 12420, 12421, 
+  12422, 12423, 12424, 12425, 12426, 12427, 12428, 12429, 12430, 12431, 
+  12432, 12433, 12434, 12435, 12436, 12541, 12542, 12540, 12449, 12450, 
+  12451, 12452, 12453, 12454, 12455, 12456, 12457, 12458, 12533, 12459, 
+  12460, 12461, 12462, 12463, 12464, 12534, 12465, 12466, 12467, 12467, 
+  12468, 12469, 12470, 12471, 12472, 12473, 12474, 12475, 12476, 12477, 
+  12478, 12479, 12480, 12481, 12482, 12483, 12484, 12485, 12486, 12487, 
+  12488, 12489, 12490, 12491, 12492, 12493, 12494, 12495, 12496, 12497, 
+  12498, 12499, 12500, 12501, 12502, 12503, 12504, 12505, 12506, 12507, 
+  12508, 12509, 12510, 12511, 12512, 12513, 12514, 12515, 12516, 12517, 
+  12518, 12519, 12520, 12521, 12522, 12523, 12524, 12525, 12526, 12527, 
+  12528, 12529, 12530, 12531, 12532, 12535, 12536, 12537, 12538, 65093, 
+  65094, 12539, 65290, 8251, 9675, 9678, 9673, 9651, 9650, 12541, 
+  12542, 12445, 12446, 65288, 65289, 12308, 12309, 65288, 65289, 12308, 
+  12309, 48, 49, 50, 51, 52, 53, 54, 55, 56, 
+  57, 12353, 12354, 12355, 12356, 12357, 12358, 12359, 12360, 12361, 
+  12362, 12363, 12437, 12364, 12365, 12366, 12367, 12368, 12369, 12438, 
+  12370, 12371, 12372, 12373, 12374, 12375, 12376, 12377, 12378, 12379, 
+  12380, 12381, 12382, 12383, 12384, 12385, 12386, 12387, 12388, 12389, 
+  12390, 12391, 12392, 12393, 12394, 12395, 12396, 12397, 12398, 12399, 
+  12400, 12401, 12402, 12403, 12404, 12405, 12406, 12407, 12408, 12409, 
+  12410, 12411, 12412, 12413, 12414, 12415, 12416, 12417, 12418, 12419, 
+  12420, 12421, 12422, 12423, 12424, 12425, 12426, 12427, 12428, 12429, 
+  12430, 12431, 12432, 12433, 12434, 12435, 12436, 12353, 12355, 12357, 
+  12359, 12361, 12363, 12369, 12387, 12419, 12421, 12423, 12430, 12449, 
+  12450, 12451, 12452, 12453, 12454, 12455, 12456, 12457, 12458, 12459, 
+  12533, 12460, 12461, 12462, 12463, 12464, 12465, 12534, 12466, 12467, 
+  12468, 12469, 12470, 12471, 12472, 12473, 12474, 12475, 12476, 12477, 
+  12478, 12479, 12480, 12481, 12482, 12483, 12484, 12485, 12486, 12487, 
+  12488, 12489, 12490, 12491, 12492, 12493, 12494, 12495, 12496, 12497, 
+  12498, 12499, 12500, 12501, 12502, 12503, 12504, 12505, 12506, 12507, 
+  12508, 12509, 12510, 12511, 12512, 12513, 12514, 12515, 12516, 12517, 
+  12518, 12519, 12520, 12521, 12522, 12523, 12524, 12525, 12526, 12527, 
+  12528, 12529, 12530, 12531, 12532, 12449, 12451, 12453, 12455, 12457, 
+  12533, 12534, 12483, 12515, 12517, 12519, 12526, 12540, 12540, 27880, 
+  8364, 8486, 8242, 8243, 64256, 64259, 64260, 257, 299, 363, 
+  275, 333, 256, 298, 362, 274, 332, 8539, 8540, 8541, 
+  8542, 8531, 8532, 8304, 8308, 8309, 8310, 8311, 8312, 8313, 
+  8320, 8321, 8322, 8323, 8324, 8325, 8326, 8327, 8328, 8329, 
+  461, 282, 0, 7868, 463, 0, 296, 465, 0, 467, 
+  366, 360, 462, 283, 0, 7869, 464, 0, 297, 466, 
+  0, 468, 367, 361, 593, 593, 593, 509, 230, 596, 
+  596, 596, 601, 601, 601, 602, 602, 602, 603, 603, 
+  603, 106, 331, 629, 652, 652, 652, 658, 643, 720, 
+  32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 
+  42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
+  52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 
+  62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 
+  72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 
+  82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
+  165, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
+  102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 
+  112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 
+  122, 123, 166, 125, 771, 8217, 92, 8216, 124, 126, 
+  161, 162, 163, 8260, 402, 167, 164, 8220, 171, 8249, 
+  8250, 64257, 64258, 8210, 8224, 8225, 183, 182, 8226, 8218, 
+  8222, 8221, 187, 8230, 8240, 191, 769, 770, 175, 774, 
+  775, 776, 778, 184, 779, 808, 780, 822, 198, 170, 
+  321, 216, 338, 186, 230, 305, 322, 248, 339, 223, 
+  45, 169, 172, 174, 176, 177, 178, 179, 181, 185, 
+  188, 189, 190, 192, 193, 194, 195, 196, 197, 199, 
+  200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 
+  210, 211, 212, 213, 214, 215, 217, 218, 219, 220, 
+  221, 222, 224, 225, 226, 227, 228, 229, 231, 232, 
+  233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 
+  243, 244, 245, 246, 247, 249, 250, 251, 252, 253, 
+  254, 255, 352, 376, 381, 773, 353, 8482, 382, 48, 
+  8364, 8486, 8242, 8243, 64256, 64259, 64260, 257, 299, 363, 
+  275, 333, 256, 298, 362, 274, 332, 8539, 8540, 8541, 
+  8542, 8531, 8532, 8304, 8308, 8309, 8310, 8311, 8312, 8313, 
+  8320, 8321, 8322, 8323, 8324, 8325, 8326, 8327, 8328, 8329, 
+  461, 282, 0, 7868, 463, 0, 296, 465, 0, 467, 
+  366, 360, 462, 283, 0, 7869, 464, 0, 297, 466, 
+  0, 468, 367, 361, 48, 49, 50, 51, 52, 53, 
+  54, 55, 56, 57, 822, 45, 61, 44, 40, 41, 
+  46, 47, 58, 59, 48, 49, 50, 51, 52, 53, 
+  54, 55, 56, 57, 822, 45, 61, 44, 40, 41, 
+  46, 47, 58, 59, 183, 45, 61, 8451, 9792, 9794, 
+  12307, 12306, 12300, 12301, 12302, 12303, 12314, 12315, 12312, 12313, 
+  65288, 65289, 12317, 12318, 8216, 8217, 8220, 8221, 39, 34, 
+  64103, 64098, 32227, 40643, 28331, 64082, 64061, 64069, 64062, 27114, 
+  28212, 64096, 64071, 64056, 64066, 64078, 34395, 64105, 64052, 64099, 
+  25581, 25802, 30799, 64084, 63856, 64077, 64097, 64072, 64076, 64091, 
+  64092, 64081, 64067, 64090, 28041, 29376, 24910, 0, 64086, 64080, 
+  64049, 64059, 24034, 64063, 64101, 21373, 64055, 64095, 24501, 64064, 
+  37806, 64083, 39725, 64085, 64104, 64068, 64089, 26202, 64053, 64075, 
+  64100, 64065, 64048, 20341, 64057, 64051, 27493, 64058, 27599, 64050, 
+  25150, 64079, 63773, 63964, 63798, 28122, 63952, 26310, 27511, 64087, 
+  37706, 24266, 37636, 27010, 20916, 25420, 34523, 37001, 36898, 20553, 
+  32239, 36949, 21417, 39180, 34907, 24310, 27839, 37467, 32705, 33469, 
+  38597, 23475, 24936, 27010, 27579, 25954, 36011, 24012, 38929, 24112, 
+  36556, 31406, 22343, 20625, 31348, 20581, 24314, 37431, 27278, 20132, 
+  20844, 26356, 26657, 30828, 32094, 32771, 36092, 38477, 25335, 32618, 
+  20351, 21490, 22985, 35613, 37034, 21454, 36655, 26580, 30636, 33308, 
+  26991, 26494, 35359, 19976, 22516, 26893, 32887, 35242, 36930, 25454, 
+  25666, 33337, 32207, 32865, 20687, 35477, 24677, 20806, 30522, 32884, 
+  36339, 24237, 24311, 33351, 26691, 36867, 27966, 25490, 36649, 29677, 
+  38930, 24754, 25161, 26000, 32203, 35513, 36007, 29238, 33914, 20998, 
+  22132, 24996, 31881, 32027, 38640, 34109, 20415, 25447, 30406, 26717, 
+  33032, 32822, 32764, 21519, 38563, 40607, 40599, 32879, 32894, 28286, 
+  20613, 20883, 20955, 0, 21312, 38617, 21929, 22209, 22285, 22699, 
+  23002, 23094, 23230, 23886, 23943, 24009, 24019, 24365, 24472, 24792, 
+  24893, 25086, 25192, 25295, 25885, 25615, 25842, 25949, 26207, 26537, 
+  26599, 26987, 26928, 27047, 27204, 27280, 27656, 27667, 28195, 28433, 
+  28414, 28478, 29183, 29669, 29746, 29791, 29920, 29964, 30322, 31018, 
+  30932, 31162, 31257, 31381, 31986, 32115, 32221, 32309, 32686, 32737, 
+  32858, 32863, 32883, 32880, 32886, 33107, 33162, 33205, 33229, 33778, 
+  34133, 34261, 34586, 34870, 34974, 35032, 35060, 35115, 35131, 35178, 
+  35183, 35357, 36101, 36111, 40782, 36497, 36513, 36946, 36878, 37168, 
+  37206, 37208, 37221, 37235, 37234, 37282, 37295, 37290, 37300, 37306, 
+  38007, 38552, 38717, 38752, 38769, 38924, 39027, 39107, 39493, 39757, 
+  39768, 39878, 39905, 39921, 40264, 40399, 40712, 25201, 26263, 24847, 
+  34915, 36949, 36986, 30959, 35999, 11991, 11965, 24272, 29916, 36939, 
+  39180, 34910, 37555, 38321, 24310, 25588, 0, 29017, 36960, 37467, 
+  26044, 24448, 32705, 21368, 38899, 21270, 33457, 33747, 36008, 36942, 
+  0, 38597, 39187, 24315, 28784, 23475, 24936, 24936, 24936, 0, 
+  27010, 26478, 11974, 38548, 0, 36676, 37772, 33477, 23506, 29872, 
+  32233, 32566, 36996, 38290, 38867, 33304, 21361, 13314, 13314, 13314, 
+  24190, 26083, 26399, 27231, 36215, 39138, 0, 21931, 34384, 36870, 
+  21450, 21560, 24613, 32026, 24040, 25298, 36317, 0, 0, 0, 
+  24378, 24656, 27073, 0, 0, 37111, 38911, 39255, 26241, 11945, 
+  36817, 20465, 30697, 20855, 34398, 31354, 36935, 27355, 21843, 63753, 
+  24693, 24935, 36814, 20625, 28500, 31348, 26376, 11964, 20860, 21048, 
+  0, 26435, 32937, 35609, 36963, 0, 35329, 25142, 38599, 39015, 
+  21555, 23067, 35492, 24037, 24908, 25221, 25511, 27083, 0, 28207, 
+  32789, 33108, 33618, 35611, 36092, 21567, 37239, 33136, 29969, 36796, 
+  20170, 37782, 24231, 24425, 25505, 27506, 33756, 20916, 21682, 21066, 
+  29986, 19256, 23039, 23039, 24063, 35566, 35566, 36039, 36039, 27425, 
+  27425, 0, 29626, 0, 25448, 26012, 37034, 0, 29237, 0, 
+  37196, 24369, 20027, 21463, 25480, 0, 32066, 32722, 34886, 36913, 
+  20303, 34899, 36848, 24033, 36981, 36981, 25152, 26360, 22899, 21213, 
+  21830, 23477, 0, 11916, 11917, 23577, 28040, 30813, 32918, 0, 
+  23426, 0, 24773, 22516, 39166, 26893, 27542, 11997, 39136, 11998, 
+  14221, 20405, 11927, 28024, 0, 36914, 20155, 0, 20995, 23563, 
+  35338, 35338, 36805, 34928, 36930, 13599, 21218, 0, 30427, 32854, 
+  35200, 35488, 35531, 38748, 38748, 31237, 33030, 38587, 31821, 31680, 
+  35498, 38634, 32085, 25159, 28568, 32673, 33337, 36984, 36983, 21069, 
+  20840, 25475, 25591, 30246, 36208, 36865, 36973, 36896, 11978, 36895, 
+  36042, 23562, 23562, 22949, 0, 36864, 36910, 38538, 39899, 22823, 
+  13351, 28711, 36921, 33067, 20025, 27470, 0, 35477, 26262, 20516, 
+  32622, 31689, 11950, 31569, 36880, 26609, 27880, 39376, 0, 24501, 
+  25074, 26397, 0, 35519, 30452, 26389, 26389, 22684, 36861, 36890, 
+  22378, 37347, 21576, 24093, 31243, 30340, 36969, 36845, 28155, 20814, 
+  36884, 30778, 22305, 0, 0, 21776, 64003, 34276, 35588, 36867, 
+  36879, 39472, 23566, 36947, 21534, 15240, 20839, 32905, 20083, 24525, 
+  35469, 63839, 32013, 35207, 27966, 32954, 21338, 34180, 36843, 32283, 
+  32903, 20023, 28497, 37297, 20276, 21028, 21322, 24070, 30036, 26217, 
+  34115, 36991, 24494, 40763, 21305, 11946, 24421, 23020, 0, 35413, 
+  24217, 30149, 23142, 25975, 28014, 36000, 36000, 26381, 35206, 19993, 
+  24163, 24179, 24330, 34065, 20559, 32232, 36820, 36941, 31807, 21253, 
+  23849, 25265, 26379, 30770, 32299, 32990, 33804, 37030, 37030, 39165, 
+  40300, 20129, 24125, 24536, 24537, 25151, 26395, 26395, 20882, 25705, 
+  32763, 20961, 30952, 39764, 40635, 27097, 26717, 13416, 40884, 32365, 
+  40639, 33032, 26126, 30431, 36855, 22916, 21200, 30450, 32791, 25147, 
+  32011, 38272, 32004, 36493, 26746, 26746, 26625, 24841, 0, 0, 
+  21191, 26377, 29494, 29494, 29495, 0, 36938, 26332, 11959, 35201, 
+  39178, 32716, 32764, 36534, 63775, 29575, 40845, 40845, 63875, 26753, 
+  29136, 38563, 40023, 40607, 31867, 63906, 24976, 63898, 26391, 32770, 
+  0, 20682, 20762, 20820, 20885, 11911, 21133, 21207, 0, 0, 
+  13630, 21471, 26364, 21811, 21988, 21589, 22208, 22841, 23068, 23234, 
+  23414, 0, 23572, 14306, 23782, 24148, 20040, 24291, 24727, 0, 
+  25292, 25628, 25542, 25640, 0, 25371, 26207, 26207, 26211, 26357, 
+  0, 26781, 26765, 27126, 27014, 23528, 23528, 27067, 27596, 28433, 
+  28183, 28568, 27818, 27818, 28699, 29026, 29243, 20012, 29468, 29898, 
+  29935, 30069, 30188, 30286, 16305, 30570, 30633, 31040, 31059, 31059, 
+  40779, 31150, 36995, 31571, 31764, 31764, 16996, 31824, 31832, 32070, 
+  0, 32290, 32290, 32328, 32309, 32323, 32396, 32592, 32593, 32593, 
+  0, 32709, 32710, 32745, 33089, 17491, 33368, 33401, 11967, 11968, 
+  33507, 20857, 33626, 33824, 33725, 34036, 17701, 34183, 34292, 0, 
+  34615, 34619, 34821, 34749, 34429, 34870, 13358, 35014, 35261, 35547, 
+  35646, 35674, 36211, 36249, 18406, 36404, 36426, 36847, 36999, 36858, 
+  36894, 36917, 36944, 36808, 36993, 37002, 37002, 37002, 37002, 37002, 
+  37002, 37001, 37001, 37001, 37001, 37001, 37001, 37001, 37001, 37001, 
+  37001, 37001, 37001, 0, 37853, 38332, 0, 38578, 38748, 38969, 
+  39147, 39171, 39177, 39237, 39237, 39243, 39432, 39519, 39525, 39663, 
+  39704, 39903, 40201, 40200, 40613, 40652, 40712, 40778, 40803, 40807, 
+  0, 0, 0, 35100, 26824, 26363, 24389, 21248, 21385, 22867, 
+  64017, 0, 27251, 0, 0, 35346, 19972, 19973, 19999, 20011, 
+  20015, 20016, 20032, 20033, 20036, 20058, 20095, 20109, 20118, 20153, 
+  20176, 20192, 20221, 20223, 20235, 20245, 20320, 20283, 20297, 20308, 
+  20346, 20349, 20350, 20375, 20414, 20431, 20477, 20480, 20481, 20496, 
+  20507, 20519, 20526, 20567, 20582, 20586, 20539, 20623, 20630, 20636, 
+  20684, 20710, 20713, 20719, 20744, 20747, 20752, 20763, 20766, 20831, 
+  20897, 20924, 20958, 20974, 20980, 20993, 20994, 21011, 21065, 21089, 
+  21094, 21139, 21192, 21232, 21258, 21259, 21310, 21324, 21323, 21345, 
+  21356, 21419, 21466, 21478, 21493, 21543, 21581, 21606, 21611, 21620, 
+  21645, 21654, 21665, 21677, 21689, 21695, 21702, 21709, 21774, 21803, 
+  21813, 21834, 21856, 21857, 21896, 21902, 22024, 22030, 22031, 22071, 
+  22079, 22089, 22091, 22095, 22118, 22121, 22127, 22129, 22130, 22165, 
+  22170, 22188, 22189, 22193, 22217, 22237, 22244, 22282, 22293, 22307, 
+  22319, 22323, 22324, 22348, 22384, 22412, 22428, 22456, 22502, 22509, 
+  22517, 22518, 22527, 22537, 22560, 22578, 22652, 22656, 22697, 22734, 
+  22736, 22740, 22746, 22761, 22796, 22820, 22831, 22881, 22893, 22986, 
+  22994, 23005, 23011, 23012, 23044, 23052, 23075, 23111, 23125, 23139, 
+  23149, 23166, 23198, 23207, 23212, 23219, 23264, 23296, 23321, 23333, 
+  23341, 23361, 23420, 23422, 23423, 23434, 23587, 23595, 23600, 23651, 
+  23657, 23676, 23755, 23762, 23796, 23844, 23846, 23875, 23878, 23882, 
+  23954, 23956, 23961, 23968, 24024, 24032, 24056, 24064, 24082, 24084, 
+  24085, 24088, 24110, 24152, 24171, 24172, 24232, 24234, 24254, 24255, 
+  24267, 24274, 24327, 24334, 24348, 24349, 24354, 24360, 24374, 24379, 
+  24384, 24400, 24408, 24420, 24457, 24476, 24487, 24484, 24495, 24504, 
+  24516, 24521, 24545, 24553, 24557, 24572, 24599, 24602, 24627, 24673, 
+  24703, 24734, 24740, 24752, 24779, 24795, 24824, 24850, 24851, 24852, 
+  24860, 24956, 24973, 24991, 25000, 25026, 25055, 25109, 25129, 25155, 
+  25158, 25164, 25169, 25174, 25284, 25340, 25354, 25357, 25368, 25401, 
+  25410, 25411, 25445, 25460, 25469, 25476, 25479, 25488, 25502, 25553, 
+  25564, 25609, 25616, 25634, 25684, 25691, 25709, 25723, 25790, 25791, 
+  25829, 25847, 25851, 25860, 25878, 25881, 25927, 25959, 25985, 25989, 
+  26050, 26096, 26098, 26156, 26188, 26203, 26204, 26209, 26219, 26231, 
+  26276, 26312, 26348, 26373, 26387, 26419, 26440, 26444, 26486, 26491, 
+  26544, 26546, 26617, 26583, 26585, 26608, 26668, 26672, 26673, 26715, 
+  26738, 26741, 26746, 26756, 26789, 26802, 26832, 26838, 26856, 26861, 
+  26864, 26865, 26876, 26897, 26899, 26933, 26939, 26967, 26979, 26994, 
+  27007, 27008, 27046, 27053, 27063, 27094, 27095, 27137, 27151, 27157, 
+  27176, 27188, 27198, 27205, 27216, 27217, 27222, 27227, 27267, 27273, 
+  27281, 27293, 27294, 27295, 27356, 27367, 27372, 27422, 27428, 27445, 
+  27462, 27478, 27488, 27522, 27582, 27617, 27633, 27664, 27699, 27701, 
+  27706, 27737, 27766, 27771, 27781, 27797, 27804, 27856, 27860, 27862, 
+  27872, 27883, 27884, 27886, 27914, 27918, 27921, 27950, 27991, 27998, 
+  28005, 28034, 28095, 28100, 28106, 28118, 28137, 28194, 28241, 28359, 
+  28362, 28366, 28413, 28442, 28458, 28463, 28467, 28506, 28510, 28514, 
+  28541, 28555, 28557, 28562, 28564, 28570, 28583, 28584, 28598, 28634, 
+  28638, 28665, 28729, 28732, 28746, 28756, 28765, 28766, 28772, 28780, 
+  28798, 28801, 28821, 28855, 28883, 28884, 28888, 28892, 28935, 28960, 
+  28977, 29002, 29010, 29024, 29049, 29074, 29107, 29131, 29139, 29142, 
+  29184, 29213, 29227, 29240, 29249, 29267, 29269, 29270, 29276, 29325, 
+  29357, 29364, 29383, 29435, 29444, 29445, 29480, 29489, 29507, 29548, 
+  29564, 29571, 29573, 29574, 29589, 29598, 29599, 29600, 29606, 29611, 
+  29621, 29623, 29628, 29647, 29657, 29673, 29684, 29693, 29700, 29706, 
+  29722, 29723, 29732, 29736, 29740, 29743, 29744, 29745, 29753, 29764, 
+  29767, 29771, 29773, 29777, 29783, 29798, 29803, 29809, 29824, 29829, 
+  29830, 29831, 29840, 29848, 29852, 29856, 29859, 29864, 29867, 29877, 
+  29887, 29896, 29914, 29918, 30030, 30073, 30081, 30096, 30098, 30099, 
+  30132, 30180, 30201, 30208, 30218, 30229, 30230, 30233, 30238, 30253, 
+  30261, 30275, 30283, 30309, 30317, 30319, 30321, 30324, 30372, 30373, 
+  30405, 30412, 30444, 30460, 30516, 30518, 30556, 30559, 30560, 30578, 
+  30589, 30613, 30634, 30694, 30704, 30708, 30726, 30754, 30765, 30766, 
+  30768, 30773, 30824, 30878, 30920, 30924, 30926, 30948, 30944, 30945, 
+  30962, 30967, 30971, 31025, 31028, 31035, 31037, 31045, 31067, 31068, 
+  31115, 31126, 31128, 31160, 31163, 31178, 31194, 31235, 31241, 31249, 
+  31262, 31277, 31289, 31301, 31308, 31325, 31328, 31341, 31352, 31392, 
+  31395, 31411, 31419, 31420, 31430, 31495, 31508, 31527, 31537, 31559, 
+  31566, 31584, 31593, 31597, 31602, 31633, 31663, 31703, 31705, 31755, 
+  31759, 31776, 31782, 31793, 31798, 31825, 31833, 31847, 31854, 31856, 
+  31932, 31935, 31944, 31945, 31959, 31961, 31965, 31979, 32007, 32008, 
+  32009, 32019, 32029, 32035, 32065, 32083, 32089, 32093, 32122, 32134, 
+  32139, 32140, 32204, 32235, 32241, 32249, 32264, 32273, 32277, 32288, 
+  32327, 32354, 32366, 32371, 32397, 32401, 32408, 32580, 32591, 32594, 
+  32595, 32609, 32657, 32703, 32718, 32735, 32741, 32748, 32750, 32751, 
+  32762, 32782, 32785, 32788, 32804, 32806, 32826, 32828, 32864, 32881, 
+  32885, 32926, 32934, 32939, 32983, 32984, 33046, 33048, 33082, 33098, 
+  33100, 33153, 33156, 33204, 33231, 33273, 33283, 33313, 33330, 33332, 
+  33350, 33355, 33359, 33422, 33454, 33463, 33470, 33478, 33534, 33603, 
+  33617, 33621, 33670, 33677, 33682, 33688, 33705, 33727, 33728, 33770, 
+  33807, 33809, 33866, 33910, 33960, 33967, 33984, 33986, 34032, 34045, 
+  34060, 34100, 34142, 34191, 34231, 34254, 34221, 34322, 34345, 34386, 
+  34403, 34412, 34415, 34426, 34445, 34449, 34456, 34471, 34472, 34554, 
+  34557, 34571, 34579, 34585, 34590, 34600, 34622, 34673, 34696, 34713, 
+  34732, 34733, 34741, 34774, 34795, 34797, 34817, 34819, 34822, 34827, 
+  34836, 34844, 34902, 34911, 34916, 34968, 34986, 35005, 35006, 35018, 
+  35026, 35035, 35056, 35057, 35078, 35096, 35097, 35098, 35111, 35120, 
+  35134, 35195, 35284, 35286, 35301, 35313, 35335, 35343, 35349, 35362, 
+  35406, 35455, 35572, 35615, 35639, 35651, 35652, 35668, 35740, 35742, 
+  35911, 35924, 35955, 36004, 36057, 36065, 36088, 36094, 36123, 36201, 
+  36204, 36228, 36237, 36245, 36262, 36294, 36302, 36324, 36332, 36384, 
+  36427, 36460, 36464, 36474, 36498, 36526, 36531, 36561, 36564, 36601, 
+  36631, 36662, 36774, 36789, 36790, 36806, 36832, 36836, 36854, 36866, 
+  36908, 36932, 37000, 37013, 37017, 37019, 37026, 37044, 37079, 37085, 
+  37108, 37143, 37148, 37169, 37178, 37181, 37192, 37211, 37217, 37220, 
+  37262, 37278, 37288, 37293, 37294, 37298, 37308, 37360, 37367, 37371, 
+  37383, 37416, 37427, 37432, 37443, 37447, 37455, 37472, 37570, 37579, 
+  37580, 37599, 37645, 37653, 37663, 37671, 37703, 37714, 37733, 37738, 
+  37741, 37787, 37818, 37801, 37825, 37834, 37858, 37882, 37885, 37903, 
+  37940, 37951, 37973, 37995, 38002, 38264, 38310, 38313, 38315, 38324, 
+  38333, 38362, 38429, 38465, 38488, 38532, 38564, 38569, 38610, 0, 
+  38622, 38633, 38641, 38658, 38665, 38746, 38755, 38766, 38771, 38810, 
+  38818, 38837, 38838, 38873, 38878, 38900, 38922, 38926, 38942, 38947, 
+  38955, 38974, 38994, 38995, 39001, 39020, 39096, 39098, 39103, 39112, 
+  39141, 39218, 39219, 39232, 39245, 39260, 39263, 39345, 39353, 39354, 
+  39369, 39426, 39446, 39460, 39463, 39469, 39470, 39478, 39480, 39498, 
+  39510, 39605, 39606, 39673, 39683, 39712, 39731, 39732, 39795, 39801, 
+  39847, 39873, 39879, 39895, 39911, 39915, 39927, 39930, 39933, 39947, 
+  39975, 39978, 39990, 40001, 40019, 40035, 40048, 40055, 40194, 40258, 
+  40263, 40291, 40297, 40316, 40318, 40333, 40369, 40387, 40391, 40406, 
+  40415, 40427, 40436, 40469, 40477, 40612, 40616, 40620, 40679, 40686, 
+  40720, 40722, 40727, 40729, 40751, 40759, 40761, 40769, 40773, 40791, 
+  40808, 40817, 40821, 40848, 40852, 40866, 20016, 13317, 0, 22048, 
+  24267, 11925, 24740, 0, 27428, 28665, 28390, 29107, 11940, 31430, 
+  32609, 32881, 32926, 11980, 37372, 23986, 38878, 20435, 20697, 20720, 
+  20931, 22134, 27220, 27905, 28112, 28226, 28377, 29668, 29729, 30060, 
+  30801, 34805, 0, 29608, 15091, 13531, 17420, 16010, 0, 65533, 
+  19432, 65533, 16090, 15138, 65533, 17786, 16531, 0, 18021, 16643, 
+  17043, 18094, 13448, 0, 63584, 63585, 63586, 63610, 63615, 12541, 
+  12542, 12445, 12446, 12291, 12294, 12540, 8800, 8806, 8807, 8734, 
+  8756, 8451, 12543, 12447, 8712, 8715, 8838, 8839, 8834, 8835, 
+  8746, 8745, 8836, 8837, 8842, 8843, 8713, 8709, 8965, 8966, 
+  8743, 8744, 8658, 8660, 8704, 8707, 8853, 8854, 8855, 8741, 
+  8742, 8736, 8869, 8706, 8711, 8801, 8786, 8810, 8811, 8730, 
+  8765, 8733, 8757, 8747, 8748, 8802, 8771, 8773, 8776, 8822, 
+  8823, 8596, 8723, 8501, 8463, 8487, 12448, 12353, 12354, 12355, 
+  12356, 12357, 12358, 12359, 12360, 12361, 12362, 12363, 12364, 12365, 
+  12366, 12367, 12368, 12369, 12370, 12371, 12372, 12373, 12374, 12375, 
+  12376, 12377, 12378, 12379, 12380, 12381, 12382, 12383, 12384, 12385, 
+  12386, 12387, 12388, 12389, 12390, 12391, 12392, 12393, 12394, 12395, 
+  12396, 12397, 12398, 12399, 12400, 12401, 12402, 12403, 12404, 12405, 
+  12406, 12407, 12408, 12409, 12410, 12411, 12412, 12413, 12414, 12415, 
+  12416, 12417, 12418, 12419, 12420, 12421, 12422, 12423, 12424, 12425, 
+  12426, 12427, 12428, 12429, 12430, 12431, 12432, 12433, 12434, 12435, 
+  12436, 12437, 12438, 0, 0, 0, 0, 0, 12449, 12450, 
+  12451, 12452, 12453, 12454, 12455, 12456, 12457, 12458, 12459, 12460, 
+  12461, 12462, 12463, 12464, 12465, 12466, 12467, 12468, 12469, 12470, 
+  12471, 12472, 12473, 12474, 12475, 12476, 12477, 12478, 12479, 12480, 
+  12481, 12482, 12483, 12484, 12485, 12486, 12487, 12488, 12489, 12490, 
+  12491, 12492, 12493, 12494, 12495, 12496, 12497, 12498, 12499, 12500, 
+  12501, 12502, 12503, 12504, 12505, 12506, 12507, 12508, 12509, 12510, 
+  12511, 12512, 12513, 12514, 12515, 12516, 12517, 12518, 12519, 12520, 
+  12521, 12522, 12523, 12524, 12525, 12526, 12527, 12528, 12529, 12530, 
+  12531, 12532, 12533, 12534, 0, 0, 0, 0, 0, 0, 
+  0, 0, 12784, 12785, 12786, 12787, 12788, 12789, 12790, 12791, 
+  12792, 12793, 0, 12794, 12795, 12796, 12797, 12798, 12799, 12535, 
+  12536, 12537, 12538, 12371, 12467, 8922, 8923, 8533, 8984, 7742, 
+  7743, 504, 505, 470, 472, 474, 476, 260, 728, 317, 
+  346, 350, 356, 377, 379, 261, 731, 318, 347, 711, 
+  351, 357, 378, 733, 380, 340, 258, 313, 262, 268, 
+  280, 270, 323, 327, 336, 344, 368, 354, 341, 259, 
+  314, 263, 269, 281, 271, 273, 324, 328, 337, 345, 
+  369, 355, 729, 264, 284, 292, 308, 348, 364, 265, 
+  285, 293, 309, 349, 365, 625, 651, 638, 620, 622, 
+  633, 648, 598, 627, 637, 642, 656, 635, 621, 607, 
+  626, 669, 654, 609, 624, 641, 295, 661, 660, 614, 
+  664, 450, 595, 599, 644, 608, 403, 616, 649, 600, 
+  604, 606, 592, 623, 650, 612, 594, 653, 613, 674, 
+  673, 597, 657, 634, 615, 865, 712, 716, 721, 8255, 
+  783, 741, 742, 743, 744, 745, 0, 0, 805, 812, 
+  825, 796, 799, 800, 829, 809, 815, 734, 804, 816, 
+  828, 820, 797, 798, 792, 793, 810, 826, 827, 794, 
+  8750, 8735, 8895, 610, 611, 618, 628, 630, 632, 640, 
+  655, 665, 668, 671, 688, 690, 695, 705, 736, 737, 
+  8714, 8721, 8749, 8818, 8819, 8856, 8862, 8864, 110, 946, 
+  952, 967, 8487, 12448, 8533, 7742, 7743, 504, 505, 470, 
+  472, 474, 476, 260, 317, 346, 350, 356, 377, 379, 
+  261, 318, 347, 351, 357, 378, 380, 340, 258, 313, 
+  262, 268, 280, 270, 323, 327, 336, 344, 368, 354, 
+  341, 259, 314, 263, 269, 281, 271, 273, 324, 328, 
+  337, 345, 369, 355, 264, 284, 292, 308, 348, 364, 
+  265, 285, 293, 309, 349, 365, 12541, 12542, 12445, 12446, 
+  12291, 12294, 12540, 12543, 12447, 12353, 12354, 12355, 12356, 12357, 
+  12358, 12359, 12360, 12361, 12362, 12363, 12364, 12365, 12366, 12367, 
+  12368, 12369, 12370, 12371, 12372, 12373, 12374, 12375, 12376, 12377, 
+  12378, 12379, 12380, 12381, 12382, 12383, 12384, 12385, 12386, 12387, 
+  12388, 12389, 12390, 12391, 12392, 12393, 12394, 12395, 12396, 12397, 
+  12398, 12399, 12400, 12401, 12402, 12403, 12404, 12405, 12406, 12407, 
+  12408, 12409, 12410, 12411, 12412, 12413, 12414, 12415, 12416, 12417, 
+  12418, 12419, 12420, 12421, 12422, 12423, 12424, 12425, 12426, 12427, 
+  12428, 12429, 12430, 12431, 12432, 12433, 12434, 12435, 12436, 12437, 
+  12438, 0, 0, 0, 0, 0, 12449, 12450, 12451, 12452, 
+  12453, 12454, 12455, 12456, 12457, 12458, 12459, 12460, 12461, 12462, 
+  12463, 12464, 12465, 12466, 12467, 12468, 12469, 12470, 12471, 12472, 
+  12473, 12474, 12475, 12476, 12477, 12478, 12479, 12480, 12481, 12482, 
+  12483, 12484, 12485, 12486, 12487, 12488, 12489, 12490, 12491, 12492, 
+  12493, 12494, 12495, 12496, 12497, 12498, 12499, 12500, 12501, 12502, 
+  12503, 12504, 12505, 12506, 12507, 12508, 12509, 12510, 12511, 12512, 
+  12513, 12514, 12515, 12516, 12517, 12518, 12519, 12520, 12521, 12522, 
+  12523, 12524, 12525, 12526, 12527, 12528, 12529, 12530, 12531, 12532, 
+  12533, 12534, 0, 0, 0, 0, 0, 0, 0, 0, 
+  12784, 12785, 12786, 12787, 12788, 12789, 12790, 12791, 12792, 12793, 
+  0, 12794, 12795, 12796, 12797, 12798, 12799, 12535, 12536, 12537, 
+  12538, 12371, 12467, 12541, 12348, 12543, 8741, 12310, 12311, 9838, 
+  9835, 10548, 10549, 10687, 8487, 12448, 8211, 10746, 10747, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 962, 9461, 9462, 9463, 9464, 9465, 9466, 9467, 
+  9468, 9469, 9470, 9750, 9751, 9649, 12784, 12785, 12786, 12787, 
+  12788, 12789, 12790, 12791, 12792, 12793, 0, 12794, 12795, 12796, 
+  12797, 12798, 12799, 9150, 9151, 9152, 9153, 9154, 9155, 9156, 
+  9157, 9158, 9159, 9160, 9161, 9162, 9163, 9164, 8254, 65343, 
+  10003, 8984, 9251, 9166, 9680, 9681, 9682, 9683, 8263, 8264, 
+  164, 8273, 8258, 12688, 12689, 12690, 12691, 12692, 12693, 12694, 
+  12695, 12696, 12697, 12698, 12699, 12700, 12701, 12702, 12703, 8713, 
+  8742, 8773, 8776, 8802, 8822, 8823, 8836, 8837, 8842, 8843, 
+  8922, 8923, 9136, 9137, 9842, 9843, 9844, 9845, 9846, 9847, 
+  9848, 9849, 9850, 9851, 9852, 9853, 12441, 12442, 8413, 12310, 
+  12311, 12448, 8211, 12784, 12785, 12786, 12787, 12788, 12789, 12790, 
+  12791, 12792, 12793, 0, 12794, 12795, 12796, 12797, 12798, 12799, 
+  9136, 9137, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 12784, 12785, 12786, 12787, 12788, 
+  12789, 12790, 12791, 12792, 12793, 0, 12794, 12795, 12796, 12797, 
+  12798, 12799, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 12784, 12785, 12786, 12787, 12788, 
+  12789, 12790, 12791, 12792, 12793, 0, 12794, 12795, 12796, 12797, 
+  12798, 12799, 10687, 9702, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 12784, 12785, 12786, 
+  12787, 12788, 12789, 12790, 12791, 12792, 12793, 0, 12794, 12795, 
+  12796, 12797, 12798, 12799, 12535, 12536, 12537, 12538, 12371, 12467, 
+  12784, 12785, 12786, 12787, 12788, 12789, 12790, 12791, 12792, 12793, 
+  0, 12794, 12795, 12796, 12797, 12798, 12799, 12371, 12467, 8800, 
+  8806, 8807, 8734, 8756, 8451, 8712, 8715, 8838, 8839, 8834, 
+  8835, 8746, 8745, 8836, 8837, 8842, 8843, 8713, 8709, 8965, 
+  8966, 8743, 8744, 8658, 8660, 8704, 8707, 8853, 8854, 8855, 
+  8741, 8742, 8736, 8869, 8706, 8711, 8801, 8786, 8810, 8811, 
+  8730, 8765, 8733, 8757, 8747, 8748, 8802, 8771, 8773, 8776, 
+  8822, 8823, 8596, 8723, 8501, 8463, 8487, 12448, 8922, 8923, 
+  8533, 8984, 7742, 7743, 504, 505, 470, 472, 474, 476, 
+  260, 728, 317, 346, 350, 356, 377, 379, 261, 731, 
+  318, 347, 711, 351, 357, 378, 733, 380, 340, 258, 
+  313, 262, 268, 280, 270, 323, 327, 336, 344, 368, 
+  354, 341, 259, 314, 263, 269, 281, 271, 273, 324, 
+  328, 337, 345, 369, 355, 729, 264, 284, 292, 308, 
+  348, 364, 265, 285, 293, 309, 349, 365, 625, 651, 
+  638, 620, 622, 633, 648, 598, 627, 637, 642, 656, 
+  635, 621, 607, 626, 669, 654, 609, 624, 641, 295, 
+  661, 660, 614, 664, 450, 595, 599, 644, 608, 403, 
+  616, 649, 600, 604, 606, 592, 623, 650, 612, 594, 
+  653, 613, 674, 673, 597, 657, 634, 615, 865, 712, 
+  716, 721, 8255, 783, 741, 742, 743, 744, 745, 0, 
+  0, 805, 812, 825, 796, 799, 800, 829, 809, 815, 
+  734, 804, 816, 828, 820, 797, 798, 792, 793, 810, 
+  826, 827, 794, 8750, 8735, 8895, 610, 611, 618, 628, 
+  630, 632, 640, 655, 665, 668, 671, 688, 690, 695, 
+  704, 736, 737, 8714, 8721, 8749, 8818, 8819, 8856, 8862, 
+  8864, 110, 946, 952, 967, 8487, 12448, 8533, 7742, 7743, 
+  504, 505, 470, 472, 474, 476, 260, 317, 346, 350, 
+  356, 377, 379, 261, 318, 347, 351, 357, 378, 380, 
+  340, 258, 313, 262, 268, 280, 270, 323, 327, 336, 
+  344, 368, 354, 341, 259, 314, 263, 269, 281, 271, 
+  273, 324, 328, 337, 345, 369, 355, 264, 284, 292, 
+  308, 348, 364, 265, 285, 293, 309, 349, 365, 20296, 
+  20319, 20330, 20332, 20494, 20504, 20545, 20722, 20688, 20742, 20739, 
+  20789, 20821, 20823, 13493, 20938, 20962, 21079, 21196, 21206, 21243, 
+  21276, 21347, 21405, 21522, 21631, 21640, 21840, 21889, 21933, 21966, 
+  22075, 22174, 22185, 22195, 22391, 22396, 0, 22479, 22500, 22628, 
+  22665, 0, 22738, 22752, 34369, 22923, 22930, 22979, 23059, 23143, 
+  23159, 23172, 23236, 0, 23421, 23443, 23570, 64060, 0, 23674, 
+  23695, 23711, 23715, 23722, 23760, 0, 23821, 23879, 23937, 23972, 
+  23975, 24011, 24158, 24313, 24320, 24322, 24355, 24381, 24404, 24445, 
+  24589, 24596, 24600, 24629, 24647, 24733, 24788, 24797, 24875, 25020, 
+  25017, 25122, 25178, 25199, 25302, 25468, 25573, 25721, 25796, 25808, 
+  25897, 26013, 26170, 26146, 26155, 26160, 26163, 26184, 0, 26231, 
+  26232, 26253, 26299, 26331, 26344, 26439, 26497, 26515, 26520, 26523, 
+  26620, 26653, 26787, 26890, 26953, 0, 26946, 26980, 27045, 27087, 
+  15286, 15299, 27113, 27125, 0, 27195, 0, 27284, 27301, 15375, 
+  27419, 27436, 27495, 27561, 27565, 27607, 27647, 27653, 27764, 27800, 
+  27899, 27846, 27953, 27961, 27967, 27992, 28052, 28074, 28123, 28125, 
+  28228, 28254, 28337, 28353, 28432, 28505, 28513, 28542, 28556, 28576, 
+  28604, 28615, 28618, 28656, 28750, 28789, 28836, 28900, 28971, 28958, 
+  28974, 29009, 29032, 29061, 29063, 29114, 29124, 29205, 15935, 29339, 
+  0, 29479, 29520, 29542, 29602, 29739, 29766, 29794, 29805, 29862, 
+  29865, 29897, 29951, 29975, 16242, 30158, 30210, 30216, 30308, 30337, 
+  30365, 30378, 30390, 30414, 30420, 30438, 30449, 30474, 30489, 30541, 
+  30542, 30586, 30592, 30612, 30688, 0, 30787, 30830, 30896, 0, 
+  30893, 30976, 31004, 31022, 31028, 31046, 31097, 31176, 0, 31188, 
+  31198, 31211, 31213, 31365, 0, 31438, 31485, 31506, 31533, 31547, 
+  31599, 31745, 31795, 0, 31853, 31865, 31887, 31892, 31904, 31957, 
+  32049, 32092, 32131, 32166, 32194, 32296, 32663, 32731, 32821, 32823, 
+  32970, 32992, 33011, 33120, 33127, 33128, 33133, 33211, 33226, 33239, 
+  17499, 33376, 33396, 0, 33441, 33443, 33444, 33449, 33471, 33493, 
+  33533, 33536, 33570, 33581, 33594, 33607, 33661, 33703, 33743, 33745, 
+  33761, 33793, 33798, 33887, 33904, 33907, 33925, 33950, 33978, 0, 
+  34098, 34078, 34095, 34148, 34170, 34188, 34210, 34251, 34285, 34303, 
+  34308, 34309, 34320, 0, 34328, 34360, 34391, 34402, 17821, 34421, 
+  34488, 34556, 34695, 17898, 34826, 34832, 35022, 0, 35122, 35129, 
+  35136, 35220, 35318, 35399, 35421, 35425, 35445, 35536, 35654, 35673, 
+  35689, 35741, 35913, 35944, 36271, 36305, 36311, 36387, 36413, 36475, 
+  0, 18500, 36602, 36638, 36653, 36692, 0, 36840, 36846, 36872, 
+  36909, 37015, 37043, 37054, 37060, 37061, 37063, 37103, 37140, 37142, 
+  37154, 37155, 37167, 37172, 37251, 37361, 37705, 37732, 37733, 37795, 
+  37855, 37892, 37939, 37962, 37987, 38001, 38286, 38303, 38316, 38326, 
+  38347, 38352, 38355, 18864, 38366, 38565, 38639, 38734, 38805, 38830, 
+  38842, 38849, 38857, 38875, 38998, 39143, 39256, 39427, 39617, 39619, 
+  39630, 39638, 39682, 39688, 19479, 39725, 39774, 39782, 39812, 39818, 
+  39838, 39886, 39909, 39928, 39971, 40015, 40016, 40037, 40221, 40222, 
+  40259, 40274, 40330, 40342, 40384, 40364, 40380, 0, 40423, 40455, 
+  40606, 40623, 40855, 0, 19970, 19983, 19986, 20009, 20014, 20039, 
+  0, 20049, 13318, 0, 20073, 20125, 13356, 20156, 20163, 20168, 
+  20203, 20186, 20209, 20213, 20246, 20324, 20279, 20286, 20312, 0, 
+  20343, 20344, 20354, 20357, 20454, 20402, 20421, 20427, 20434, 13418, 
+  20466, 20499, 20508, 20558, 20563, 20579, 20643, 20616, 20626, 20627, 
+  20629, 20650, 0, 20657, 20666, 20667, 20676, 20679, 20723, 0, 
+  20686, 0, 20692, 20705, 13458, 0, 20759, 0, 20832, 0, 
+  20851, 20867, 20875, 13500, 20888, 20899, 20909, 13511, 0, 20979, 
+  21010, 21014, 0, 21077, 21084, 21100, 21111, 21124, 21122, 0, 
+  21144, 0, 21156, 21178, 21179, 21194, 21201, 0, 21239, 21301, 
+  21314, 0, 0, 21351, 21370, 21412, 21428, 0, 21431, 21440, 
+  0, 13661, 13662, 21461, 13667, 21492, 21540, 21544, 13678, 21571, 
+  21602, 21612, 21653, 21664, 21670, 21678, 21687, 21690, 21699, 0, 
+  21740, 21743, 21745, 21747, 21760, 21761, 21769, 21820, 21825, 13734, 
+  21831, 13736, 21860, 0, 21885, 21890, 21905, 13765, 21970, 0, 
+  0, 21951, 21961, 21964, 21969, 21981, 13786, 21986, 0, 21993, 
+  22056, 0, 22023, 22032, 22064, 13812, 22077, 22080, 22087, 22110, 
+  22112, 22125, 13829, 22152, 22156, 22173, 22184, 22194, 22213, 22221, 
+  22239, 22248, 22262, 22263, 0, 0, 22313, 0, 22341, 22342, 
+  22349, 0, 22376, 22383, 22387, 22388, 22389, 22395, 0, 0, 
+  22426, 22429, 22430, 22440, 22487, 0, 22476, 0, 0, 22494, 
+  22512, 13898, 22520, 22523, 22525, 22532, 22558, 22567, 22585, 0, 
+  22601, 22604, 22631, 22666, 22667, 22669, 22671, 22672, 22676, 22685, 
+  22698, 22705, 0, 22723, 22733, 22754, 22771, 22772, 22789, 22790, 
+  22797, 22804, 0, 13969, 22845, 13977, 22854, 13974, 0, 22879, 
+  0, 22901, 22902, 22908, 22943, 22958, 22972, 22984, 22989, 23006, 
+  23015, 23022, 0, 0, 14031, 23053, 23063, 23079, 23085, 23141, 
+  23162, 23179, 23196, 23199, 23200, 23202, 23217, 23221, 23226, 23231, 
+  23258, 23260, 23269, 23280, 23278, 23285, 23304, 23319, 23348, 23372, 
+  23378, 23400, 23407, 23425, 23428, 0, 23446, 23468, 14177, 14178, 
+  23502, 23510, 14188, 14187, 23537, 23549, 14197, 23555, 23593, 0, 
+  23647, 23655, 23656, 23664, 0, 0, 0, 0, 23688, 23690, 
+  14273, 0, 0, 23712, 23714, 23719, 0, 23725, 23733, 0, 
+  23753, 0, 0, 23814, 23824, 23851, 23837, 23840, 23857, 23865, 
+  14312, 23905, 23914, 14324, 23920, 0, 14333, 23944, 14336, 23959, 
+  23984, 23988, 0, 24017, 24023, 0, 24036, 24041, 14383, 14390, 
+  14400, 24095, 24126, 24137, 14428, 24150, 14433, 24173, 24174, 0, 
+  24229, 24236, 24249, 24262, 24281, 0, 24317, 24328, 0, 24350, 
+  24391, 24419, 24434, 24446, 24463, 24482, 24519, 24523, 24530, 24531, 
+  24532, 24546, 24558, 24559, 24563, 14615, 24610, 24612, 14618, 24652, 
+  24725, 24744, 0, 24753, 24766, 24776, 24793, 24814, 24821, 24848, 
+  24857, 24862, 24890, 14703, 24897, 24902, 24928, 0, 24978, 24979, 
+  24983, 24997, 25005, 0, 25045, 25053, 25077, 0, 25123, 25170, 
+  25185, 25188, 25211, 25197, 25203, 25241, 25301, 0, 25341, 25347, 
+  25360, 0, 0, 25394, 25397, 25403, 25404, 25409, 25412, 25422, 
+  0, 25433, 0, 0, 25452, 25497, 0, 25492, 25533, 25556, 
+  25557, 25568, 25579, 25580, 25586, 25630, 25637, 25641, 25647, 25690, 
+  25693, 25715, 25725, 25735, 25745, 25759, 25803, 25804, 25813, 25815, 
+  0, 25828, 25855, 14958, 25871, 25876, 14963, 25886, 25906, 25924, 
+  25940, 25963, 25978, 25988, 25994, 26034, 26037, 26040, 26047, 26057, 
+  26068, 15062, 26105, 26108, 26116, 26120, 26145, 26154, 26181, 26193, 
+  26190, 15082, 0, 0, 0, 26218, 26220, 26221, 26235, 26240, 
+  26256, 26258, 15118, 26285, 26289, 26293, 15130, 15132, 15063, 26369, 
+  26386, 0, 26393, 0, 0, 26445, 26452, 26461, 0, 0, 
+  0, 26484, 0, 26514, 0, 33635, 26640, 26563, 26568, 26578, 
+  26587, 26615, 0, 0, 0, 26648, 26655, 26669, 0, 26675, 
+  26683, 26686, 26693, 26697, 26700, 26709, 26711, 15223, 26731, 26734, 
+  26748, 26754, 26768, 26774, 15213, 26776, 26777, 26778, 26780, 26794, 
+  26795, 26804, 26811, 26875, 0, 0, 26819, 26821, 26828, 26841, 
+  26852, 26853, 26860, 26871, 26883, 26887, 15239, 0, 15245, 26950, 
+  26985, 26988, 27002, 27026, 15268, 27030, 27056, 27066, 27068, 27072, 
+  27089, 0, 0, 0, 27107, 27118, 27119, 27123, 15309, 27124, 
+  27134, 27153, 27162, 27165, 0, 27186, 27187, 27199, 27209, 27258, 
+  27214, 27218, 27236, 0, 27275, 15344, 27297, 0, 27307, 27325, 
+  27334, 27348, 27344, 27357, 0, 0, 27377, 27378, 27379, 27389, 
+  0, 27403, 27407, 27408, 27409, 0, 27415, 15398, 27439, 27466, 
+  27480, 27500, 27509, 27514, 27521, 27547, 27566, 0, 27581, 27591, 
+  27592, 27593, 27610, 27622, 27623, 27630, 27650, 27658, 27662, 27702, 
+  0, 27725, 27739, 27757, 27780, 27785, 15555, 27796, 27799, 27821, 
+  27842, 15570, 27868, 27881, 27885, 0, 27904, 27940, 27942, 27943, 
+  27751, 27951, 27964, 27995, 28000, 28016, 28032, 28033, 28042, 28045, 
+  28049, 28056, 0, 0, 0, 0, 28075, 28078, 28084, 28098, 
+  27956, 28104, 28110, 28127, 28150, 28214, 28190, 15633, 28210, 28232, 
+  28233, 28235, 28236, 28239, 28243, 28244, 28247, 28259, 15646, 28307, 
+  28327, 28340, 28355, 28469, 28395, 28409, 28411, 28426, 28428, 28440, 
+  28453, 28470, 28476, 0, 28498, 28503, 28512, 28520, 28560, 28566, 
+  28606, 28575, 28581, 28591, 15716, 28616, 28617, 28649, 0, 28668, 
+  28672, 28682, 28707, 0, 28730, 28739, 28743, 28747, 15770, 28773, 
+  28777, 28782, 28790, 28806, 28823, 0, 28831, 28849, 0, 28908, 
+  28874, 28881, 28931, 28934, 28936, 28940, 15808, 28975, 29008, 29011, 
+  29022, 15828, 29078, 29056, 29083, 29088, 29090, 29102, 29103, 0, 
+  29145, 29148, 29191, 15877, 29236, 29241, 29250, 29271, 29283, 0, 
+  29294, 29295, 29304, 29311, 29326, 0, 29358, 29360, 29377, 15968, 
+  29388, 15974, 15976, 29427, 29434, 29447, 29458, 29464, 29465, 16003, 
+  29497, 29484, 29491, 29501, 29522, 16020, 29547, 0, 29550, 29551, 
+  29553, 29569, 29578, 29588, 29592, 29596, 29605, 29625, 29631, 29637, 
+  29643, 29665, 29671, 29689, 29715, 29690, 29697, 29779, 29760, 29763, 
+  29778, 29789, 29825, 29832, 0, 29842, 29847, 29849, 29857, 29861, 
+  29866, 29881, 29883, 29882, 29910, 29912, 29931, 0, 29946, 0, 
+  29984, 29988, 29994, 16215, 0, 30013, 30014, 30016, 30024, 30032, 
+  30034, 30066, 30065, 30074, 30077, 30078, 30092, 16245, 30114, 16247, 
+  30128, 30135, 30143, 30144, 30150, 30159, 30163, 30173, 30175, 30176, 
+  30183, 30190, 30193, 30211, 30232, 30215, 30223, 16302, 0, 30227, 
+  30235, 30236, 0, 30245, 30248, 30268, 30259, 0, 16329, 30273, 
+  0, 30281, 30293, 16343, 30318, 30357, 30369, 30368, 30375, 30376, 
+  30383, 0, 30409, 0, 30440, 0, 30487, 30490, 30509, 30517, 
+  0, 16441, 0, 0, 30552, 0, 30588, 0, 16472, 30618, 
+  30623, 30626, 30628, 30686, 30687, 30692, 30698, 30700, 30715, 0, 
+  30725, 30729, 30733, 30745, 30764, 30791, 30826, 0, 30858, 30868, 
+  30884, 30877, 30879, 30907, 30933, 30950, 30969, 30970, 30974, 0, 
+  30992, 31003, 31013, 31050, 31064, 16645, 31079, 31090, 31125, 31137, 
+  31145, 31156, 31170, 31175, 31180, 31181, 31190, 16712, 0, 0, 
+  16719, 31242, 31253, 31259, 16739, 31288, 31303, 31318, 31321, 31324, 
+  31327, 31335, 31338, 31349, 31362, 31370, 31376, 31404, 0, 16820, 
+  31417, 31422, 16831, 31436, 31464, 31476, 0, 0, 0, 31549, 
+  31530, 31534, 31535, 16870, 16883, 31615, 31553, 16878, 31573, 31609, 
+  31588, 31590, 31603, 0, 16903, 31632, 31643, 16910, 31669, 31676, 
+  31685, 31690, 0, 0, 31700, 31702, 31706, 31722, 31728, 31747, 
+  31758, 31813, 31818, 31831, 31838, 31841, 31849, 31855, 0, 0, 
+  0, 31910, 0, 31926, 31927, 0, 31940, 0, 31949, 0, 
+  0, 31974, 0, 31989, 32003, 17094, 32018, 32030, 0, 0, 
+  32061, 32062, 32064, 32071, 0, 0, 17110, 32090, 32106, 32112, 
+  17117, 32127, 0, 32136, 32151, 0, 32157, 32167, 32170, 32182, 
+  32192, 32215, 32217, 32230, 17154, 0, 64088, 32272, 32279, 32285, 
+  32295, 32300, 32325, 32373, 32382, 32390, 32391, 17195, 32410, 17219, 
+  32572, 32571, 32574, 32579, 13505, 0, 0, 32611, 32612, 32621, 
+  32637, 32638, 32656, 20859, 0, 32662, 32668, 32685, 0, 32707, 
+  32719, 32739, 32754, 32778, 32776, 32790, 32812, 32816, 32835, 32870, 
+  32891, 32921, 32924, 32932, 32935, 32952, 0, 32965, 32981, 32998, 
+  33037, 33013, 33019, 17390, 33077, 33054, 17392, 33060, 33063, 33068, 
+  0, 33085, 17416, 33129, 17431, 17436, 33157, 17442, 33176, 33202, 
+  33217, 33219, 33238, 33243, 0, 33252, 0, 33260, 33277, 33279, 
+  0, 33284, 0, 33305, 33314, 0, 33340, 33353, 33349, 0, 
+  17526, 17530, 33367, 0, 33372, 33379, 0, 17553, 33405, 33407, 
+  33411, 33418, 33427, 33447, 33448, 33458, 33460, 33466, 33468, 33506, 
+  33512, 33527, 33543, 33544, 33548, 33620, 33563, 33565, 33584, 33596, 
+  33604, 33623, 17598, 17620, 17587, 33684, 33685, 33691, 33693, 33737, 
+  33744, 33748, 33757, 33765, 33785, 33813, 0, 33815, 33849, 33871, 
+  33873, 33874, 33881, 33882, 33884, 0, 33893, 33912, 33916, 33921, 
+  17677, 33943, 33958, 33982, 17672, 33998, 33999, 34003, 0, 34023, 
+  34026, 34031, 34033, 34042, 34075, 34084, 34085, 34091, 34127, 34159, 
+  17731, 34129, 34145, 34146, 0, 34171, 34173, 34175, 34177, 34182, 
+  34195, 34205, 34207, 0, 0, 0, 34236, 34247, 34250, 34264, 
+  34265, 34271, 34273, 34278, 34294, 34304, 34321, 34334, 34337, 34340, 
+  34343, 0, 34361, 34364, 0, 34368, 34387, 34390, 34423, 34439, 
+  34441, 34460, 34461, 34481, 34483, 34497, 34499, 34513, 34517, 34519, 
+  34531, 34534, 17848, 34565, 34567, 34574, 34576, 34591, 34593, 34595, 
+  34609, 34618, 34624, 34627, 34641, 34648, 34660, 34661, 34674, 34684, 
+  0, 0, 34727, 34697, 34699, 34707, 34720, 0, 17893, 34750, 
+  0, 34753, 34766, 34783, 0, 34787, 34789, 34790, 34794, 34835, 
+  34856, 34862, 34866, 34876, 17935, 34890, 34904, 0, 0, 34921, 
+  0, 34927, 34976, 35004, 35008, 0, 35025, 35027, 17985, 35073, 
+  0, 35127, 0, 35138, 35141, 35145, 0, 35170, 35209, 35216, 
+  35231, 35248, 35255, 35288, 35307, 18081, 35315, 35325, 35327, 18095, 
+  35345, 35348, 0, 35361, 35381, 35390, 35397, 35405, 35416, 35502, 
+  35472, 35511, 35543, 35580, 0, 35594, 35589, 35597, 35612, 35629, 
+  18188, 35665, 35678, 35702, 35713, 35723, 35732, 35733, 35897, 0, 
+  35901, 0, 0, 35909, 35919, 35927, 35945, 35949, 0, 35987, 
+  35986, 35993, 18276, 35995, 36054, 36053, 0, 36081, 0, 36105, 
+  36110, 36296, 36313, 36364, 18429, 36349, 36358, 0, 36372, 36374, 
+  36385, 36386, 36391, 0, 18454, 36406, 36409, 36436, 36450, 36461, 
+  36463, 36504, 36510, 36533, 36539, 0, 18510, 0, 36608, 36616, 
+  36651, 36672, 36682, 36696, 0, 36772, 36788, 0, 36801, 36806, 
+  64036, 36810, 36813, 36819, 36821, 36849, 36853, 36859, 36876, 36919, 
+  0, 36931, 36957, 0, 0, 36997, 37004, 37008, 37025, 18613, 
+  37040, 37046, 37059, 37064, 0, 37084, 37087, 0, 37110, 37106, 
+  37120, 37099, 37118, 37119, 37124, 37126, 37144, 37150, 37175, 37177, 
+  37190, 37191, 37207, 37209, 37236, 37241, 37253, 37299, 37302, 37315, 
+  37316, 0, 0, 37356, 37377, 37398, 37399, 0, 37442, 37450, 
+  37462, 37473, 37477, 37480, 0, 37500, 37501, 37503, 37513, 37517, 
+  37527, 37529, 37535, 37547, 0, 0, 37554, 37567, 37568, 37574, 
+  37582, 37605, 37649, 0, 0, 37623, 37673, 0, 0, 37713, 
+  37722, 37739, 37745, 37747, 37793, 0, 0, 37768, 37771, 37775, 
+  37790, 37877, 0, 0, 37873, 37831, 37852, 37863, 37897, 37910, 
+  37911, 37883, 37938, 37947, 0, 0, 37997, 37999, 38265, 38278, 
+  38284, 38285, 0, 0, 38344, 0, 0, 38444, 38451, 38452, 
+  0, 38460, 38497, 0, 38530, 0, 38554, 0, 18919, 38579, 
+  38586, 38589, 18938, 0, 38616, 38618, 38621, 18948, 38676, 38691, 
+  18985, 38710, 38721, 38727, 38743, 38747, 38762, 0, 0, 38806, 
+  38814, 38833, 38834, 38846, 38860, 38865, 38868, 38872, 38881, 38897, 
+  38916, 38925, 38932, 38934, 19132, 0, 38962, 38963, 38949, 38983, 
+  39014, 39083, 39085, 39088, 0, 39095, 39099, 39100, 39106, 39111, 
+  39115, 39137, 39139, 39146, 39152, 39153, 39155, 39176, 19259, 0, 
+  39190, 39191, 0, 39194, 39195, 39196, 0, 39217, 39226, 39227, 
+  39228, 39233, 39238, 39246, 39264, 39331, 39334, 39357, 39359, 39363, 
+  39380, 39385, 39390, 0, 39408, 39417, 39420, 39434, 39441, 39450, 
+  39456, 39473, 39492, 39500, 39512, 19394, 39599, 19402, 39607, 19410, 
+  39609, 0, 39622, 39632, 39634, 39637, 39648, 39653, 39657, 39692, 
+  39696, 39698, 39702, 39708, 39723, 39741, 19488, 39755, 39779, 39781, 
+  39787, 39788, 39798, 39799, 39846, 39852, 0, 39858, 39864, 39870, 
+  39923, 39896, 39901, 39914, 39919, 39918, 0, 0, 0, 39958, 
+  39960, 39961, 39962, 39965, 39970, 39977, 0, 39985, 39991, 40005, 
+  40028, 0, 40009, 40010, 0, 40020, 40024, 40027, 40029, 40031, 
+  40041, 40042, 40043, 40045, 40046, 40050, 40053, 40058, 40166, 40178, 
+  40203, 0, 40209, 40215, 40216, 0, 19652, 0, 40242, 19665, 
+  40266, 40287, 40290, 0, 0, 40307, 40310, 40311, 40324, 40345, 
+  40353, 40383, 40373, 40377, 40381, 40393, 40410, 40416, 40419, 19719, 
+  40458, 40450, 40461, 40476, 40571, 0, 40576, 40581, 40603, 0, 
+  40637, 0, 40671, 40703, 40706, 19831, 40707, 40762, 40765, 40774, 
+  40787, 40789, 40792, 0, 40797, 0, 40809, 40813, 40816, 0, 
+  11948, 13844, 14509, 15820, 16348, 17854, 17936, 19326, 19512, 19681, 
+  19980, 20003, 20004, 20089, 20211, 20236, 20249, 20267, 20270, 20273, 
+  20356, 20382, 20407, 20484, 20492, 20556, 20575, 20578, 20599, 20622, 
+  20638, 20642, 20675, 20712, 20721, 20734, 20743, 20748, 20749, 20750, 
+  20787, 20792, 20852, 20868, 20920, 20922, 20936, 20943, 20945, 20947, 
+  20948, 20952, 20959, 20997, 21030, 21032, 21035, 21041, 21042, 21045, 
+  21052, 21082, 21088, 21102, 21112, 21113, 21130, 21132, 21217, 21225, 
+  21233, 21251, 21265, 21279, 21293, 21298, 21309, 21349, 21357, 21369, 
+  21374, 21396, 21401, 21418, 21423, 21434, 21441, 21444, 21445, 21472, 
+  21523, 21546, 21553, 21556, 21557, 21580, 21671, 21674, 21681, 21691, 
+  21710, 21738, 21756, 21765, 21768, 21781, 21799, 21802, 21814, 21841, 
+  21862, 21903, 21906, 21908, 21924, 21938, 21955, 21958, 21971, 21979, 
+  21996, 21998, 22001, 22006, 22008, 22021, 22029, 22033, 22034, 22060, 
+  22069, 22073, 22093, 22100, 22149, 22175, 22182, 22199, 22220, 22223, 
+  22233, 22241, 22251, 22253, 22257, 22279, 22284, 22298, 22299, 22301, 
+  22316, 22318, 22333, 22334, 22367, 22379, 22381, 22394, 22403, 22423, 
+  22446, 22485, 22503, 22541, 22566, 22605, 22607, 22623, 22637, 22655, 
+  22657, 22680, 22716, 22815, 22819, 22873, 22905, 22935, 22959, 22963, 
+  23007, 23025, 23032, 23218, 23224, 23274, 23286, 23323, 23325, 23329, 
+  23352, 23479, 23511, 23520, 23583, 23594, 23596, 23606, 23641, 23644, 
+  23661, 23773, 23809, 23860, 23869, 23897, 23934, 23939, 24007, 24057, 
+  24104, 24114, 24117, 24155, 24168, 24170, 24183, 24192, 24203, 24243, 
+  24253, 24273, 24276, 24277, 24397, 24492, 24554, 24583, 24649, 24660, 
+  24679, 24763, 24772, 24829, 24842, 24854, 24874, 24886, 24926, 24932, 
+  24955, 24957, 24959, 24989, 25016, 25052, 25058, 25061, 25064, 25092, 
+  25095, 25137, 25145, 25149, 25210, 25232, 25256, 25306, 25332, 25366, 
+  25386, 25398, 25414, 25419, 25427, 25457, 25461, 25471, 25474, 25482, 
+  25518, 25519, 25578, 25592, 25593, 25618, 25624, 25632, 25636, 25642, 
+  25653, 25661, 25663, 25682, 25695, 25716, 25744, 25752, 25753, 25772, 
+  25779, 25837, 25840, 25883, 25887, 25902, 25929, 25952, 26002, 26005, 
+  26036, 26046, 26056, 26062, 26064, 26079, 26238, 26251, 26252, 26291, 
+  26304, 26319, 26405, 26421, 26453, 26496, 26511, 26513, 26532, 26545, 
+  26549, 26558, 26664, 26758, 26859, 26869, 26903, 26931, 26936, 26971, 
+  26981, 27048, 27051, 27055, 27109, 27121, 27210, 27221, 27239, 27249, 
+  27311, 27336, 27337, 27395, 27451, 27455, 27517, 27518, 27568, 27639, 
+  27641, 27652, 27657, 27661, 27692, 27722, 27730, 27732, 27769, 27820, 
+  27828, 27858, 28001, 28028, 28089, 28144, 28229, 28275, 28283, 28285, 
+  28297, 28348, 28378, 28379, 28454, 28457, 28464, 28551, 28573, 28590, 
+  28599, 28685, 28704, 28745, 28824, 28848, 28885, 28886, 28997, 29106, 
+  29172, 29207, 29215, 29251, 29263, 29264, 29274, 29280, 29288, 29303, 
+  29316, 29385, 29413, 29428, 29442, 29451, 29470, 29474, 29498, 29499, 
+  29517, 29528, 29543, 29810, 29871, 29919, 29924, 29940, 29947, 29974, 
+  29985, 30015, 30046, 30105, 30116, 30145, 30148, 30156, 30167, 30172, 
+  30177, 30191, 30212, 30220, 30237, 30258, 30264, 30277, 30282, 30303, 
+  30381, 30397, 30425, 30443, 30448, 30457, 30464, 30478, 30498, 30504, 
+  30511, 30521, 30526, 30533, 30538, 30543, 30558, 30564, 30567, 30572, 
+  30596, 30604, 30605, 30614, 30631, 30639, 30647, 30654, 30665, 30673, 
+  30681, 30705, 30775, 30812, 30846, 30872, 30881, 30897, 30899, 30921, 
+  30931, 30988, 31007, 31015, 31016, 31039, 31042, 31060, 31083, 31100, 
+  31147, 31172, 31210, 31234, 31244, 31280, 31290, 31300, 31360, 31366, 
+  31380, 31413, 31421, 31486, 31531, 31607, 31648, 31660, 31664, 31720, 
+  31730, 31736, 31740, 31742, 31753, 31784, 31791, 31810, 31826, 31827, 
+  31835, 31836, 31837, 31858, 31869, 31879, 31902, 31930, 31943, 31955, 
+  31962, 32060, 32077, 32130, 32133, 32141, 32145, 32158, 32179, 32185, 
+  32208, 32229, 32245, 32246, 32303, 32310, 32324, 32367, 32376, 32385, 
+  32573, 32603, 32605, 32613, 32625, 32639, 32640, 32651, 32674, 32765, 
+  32766, 32767, 32775, 32781, 32798, 32825, 32904, 32910, 32975, 32980, 
+  33005, 33008, 33015, 33018, 33022, 33027, 33047, 33072, 33111, 33135, 
+  33139, 33163, 33168, 33179, 33182, 33227, 33237, 33245, 33246, 33249, 
+  33263, 33270, 33280, 33291, 33299, 33300, 33306, 33338, 33348, 33389, 
+  33412, 33417, 33425, 33450, 33456, 33488, 33514, 33519, 33526, 33622, 
+  33656, 33784, 33788, 33880, 33939, 33969, 33981, 34043, 34118, 34134, 
+  34141, 34181, 34200, 34370, 34374, 34496, 34580, 34594, 34606, 34617, 
+  34653, 34683, 34700, 34702, 34711, 34712, 34718, 34723, 34734, 34751, 
+  34761, 34778, 34840, 34843, 34861, 34874, 34885, 34891, 34894, 34901, 
+  34906, 34926, 34970, 34971, 34972, 35021, 35040, 35055, 35086, 35087, 
+  35110, 35125, 35162, 35164, 35179, 35184, 35196, 35237, 35253, 35260, 
+  35285, 35401, 35415, 35431, 35454, 35462, 35478, 35510, 35529, 35537, 
+  35549, 35564, 35573, 35590, 35599, 35601, 35653, 35666, 35693, 35704, 
+  35708, 35710, 35717, 35743, 35915, 35923, 35963, 36026, 36037, 36041, 
+  36050, 36076, 36085, 36087, 36097, 36099, 36119, 36124, 36206, 36241, 
+  36255, 36267, 36274, 36309, 36327, 36337, 36338, 36340, 36353, 36363, 
+  36390, 36401, 36416, 36417, 36429, 36431, 36444, 36449, 36457, 36465, 
+  36469, 36471, 36489, 36496, 36501, 36506, 36519, 36521, 36525, 36584, 
+  36592, 36615, 36632, 36645, 36647, 36652, 36661, 36666, 36675, 36679, 
+  36689, 36693, 36768, 36769, 36770, 36773, 36868, 36891, 36911, 36940, 
+  36955, 36976, 36980, 36985, 37003, 37016, 37024, 37042, 37053, 37065, 
+  37104, 37125, 37157, 37210, 37223, 37242, 37258, 37265, 37269, 37296, 
+  37307, 37309, 37314, 37317, 37376, 37385, 37411, 37494, 37518, 37551, 
+  37563, 37564, 37569, 37571, 37573, 37576, 37652, 37683, 37686, 37720, 
+  37759, 37762, 37770, 37819, 37836, 37862, 37881, 37890, 37901, 37902, 
+  37934, 37964, 38280, 38305, 38335, 38342, 38345, 38353, 38354, 38368, 
+  38372, 38374, 38436, 38449, 38456, 38461, 38484, 38516, 38523, 38527, 
+  38529, 38531, 38537, 38550, 38574, 38659, 38683, 38689, 38690, 38696, 
+  38705, 38759, 38774, 38781, 38783, 38809, 38815, 38828, 38841, 38861, 
+  38880, 38895, 38919, 38950, 38958, 39010, 39011, 39092, 39109, 39170, 
+  39185, 39189, 39221, 39240, 39252, 39262, 39393, 39436, 39440, 39459, 
+  39489, 39505, 39613, 39614, 39681, 39689, 39691, 39693, 39694, 39705, 
+  39733, 39752, 39765, 39784, 39808, 39814, 39824, 39837, 39856, 39871, 
+  39880, 39935, 39938, 39964, 39989, 40004, 40022, 40033, 40040, 40240, 
+  40253, 40298, 40315, 40421, 40425, 40435, 40570, 40578, 40579, 40580, 
+  40624, 40676, 40688, 40690, 40713, 40719, 40724, 40731, 40738, 40742, 
+  40746, 40747, 40756, 40794, 40815, 40862, 40869, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 13790, 65533, 65533, 
+  65533, 65533, 0, 19982, 20006, 0, 20339, 20566, 20717, 20843, 
+  0, 20958, 20989, 0, 21092, 21105, 21106, 21311, 21332, 21568, 
+  0, 21916, 21931, 22025, 22190, 22190, 22208, 22211, 22222, 22254, 
+  22486, 22589, 22617, 22863, 22865, 22880, 22882, 23258, 23386, 23411, 
+  23420, 23475, 0, 24131, 24231, 24291, 24376, 24481, 24541, 24930, 
+  25010, 25080, 14756, 14776, 0, 25765, 25846, 14940, 25949, 25950, 
+  0, 25991, 25993, 0, 25998, 15044, 15051, 26081, 26215, 26222, 
+  26305, 26332, 14981, 26368, 26465, 26564, 26626, 26941, 26974, 27141, 
+  27292, 15347, 27384, 27569, 27704, 27818, 28092, 28132, 15665, 28168, 
+  28274, 28363, 28373, 28379, 28507, 28507, 28516, 28532, 0, 29246, 
+  15936, 14497, 29642, 29885, 30045, 30140, 30169, 30216, 30308, 30313, 
+  30408, 30519, 30590, 31143, 31153, 31422, 31712, 31824, 32009, 32178, 
+  32178, 32574, 32737, 32786, 32887, 32982, 33033, 33065, 33292, 33307, 
+  33344, 33759, 33748, 33807, 33865, 34026, 0, 34129, 34147, 34255, 
+  34382, 34402, 34442, 34882, 34935, 35137, 35670, 35670, 35676, 18207, 
+  0, 35946, 35961, 36042, 36199, 18462, 36611, 36676, 36805, 36820, 
+  36854, 36983, 36983, 37001, 37002, 37032, 37197, 37609, 37685, 37771, 
+  37946, 38349, 38442, 38552, 38567, 38911, 38911, 39178, 39201, 39255, 
+  39848, 39854, 39865, 39944, 39972, 39995, 40053, 40166, 40384, 40386, 
+  40568, 39151, 0, 31496, 25711, 31806, 31605, 29973, 35357, 24674, 
+  28792, 24272, 31874, 38553, 34388, 33137, 37749, 21676, 29409, 26775, 
+  39851, 21449, 26454, 29990, 29969, 31432, 25402, 36929, 39361, 26023, 
+  37345, 38829, 33426, 31870, 29242, 34821, 34563, 39709, 39724, 20482, 
+  20958, 21255, 23532, 63784, 26142, 63785, 28746, 64021, 21857, 27706, 
+  31328, 0, 34819, 38315, 38741, 0, 0, 900, 901, 186, 
+  170, 8470, 272, 294, 306, 319, 330, 358, 307, 312, 
+  320, 329, 359, 266, 278, 286, 290, 288, 304, 302, 
+  310, 317, 315, 325, 342, 370, 471, 475, 473, 469, 
+  372, 374, 267, 279, 501, 287, 289, 303, 311, 318, 
+  316, 326, 343, 371, 373, 375, 8494, 8710, 8719, 8804, 
+  8805, 9674, 900, 901, 186, 170, 8470, 272, 294, 306, 
+  319, 330, 358, 307, 312, 320, 329, 359, 266, 278, 
+  286, 290, 288, 304, 302, 310, 317, 315, 325, 342, 
+  370, 471, 475, 473, 469, 372, 374, 267, 279, 501, 
+  287, 289, 303, 311, 318, 316, 326, 343, 371, 373, 
+  375, 8494, 8710, 8719, 8804, 8805, 9674, 902, 904, 905, 
+  906, 938, 908, 910, 939, 911, 940, 941, 942, 943, 
+  970, 912, 972, 973, 971, 944, 974, 1026, 1027, 1028, 
+  1029, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1038, 1039, 
+  1106, 1107, 1108, 1109, 1110, 1111, 1112, 1113, 1114, 1115, 
+  1116, 1118, 1119, 12494, 12495, 12498, 12501, 12504, 12507, 12510, 
+  12511, 12512, 12513, 12514, 12516, 12518, 12520, 12521, 12522, 12523, 
+  12524, 12525, 12527, 12528, 12529, 12530, 12531, 65, 66, 67, 
+  68, 69, 70, 32066, 72, 0, 0, 0, 0, 0, 
+  27573, 12468, 12511, 49, 50, 51, 52, 53, 54, 55, 
+  56, 57, 48, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 48, 49, 50, 51, 52, 53, 54, 
+  55, 56, 57, 48, 49, 50, 51, 52, 53, 54, 
+  55, 56, 57, 24180, 78, 22825, 20877, 26032, 26144, 22768, 
+  21069, 24460, 32066, 31435, 20132, 0, 21127, 21496, 35299, 26666, 
+  27671, 20108, 22810, 25991, 25163, 0, 0, 21452, 0, 0, 
+  0, 0, 12487, 0, 8212, 8212, 8212, 9361, 9362, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
+  0, 0, 0, 0, 0, 0, 0, 65533, 65533, 0, 
+  0, 900, 901, 186, 170, 8470, 272, 294, 306, 319, 
+  330, 358, 307, 312, 320, 329, 359, 266, 278, 286, 
+  290, 288, 304, 302, 310, 317, 315, 325, 342, 370, 
+  471, 475, 473, 469, 372, 374, 267, 279, 501, 287, 
+  289, 303, 311, 318, 316, 326, 343, 371, 373, 375, 
+  8494, 8710, 8719, 8804, 8805, 9674, 900, 901, 186, 170, 
+  8470, 272, 294, 306, 319, 330, 358, 307, 312, 320, 
+  329, 359, 266, 278, 286, 290, 288, 304, 302, 310, 
+  317, 315, 325, 342, 370, 471, 475, 473, 469, 372, 
+  374, 267, 279, 501, 287, 289, 303, 311, 318, 316, 
+  326, 343, 371, 373, 375, 8494, 8710, 8719, 8804, 8805, 
+  9674, 28322, 64064, 64032, 35711, 20021, 20060, 20067, 20072, 20084, 
+  20085, 20119, 20143, 20187, 20194, 20200, 20207, 20222, 20226, 20232, 
+  20242, 20247, 20275, 20277, 20288, 20290, 20299, 20300, 20306, 20323, 
+  20334, 20337, 20345, 20353, 20361, 20364, 20366, 20368, 20371, 20377, 
+  20383, 20409, 20411, 20412, 20413, 20416, 20417, 20422, 20424, 20428, 
+  20444, 20450, 20464, 20476, 20487, 20490, 20503, 20509, 20528, 20530, 
+  20531, 20533, 20549, 20554, 20561, 20562, 20569, 20576, 20583, 20589, 
+  20593, 20609, 20611, 20612, 20614, 20618, 20624, 20635, 20639, 20640, 
+  20641, 20655, 20656, 20665, 20669, 20672, 20691, 20700, 20701, 20703, 
+  20706, 20708, 20726, 20730, 20722, 20761, 20764, 20765, 20771, 20775, 
+  20776, 20780, 20781, 20783, 20785, 20788, 20793, 20802, 20815, 20819, 
+  20824, 20838, 20862, 20878, 20927, 20930, 20946, 20949, 20965, 20978, 
+  20983, 21016, 21026, 21061, 21080, 21087, 21120, 21125, 21141, 21142, 
+  21143, 21146, 21157, 21159, 21168, 21174, 21175, 21176, 21181, 21188, 
+  21190, 21199, 21204, 21212, 21221, 21224, 21226, 21228, 21236, 21238, 
+  21260, 21267, 21272, 21275, 21278, 21285, 21287, 21288, 21289, 21291, 
+  21292, 21296, 21308, 21337, 21339, 21349, 21379, 21383, 21384, 21390, 
+  21409, 21429, 21432, 21437, 21455, 21458, 21459, 21470, 21472, 21479, 
+  21506, 21530, 21537, 21551, 21572, 21575, 21583, 21598, 21604, 21607, 
+  21609, 21613, 21614, 21633, 21635, 21637, 21641, 21649, 21663, 21706, 
+  21728, 21750, 21758, 21772, 21773, 21810, 21819, 21821, 21833, 21837, 
+  21848, 21850, 21851, 21887, 21907, 21911, 21923, 21953, 21963, 21975, 
+  21976, 21982, 22015, 22021, 22026, 22041, 22067, 22076, 22081, 22083, 
+  22084, 22086, 22113, 22114, 22115, 22133, 22148, 22155, 22183, 22187, 
+  22206, 22219, 22224, 22236, 22245, 22246, 22247, 22273, 22274, 22289, 
+  22304, 22306, 22308, 22309, 22314, 22335, 22354, 22370, 22375, 22382, 
+  22385, 22393, 22398, 22401, 22420, 22425, 22431, 22433, 22421, 22439, 
+  22441, 22461, 22493, 22505, 22526, 22531, 22536, 22497, 22540, 22555, 
+  22559, 22573, 22591, 22608, 22613, 22632, 22648, 22663, 22664, 22668, 
+  22678, 22688, 22689, 22690, 22694, 22724, 22722, 22728, 22742, 22749, 
+  22753, 22790, 22802, 22803, 22813, 22817, 22824, 22832, 22835, 22837, 
+  22838, 22847, 22851, 22866, 22878, 22891, 22895, 22898, 22907, 22924, 
+  22926, 22933, 22951, 22957, 22960, 22967, 22977, 22980, 23023, 23026, 
+  23028, 23031, 23040, 23054, 23058, 23070, 23076, 23080, 23082, 23088, 
+  23108, 23109, 23112, 23116, 23120, 23134, 23163, 23184, 23187, 23190, 
+  23193, 23227, 23238, 23240, 23247, 23293, 23297, 23371, 23390, 23406, 
+  23430, 23438, 23440, 23441, 23444, 23464, 23465, 23469, 23471, 23473, 
+  23474, 23482, 23484, 23489, 23501, 23503, 23513, 23514, 23535, 23540, 
+  23564, 23575, 23590, 23598, 23602, 23605, 23642, 23668, 23669, 23675, 
+  23677, 23687, 23698, 23709, 23730, 23732, 23767, 23790, 23793, 23794, 
+  23826, 23843, 23871, 23880, 23893, 23889, 23903, 23904, 23906, 23908, 
+  23929, 23930, 23935, 23946, 23955, 23957, 23963, 23967, 23979, 24003, 
+  24014, 24025, 24071, 24077, 24096, 24139, 24144, 24145, 24156, 24176, 
+  24206, 24226, 24228, 24241, 24268, 24270, 24284, 24286, 24293, 24299, 
+  24326, 24345, 24356, 24363, 24364, 24366, 24368, 24383, 24388, 24411, 
+  24416, 24431, 24436, 24437, 24440, 24442, 24461, 24470, 24477, 24491, 
+  24496, 24497, 24520, 24528, 24529, 24552, 24556, 24562, 24566, 24570, 
+  24586, 24595, 24607, 24621, 24640, 24648, 24657, 24662, 24663, 24689, 
+  24702, 24706, 24710, 24712, 24718, 24721, 24723, 24728, 26079, 24738, 
+  24741, 24759, 24770, 24777, 24778, 24782, 24783, 24802, 24805, 24828, 
+  24834, 24839, 24844, 24855, 24866, 24881, 24885, 24889, 24901, 24905, 
+  24940, 24946, 24952, 24960, 24961, 24963, 24964, 24971, 24988, 24992, 
+  25002, 25024, 25025, 25038, 25039, 25054, 25057, 25063, 25065, 25068, 
+  25069, 25071, 25089, 25091, 25116, 25120, 25127, 25131, 25154, 25156, 
+  25168, 25172, 25180, 25213, 25229, 25230, 25231, 25267, 25270, 25271, 
+  25274, 25278, 25279, 25294, 25322, 25330, 25348, 25355, 25363, 25385, 
+  25389, 25418, 25426, 25428, 25432, 25435, 25446, 25453, 25464, 25493, 
+  25498, 25508, 25510, 25517, 25537, 25541, 25544, 25550, 25555, 25587, 
+  25610, 25648, 25675, 25679, 25683, 25692, 25697, 25699, 25733, 25743, 
+  25755, 25761, 25763, 25766, 25768, 25789, 25801, 25809, 25833, 25834, 
+  25845, 25857, 25864, 25865, 25866, 25875, 25894, 25905, 25914, 25916, 
+  25917, 25923, 25936, 25938, 25951, 25981, 26008, 26016, 26019, 26022, 
+  26030, 26035, 26070, 26072, 26079, 26100, 26101, 26110, 26111, 26125, 
+  26129, 26130, 26134, 26141, 26147, 26150, 26153, 26169, 26167, 26176, 
+  26182, 26186, 26200, 26208, 26229, 26239, 26233, 26236, 26266, 26267, 
+  26268, 26271, 27134, 26306, 26307, 26316, 26318, 26324, 26335, 26347, 
+  26350, 26375, 26396, 26400, 26402, 26430, 26437, 26476, 26500, 26510, 
+  26518, 26521, 26556, 26557, 26562, 26565, 26569, 26588, 26593, 26598, 
+  26610, 26614, 26644, 26649, 26663, 26671, 26687, 26698, 26712, 26735, 
+  26736, 26737, 26745, 26747, 26760, 26785, 26793, 26798, 26833, 26835, 
+  26844, 26845, 26858, 26870, 26877, 26886, 26889, 26896, 26902, 26929, 
+  26949, 26958, 26982, 26992, 26993, 27003, 27021, 27041, 27064, 27077, 
+  27080, 27134, 27136, 27139, 27168, 27172, 27191, 27221, 27242, 27265, 
+  27270, 27271, 27291, 27312, 27313, 27316, 27326, 27327, 27340, 27349, 
+  27350, 27376, 27388, 27394, 27398, 27399, 27401, 27432, 27435, 27446, 
+  27469, 27474, 27485, 27499, 27502, 27504, 27525, 27543, 27551, 27552, 
+  27554, 27555, 27560, 27564, 27576, 27577, 27587, 27588, 27619, 27666, 
+  27673, 27679, 27686, 27687, 27688, 27694, 27707, 27723, 27727, 27755, 
+  27768, 27783, 27807, 27824, 27826, 27853, 27855, 27857, 27879, 27890, 
+  27892, 27911, 27919, 27923, 27930, 27944, 27999, 28007, 28050, 28055, 
+  28087, 28093, 28128, 28130, 28133, 28143, 28148, 28160, 28164, 28219, 
+  28242, 28253, 28258, 28264, 28301, 28313, 28320, 28333, 28334, 28339, 
+  28347, 28352, 28360, 28365, 28367, 28397, 28398, 28420, 28424, 28429, 
+  28438, 28443, 28475, 28461, 28495, 28499, 28509, 28524, 28547, 28563, 
+  28582, 28592, 28613, 28648, 28669, 28695, 28719, 28724, 28727, 28740, 
+  28744, 28757, 28820, 28822, 28827, 28852, 28922, 28933, 28939, 28973, 
+  28984, 28993, 29003, 29912, 29015, 29018, 29068, 29082, 29104, 29119, 
+  29120, 29132, 29146, 29176, 29192, 29193, 29203, 29210, 29220, 29231, 
+  29253, 29262, 29278, 29291, 29297, 29307, 29308, 29321, 29331, 29352, 
+  29397, 29398, 29400, 29407, 29438, 29453, 29459, 29490, 29493, 29526, 
+  29533, 29534, 29535, 29536, 29545, 29561, 29568, 29582, 29584, 29587, 
+  29591, 29610, 29613, 29638, 29644, 29651, 29661, 29670, 29687, 29691, 
+  29695, 29696, 29713, 29741, 29799, 29800, 29806, 29839, 29841, 29850, 
+  29870, 29873, 29874, 29900, 29904, 29907, 29912, 29915, 29928, 29930, 
+  29935, 29948, 29958, 29970, 29991, 29993, 30006, 30009, 30019, 30023, 
+  30039, 30047, 30049, 30075, 30076, 30085, 30101, 30108, 30138, 30226, 
+  30243, 30249, 30265, 30266, 30272, 30276, 30297, 30341, 30348, 30349, 
+  30367, 30370, 30371, 30401, 30411, 30420, 30432, 30454, 30470, 30482, 
+  30484, 30485, 30492, 30510, 30525, 30530, 30546, 30550, 30551, 30576, 
+  30579, 30580, 30605, 30626, 30638, 30641, 30645, 30659, 30674, 30677, 
+  30712, 30734, 30737, 30749, 30755, 30788, 30792, 30796, 30802, 30814, 
+  30816, 30817, 30819, 30863, 30888, 30892, 30898, 30909, 30911, 30919, 
+  30930, 30934, 30939, 30943, 30954, 30963, 30966, 30975, 30982, 31002, 
+  31006, 31008, 31017, 31021, 31029, 31044, 31051, 31055, 31057, 31081, 
+  31099, 31102, 31116, 31121, 31123, 31132, 31144, 31151, 31183, 31197, 
+  31200, 31202, 31205, 31217, 31224, 31228, 31239, 31265, 31271, 31275, 
+  31279, 31284, 31285, 31304, 31317, 31333, 31358, 31371, 31377, 31390, 
+  31433, 31451, 31465, 31468, 31473, 31483, 31519, 31523, 31529, 31536, 
+  31540, 31551, 31552, 31594, 31620, 31625, 31630, 31638, 31653, 31666, 
+  31670, 31674, 31675, 31677, 31682, 31688, 31707, 31732, 31733, 31737, 
+  31738, 31746, 31748, 31750, 31756, 31769, 31771, 31781, 31788, 31796, 
+  31801, 31802, 31814, 31829, 31834, 31843, 31849, 31868, 31878, 31920, 
+  31931, 31951, 31956, 31977, 32015, 32017, 32022, 32038, 32042, 32045, 
+  32081, 32087, 32101, 32103, 32120, 32123, 32129, 32150, 32195, 32196, 
+  32197, 32198, 32205, 32206, 32256, 32226, 32234, 32237, 32250, 32284, 
+  32301, 32307, 32319, 32334, 32336, 32344, 32351, 32357, 32405, 32413, 
+  32414, 32575, 32604, 32614, 32640, 32653, 32655, 32678, 32682, 32692, 
+  32700, 32704, 32712, 32744, 32783, 32787, 32797, 32799, 32800, 32814, 
+  32820, 32830, 32832, 32836, 32868, 32877, 32897, 32953, 32968, 32973, 
+  32978, 33006, 33010, 33014, 33017, 33035, 33052, 33056, 33084, 33093, 
+  33095, 33106, 33121, 33143, 33158, 33166, 33174, 33186, 33198, 33221, 
+  33230, 33259, 33264, 33265, 33266, 33269, 33272, 33280, 33295, 33309, 
+  33320, 33347, 33358, 33361, 33366, 33383, 33403, 33408, 33409, 33415, 
+  33428, 33430, 33432, 33434, 33435, 33440, 33498, 33504, 33508, 33517, 
+  33546, 33547, 33566, 33567, 33569, 33580, 33582, 33587, 33591, 33597, 
+  33602, 33613, 33614, 33648, 33664, 33666, 33668, 33689, 33692, 33702, 
+  33708, 33726, 33619, 33768, 33817, 33709, 33839, 33861, 33863, 33869, 
+  33878, 33884, 33888, 33892, 33895, 33898, 33908, 33917, 33938, 33941, 
+  33961, 33962, 33991, 33992, 33996, 34034, 34039, 34050, 34051, 34055, 
+  34062, 34064, 34076, 34082, 34087, 34090, 34099, 34102, 34111, 34128, 
+  34130, 34140, 34141, 34143, 34144, 34169, 34185, 34187, 34208, 34213, 
+  34215, 34228, 34230, 34232, 34237, 34238, 34239, 34242, 34266, 34272, 
+  34280, 34291, 34300, 34317, 34318, 34329, 34331, 34358, 34362, 34365, 
+  34392, 34393, 34397, 34400, 34401, 34404, 34409, 34422, 34454, 34458, 
+  34465, 34470, 34477, 34484, 34485, 34487, 34489, 34495, 34501, 34514, 
+  34522, 34524, 34528, 34533, 34535, 34440, 34564, 34575, 34607, 34610, 
+  34620, 34621, 34629, 34637, 34657, 34671, 34691, 34692, 34693, 34694, 
+  34704, 34709, 34723, 34737, 34760, 34762, 34773, 34777, 34780, 34786, 
+  34788, 34801, 34803, 34808, 34810, 34815, 34825, 34841, 34834, 34842, 
+  34846, 34864, 34869, 34881, 34883, 34888, 34889, 34891, 34897, 34908, 
+  34912, 34929, 34937, 34939, 34944, 34975, 34984, 35002, 35019, 35020, 
+  35038, 35047, 35063, 35085, 35093, 35094, 35104, 35112, 35121, 35130, 
+  35142, 35151, 35154, 35159, 35163, 35169, 35171, 35182, 35187, 35189, 
+  35194, 35197, 35213, 35221, 35227, 35228, 35232, 35252, 35254, 35287, 
+  35305, 35309, 35321, 35332, 35333, 35358, 35360, 35364, 35366, 35371, 
+  35372, 35375, 35389, 35392, 35395, 35411, 35414, 35420, 35429, 35446, 
+  35447, 35450, 35451, 35456, 35459, 35467, 35471, 35474, 35479, 35481, 
+  35487, 35497, 35503, 35507, 35515, 35523, 35526, 35528, 35530, 35539, 
+  35540, 35541, 35568, 35583, 35595, 35614, 35632, 35644, 35650, 35656, 
+  35661, 35683, 35705, 35716, 35725, 35727, 35896, 35902, 35921, 35928, 
+  35931, 35933, 35929, 35939, 35940, 35942, 35957, 35958, 35966, 35974, 
+  35975, 35979, 35984, 35995, 35996, 36025, 36038, 36043, 36047, 36061, 
+  36072, 36079, 36082, 36095, 36197, 36223, 36226, 36232, 36240, 36254, 
+  36256, 36268, 36277, 36279, 36281, 36283, 36288, 36293, 36295, 36298, 
+  36308, 36325, 36336, 36284, 36356, 36357, 36369, 36403, 36407, 36408, 
+  36430, 36443, 36445, 36446, 36473, 36482, 36483, 36507, 36509, 36514, 
+  36538, 36545, 36547, 36548, 36551, 36572, 36590, 36593, 36599, 36589, 
+  36610, 36623, 36624, 36630, 36640, 36641, 36643, 36648, 36654, 36660, 
+  36663, 36673, 36687, 36690, 36691, 36701, 36702, 36709, 36765, 36792, 
+  36798, 36800, 36811, 36816, 36818, 36835, 36862, 36888, 36904, 36905, 
+  36906, 36915, 36916, 36927, 36962, 36966, 36972, 37006, 37029, 37068, 
+  37077, 37080, 37081, 37093, 37074, 37128, 37133, 37136, 37146, 37152, 
+  37161, 37166, 37174, 37180, 37187, 37199, 37203, 37229, 37243, 37249, 
+  37254, 37267, 37268, 37272, 37281, 37286, 37311, 37331, 37332, 37337, 
+  37353, 37354, 37359, 37369, 37373, 37380, 37381, 37388, 37394, 37395, 
+  37400, 37404, 37405, 37412, 37413, 37414, 37422, 37423, 37424, 37429, 
+  37430, 37438, 37446, 37453, 37464, 37468, 37469, 37481, 37486, 37487, 
+  37488, 37493, 37497, 37499, 37514, 37522, 37536, 37540, 37541, 37544, 
+  37558, 37560, 37562, 37565, 37575, 37581, 37592, 37596, 37597, 37601, 
+  37603, 37608, 37612, 37614, 37616, 37632, 37640, 37660, 37668, 37674, 
+  37684, 37687, 37712, 37717, 37726, 37735, 37737, 37743, 37748, 37750, 
+  37754, 37757, 37760, 37761, 37773, 37778, 37781, 37784, 37793, 37798, 
+  37800, 37803, 37812, 37813, 37814, 37828, 37829, 37833, 37835, 37837, 
+  37843, 37849, 37879, 37889, 37896, 37909, 37919, 37935, 37949, 37955, 
+  37977, 37980, 37983, 37985, 37992, 37998, 38020, 38019, 38270, 38276, 
+  38301, 38302, 38330, 38361, 38365, 38367, 38430, 38434, 38437, 38438, 
+  38455, 38457, 38458, 38482, 38486, 38487, 38510, 38524, 38526, 38545, 
+  38559, 38566, 38602, 38618, 38623, 38650, 38661, 38682, 38685, 38689, 
+  38730, 38744, 38775, 38776, 38779, 38784, 38793, 38807, 38840, 38844, 
+  38847, 38852, 38853, 38855, 38858, 38862, 38864, 38871, 38877, 38884, 
+  38903, 38904, 38906, 38937, 38940, 38944, 38959, 38965, 38980, 38986, 
+  38993, 39018, 39086, 39116, 39142, 39158, 39175, 39199, 39202, 39206, 
+  39211, 39220, 39225, 39239, 39257, 39259, 39323, 39325, 39327, 39344, 
+  39346, 39349, 39379, 39386, 39388, 39399, 39402, 39403, 39404, 39412, 
+  39413, 39421, 39422, 39428, 39435, 39454, 39458, 39475, 39477, 39495, 
+  39498, 39499, 39508, 39517, 39594, 39596, 39598, 39602, 39604, 39611, 
+  39615, 39624, 39639, 39643, 39652, 39655, 39660, 39666, 39667, 39669, 
+  39674, 39677, 39679, 39680, 39684, 39685, 39707, 39718, 39733, 39735, 
+  39737, 39738, 39756, 39766, 39767, 39771, 39777, 39786, 39789, 39790, 
+  39800, 39807, 39813, 39815, 39817, 39819, 39821, 39828, 39834, 39849, 
+  39863, 39868, 39888, 39929, 39951, 39953, 39966, 39974, 39976, 39997, 
+  40003, 40014, 40030, 40059, 40183, 40185, 40220, 40239, 40243, 40244, 
+  40250, 40252, 40261, 40275, 40276, 40293, 40323, 40326, 40334, 40338, 
+  40339, 40341, 40343, 40344, 40362, 40366, 40383, 40394, 40404, 40405, 
+  40414, 40430, 40432, 40446, 40462, 40464, 40465, 40466, 40470, 40583, 
+  40590, 40591, 40598, 40600, 40622, 40627, 40646, 40648, 40651, 40661, 
+  40684, 40685, 40689, 40693, 40696, 40721, 40726, 40730, 40735, 40753, 
+  40754, 40764, 40767, 40771, 40772, 40775, 40790, 40798, 40814, 40819, 
+  40826, 40829, 40847, 40849, 40850, 40854, 40865, 40867, }; 
+
+#define AJ162uni(cid) (AJ162uni_table[cid])
+
--- texk/xdvik/CHANGES.xdvik-jp.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/CHANGES.xdvik-jp
@@ -0,0 +1,758 @@
+2013-05-04  TANAKA Takuji  <KXD02663@nifty.ne.jp>
+
+	* dvi-draw.c, dvi-init.c, dvi.h, dvisel.c, ft2.c, ft2.h,
+	ptexvf.c, vf.c:
+	Allow characters higher than 0xFFFF
+	up to 0x10FFFF Unicode maximum (from upTeX patch).
+
+2013-05-02  TANAKA Takuji  <KXD02663@nifty.ne.jp>
+
+	* Merge changes between xdvik-22.85 and xdvik-22.86.
+	xdvik-22.86 uses "config.ps" and "config.xdvi" for configuration
+	instead of "xdvi.cfg" by default.
+	However, this version still uses "pxdvi.cfg".
+
+        * ptexvf.{c,h}, dvi-init.c, Makefile.am:
+	Rename 'zeit' to 'ptexvf'.
+
+        * ptexvf.c:
+	Suppress warning for halfwidth characters in upTeX.
+
+        * encodings.{c,h}, ft2.c, c-auto.in:
+	Use ptexenc library for JIS to Unicode conversion
+	if !HAVE_ICONV_H and HAVE_PTEXENC are set.
+
+        * jisx0208.{c,h}, Makefile.am:
+	Remove jisx0208.{c,h}.
+
+	* version.h (JPVERSION): new version j1.42.
+
+2013-04-14  TANAKA Takuji  <KXD02663@nifty.ne.jp>
+
+        * {ft2,jfm,zeit}.{c,h}, ft2vert.h:
+         Clarify copyright.
+
+2013-03-20  TANAKA Takuji  <KXD02663@nifty.ne.jp>
+
+        * special.{c,h}, dvi-draw.c, psgs.c:
+         Bug fix: drawing bounding boxes around rotatebox and scalebox
+         in "Show PS and Bounding Boxes" mode and
+         "Show Bounding Boxes Only"  mode.
+
+2013-03-03  Hironori Kitagawa  <h_kitagawa2001@yahoo.co.jp>
+
+        * AJ16.c, tounimap2h.lua: These files are under X11 license.
+
+2011-11-06  Hironori Kitagawa  <h_kitagawa2001@yahoo.co.jp>
+
+        * ptexmap.c, texmf/pxdvi.cfg: Support "/AJ16" syntax in replace
+        entries of pxdvi.cfg.
+
+2011-11-05  Hironori Kitagawa  <h_kitagawa2001@yahoo.co.jp>
+
+        * ft2.c, ptexmap.{c,h}, AJ16.c, tounimap2h.lua, texmf/pxdvi.cfg,
+          xdvi-ptex.sample:
+        Support "/AJ16" syntax which can be exist in mapfiles for dvipdfmx.
+
+        * xdvi-debug.h, ptexmap.c, util.c: Add new debug option 'ptexfnt'.
+
+2009-07-23  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* main.c: Merge changes between xdvik-22.84.13 and xdvik-22.84.16,
+	again.
+
+	* ft2.c (ft2_get_bitmap): Check freetype2 error.
+	Use XDVI_WARNING() macro.
+
+	* gui/help-window.c, c-auto.in, ptexmap.c: Fix typo.
+
+2008-07-10  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* Merge changes between xdvik-22.84.13 and xdvik-22.84.16.
+
+2008-04-07  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* ptexmap.h, ptexmap.c, ft2.c (ptexmap):
+	Adjusted member variable names: jfmname -> jfm_name,
+	vfname -> font_filename, etc.
+
+2008-04-06  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* xdvi-ptex.sample: Enhancement.
+
+2008-02-08  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* ptexmap.c (XDVI_WARNING): Replace 'fprintf(stderr, ...)'
+	with 'XDVI_WARNING((stderr, ...))'.
+	Added check for duplicated entry for ptexmap.
+
+	* ptexmap.c, ptexmap.h (mapfilename): Store map filename
+	in ptexmap structure.
+
+	* version.h (JPVERSION): new version j1.40.
+	
+2008-01-30  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* Makefile.in, dvi-init.c, encodings.c, font-open.c, ft2.c,
+	ft2.h, xdvi.h, zeit.c: Renamed 'vfontmap' to 'ptexmap'.
+
+	* ptexmap.c, ptexmap.h, xdvi-ptex.sample:
+	Renamed from vfontmap.c, vfontmap.h, vfontmap.sample.
+
+	* configure, main.c, withenable.ac, xdvi-config.h, xdvi.c:
+	Removed 'vfontmap' options.
+
+	* dvi-draw.c, texmf/xdvi.cfg, README.xdvik-jp:
+	Added ptexmap support.
+
+	* ptexmap.c, xdvi-ptex.sample: Added new code.
+
+2008-01-22  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* c-auto.in, configure, configure.in, dvi-draw.c, dvi-draw.h,
+	dvi-init.c, dvi-init.h, encodings.c, font-open.c, ft2.c,
+	ft2vert.c, jfm.c, jisx0208.c, main.c, vfontmap.c, vfontmap.h,
+	withenable.ac, xdvi-config.h, xdvi.c, xdvi.h, zeit.c, zeit.h,
+	gui/help-window.c (PTEX):
+	Replaced KANJI and USE_ZEIT macros with PTEX.
+
+	* README.xdvik-jp, configure, withenable.ac:
+	Renamed option name '--disable-kanji' to '--disable-ptex'.
+	
+	* xdvi-config.h: Removed useless USE_VFONTMAP and
+	DEFAULT_FONTCONF macros.
+
+	* version.h (JPVERSION): new version j1.36.
+
+2008-01-19  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* zeit.c (read_ZEIT_index): Do not stop even if a font
+	is not square.
+
+	* dvi-draw.c, dvi-draw.h, dvi-init.c, dvi-init.h, xdvi.h
+	(PTEX):	Added comments '/* PTEX */' around '#ifdef PTEX .. #endif'.
+
+	* configure.in, configure (tetex-build): Removed useless macro.
+
+	* dvi-draw.c (set_char_rotate_glyph): Moved body of function.
+
+	* special.c (elepsf_special) Changed int -> size_t,
+	which is same as in epsf_special().
+
+	* version.h (JPVERSION): new version j1.35.
+
+2007-12-14  TSUCHIMURA Nobuyuki  <tutimura(a)nn.iij4u.or.jp>
+
+	* c-auto.in (uint32_t): Reverted last change
+	as imported upstream fix in texk/etc/autoconf/acgeneral.m4.
+
+	* configure.in, Makefile.in (FREETYPE2CPPFLAGS, etc.):
+	Enhanced freetype2 check (ready for TeX Live).
+
+	* configure: Updated with new acgeneral.m4 and configure.in.
+
+2007-12-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* c-auto.in (uint32_t): Ad-hoc fix to avoid duplicate definition
+	error.
+
+	* Merge changes between xdvik-22.84.12 and xdvik-22.84.13.
+
+2007-07-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.84.10 and xdvik-22.84.12.
+
+2006-12-09  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* ft2vert.c: Added LGPL notices.
+
+2006-11-08  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* ft2.c, ft2.h, Makefile.in, vfontmap.c, xdvi.c, zeit.c:
+	Renamed "vf2ft.{c,h}" -> "ft2.{c,h}".
+
+	* version.h (JPVERSION): new version j1.34.
+
+2006-11-06  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* ft2vert.c (ft2vert_init): Added a detailed message
+	when FreeType2 can not handle GSUB table.
+
+	* chardef.h: Removed chardef.h which is not used.
+
+	* zeit.c (read_ZEIT_char):
+	Use struct 'glyph' mainly instead of struct 'bitmap'.
+	(read_ZEIT_index): Renamed 'j' to 'jfm'.
+	Use struct 'glyph' mainly instead of struct 'bitmap'.
+
+	* jfm.c (read_jfm): Replaced a chained pointer of struct 'jfm'
+	by an array of struct.
+	* vfontmap.c: Replaced a chained pointer of struct 'vfontmap'
+	by an array of struct.
+
+	* vfontmap.h, vfontmap.c, vf2ft.c (vfontmap):
+	Renamed 'fd' to 'ft2_index' in struct 'vfontmap'.
+	* dvi-init.h, zeit.c (font):
+	Renamed 'vf' to 'ft2_index' in struct 'font'.
+
+2006-11-05  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vf2ft.c (glyph_index, glyph_to_bitmap):
+	Separated glyph_index() and glyph_to_bitmap() from VF_GetBitmap().
+	(VF_OpenFont, VF_GetBitmap): Enabled Bold/Italic font.
+	* vfontmap.c (addfontmap): Initialized 'variant' field.
+
+	* dnpzeit.c, Makefile.in: Removed dnpzeit.c.
+	* dvi-draw.c, dvi-init.c, dvi-init.h, font-open.c, vfontmap.c,
+	vfontmap.h, xdvi-config.h, zeit.h: Removed NTTZEIT macro.
+	* README.xdvik-jp: Added an announcement that NTT JTeX (direct)
+	 support was removed.
+
+	* vf2ft.c, vf2ft.h, xdvi.c, zeit.c (ft2_init, ft2_open_font,
+	ft2_get_bitmap): Renamed VF_Init() -> ft2_init(), etc.
+	Removed needless args. Let ft2_init() static.
+	* vf2ft.c (glyph_to_bitmap): Enhanced glyph_to_bitmap()
+	to fix memory leak.
+	(ft_fonts): 'ft_fonts' became an array of flexible length instead
+	of fixed length.
+	(ft_error): 'ft_error' became a locale variable.
+	(glyph_index): Simplified glyph_index().
+
+	* zeit.c, zeit.h (open_ZEIT_font, get_ZEIT_font):
+	Removed needless func open_ZEIT_font() and get_ZEIT_font().
+	Replaced xmalloc() + memset() with xcalloc().
+
+2006-06-09  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* jisx0208.c (MAXJIS, jis2uni_table): Deleted category
+	85--92 which is out of JIS X 0208.
+	* util.c, util.h, zeit.c, dnpzeit.c (order_reverse_bitmap):
+	Renamed from reverse_endian_bitmap(). In fact, this is not
+	endian problem.
+
+2006-05-17  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* configure.in, configure (freetype):
+	Added a message when freetype is found.
+
+	* font-open.c (font_open): Fixed memory leak.
+	We must check iskanjifont() first.
+
+2006-05-09  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* encodings.c (guess_encoding): Added support for
+	ENC_UNICODE_{H|V}.
+
+	* events.c (do_sigpoll): Cleared allocated memory
+	to avoid ill condition jump.
+	Upstreamed as Request ID 1484561.
+
+2006-05-04  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (free_bitmap2): Removed free_bitmap2()
+	which leaks memory.
+	* dvi-init.c, dvi-init.h (free_bitmap2):
+	New function derived from delete_glyphs().
+	* ft2vert.c (ft2vert_init): Fixed memory leak.
+
+	* vfontmap.c, vfontmap.h (getdnpfont, isdnpfont):
+	Surround with #ifdef NTTZEIT.
+	* font-open.c (font_open): Added #ifdef NTTZEIT condition.
+
+2006-05-03  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* zeit.c, zeit.h, dnpzeit.c, util.c, util.h:
+	Moved adj_ZEIT_bitmap() in 'zeit.c' as
+	reverse_endian_bitmap() in 'util.c'.
+	* dnpzeit.c: K&R -> ANSI prototype. Removed 'register'.
+	(read_NTT_char, read_NTT_char): int -> wide_ubyte ch.
+
+	* ft2vert.c (print_offset, tag_to_string, hex_dump):
+	Surround debug part with #ifdef DEBUG .. #endif.
+
+2006-05-01  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* jfm.h, zeit.c, Makefile.in: Renamed 'jtfm.h' -> 'jfm.h'.
+	* jfm.c, zeit.c (read_jfm, read_jfm0): Moved from 'zeit.c'
+	to new file 'jfm.c'.
+	* jfm.h (read_jfm0): Removed definition of internal function.
+	* jfm.h, jfm.c (jfm): Changed member variable from fn[128] to
+	*fontname.
+	* version.h (JPVERSION): new version j1.33.
+
+2006-04-29  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* zeit.c (adj_ZEIT_bitmap): Makeing reverse_byte[]
+	by calculation instead of giving as data.
+
+2006-04-28  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* zeit.c, dnpzeit.c: Use memset() instead of bzero().
+	* zeit.c, zeit.h: Adjusted under DEBUGZEIT condition.
+	* vf2ft.c, encodings.c, dvi-draw.c, vfontmap.h:
+	Converted space -> tab.
+	* vf2ft.c, vf2ft.h, ft2vert.c: Adjusted #include headers.
+	* vfontmap.c, encodings.c: Adjusted #ifdef KANJI condition.
+	* jisx0208.c: Added #ifdef USE_ZEIT condition.
+	* dvi-draw.c: K&R -> ANSI prototype.
+	* Makefile.in: Modified dependency of headers.
+
+2006-04-27  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vfontmap.c, vfontmap.h (first_ptr): Let 'first_ptr' private
+	variable.
+	* vfontmap.c, vfontmap.h, zeit.c, dnpzeit.c
+	(getkanjifont, getdnpfont): Renamed iskanjifont() to
+	getkanjifont() and changed its return value to the pointer of
+	structure 'vfontmap' instead of the index number.
+	Defined iskanjifont() as a macro using getkanjifont().
+	* zeit.c, zeit.h (open_ZEIT_font): Changed arg to pointer
+	instead of index number.
+
+2006-04-26  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-init.c, dvi-init.h, dnpzeit.c, encodings.c, font-open.c,
+	vfontmap.c, vfontmap.h, xdvi.c, Makefile.in (iskanjifont, isdnpfont):
+	Moved iskanjifont() and isdnpfont() from dvi-init.c to
+	vfontmap.c.
+	* ft2vert.h: Removed useless comment.
+	* ft2vert.c: Added '#ifdef USE_ZEIT' condition.
+	Converted space -> tab.
+
+2006-04-25  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (oldmaxchar): Enlarged 'oldmaxchar' from ubyte
+	to wide_ubyte to save whole 'maxchar'.
+	This fixes a string search trouble for Japanese characters.
+	(upstreamed as Request ID 1475921)
+
+2006-04-19  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* jisx0208.c, jisx0208.h, Mailefile.in (jisx0208): New file derived
+	from "src/VF_Ftype.c" in VFlib2-2.25.6.
+	* vf2ft.c (UnicodeTbl, jis2uni): Removed jis2uni() which overlaps
+	in jisx0208.c.
+	* ft2vert.c (ft2vert_get_gid): Fixed typo in error message.
+
+2005-11-21  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (bbox_scale_bitmap, rotate_bitmap,
+	reverse_rotate_bitmap):	Reduced "#ifdef WORDS_BIGENDIAN .. #endif"
+	by using new macros EXTREME_LEFT_BIT, EXTREME_RIGHT_BIT,
+	and SHIFT_RIGHT().
+
+2005-11-19  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vf2ft.c (VF_GetBitmap): Clean bitmap earlier.
+	* util.c, utl.h (clear_bitmap, fill_bitmap): new function
+	* zeit.c (read_ZEIT_index): Use fill_bitmap() instead of bbox().
+	* dvi-draw.c (reverse_rotate_bitmap, rotate_bitmap,
+	bbox_scale_bitmap): Use clear_bitmap().
+	(rotate_bitmap, reverse_rotate_bitmap): K&R -> ANSI prototype.
+
+2005-11-17  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* gui/help-window.c (default_help_general): Removed VF2FT macro.
+
+2005-11-16  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* zeit.c: Converted K&R -> ANSI prototype.
+	(adj_ZEIT_bitmap): Simplified using new macro MAKE32BIT().
+	* zeit.h, jtfm.h (read_jfm0): Moved prototype.
+	* dvi-init.h (TateCorrectionTable): Removed tate adjustment.
+
+	* zeit.h, zeit.c (adj_ZEIT_bitmap, get_ZEIT_font), dnpzeit.c
+	(get_NTT_font): Omitted adjustment of bitmap padding by using 'bw'
+	parameter of VF_GetBitmap().
+	* vf2ft.c (VF_GetBitmap): Clean destination bitmap.
+
+2005-11-15  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* zeit.c (USE_PXL, jis2ccode): Removed unused macro
+	since xdvik-22.40k-j1.04.
+	(get_ZEIT_font): Removed arg 'tate'.
+	* zeit.h, zeit.c, dnpzeit.c (adj_ZEIT_bitmap):
+	Omitted #if .. #endif using dummy macro.
+	* vf2ft.c (jis2cidv): Merged into is_jis_vertical().
+
+2005-11-14  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* README.xdvik-jp: Added announce that VFlib support was removed.
+	* configure, configure.in, withenable.ac: Removed
+	'--enable-freetype' option. It is now default.
+	* configure, configure.in: Added version check of FreeType.
+	2.1.10 or latter is OK.
+	* dnpzeit.c, ft2vert.c, vf2ft.c, vfontmap.c, vfontmap.h, xdvi.c,
+	xdvi.h, zeit.c, c-auto.in, withenable.ac (VF2FT): Deleted macro.
+	* vfontmap.c (default_jfonts): Removed default_jfonts.
+	We can't know appropriate default Japanese font name.
+	* vfontmap.vflib, Makefile.in (install-data): Removed vfontmap.vflib.
+
+	* vfontmap.h, zeit.c (vfontmap): Removed member variable 'tate'.
+	* vfontmap.c (addfontmap): Removed arg variable 'tate'.
+	* zeit.c (read_ZEIT_char): Removed tate adjustment.
+	Omitted swapping bm->h and bm->w because of square metric.
+	(get_ZEIT_font): Removed code in case of (bm->h != bm->w).
+	(trim_side_blanks_in_ZEIT_bitmap): Removed.
+	(trim_tate_blanks_in_ZEIT_bitmap): Removed.
+	(get_ZEIT_font): Removed arg 'code2' which is same as 'code'.
+	* zeit.c, zeit.h (auto_shift): Removed.
+	* dvi-init.h (font): Removed member variable 'tate'.
+	* tategaki.c, Makefile.in (tategaki.o): Removed tategaki.c.
+
+2005-11-13  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* version.h (JPVERSION): new version j1.32
+	* dvi-init.c (iskanjifont): Don't ignore decimal part of tfm name.
+
+2005-11-08  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* README.xdvik-jp: Added web site URI.
+
+2005-11-07  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* Makefile.in (install-data): Specify "vfontmap.sample" etc. by
+	full path to avoid error in case of 'configure' in other directory
+	as reported by Mr. Matsuyama.
+	http://oku.edu.mie-u.ac.jp/~okumura/texfaq/qa/39125.html
+
+2005-10-31  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* zeit.c (get_ZEIT_font): Canceled needless modification glyph->y
+	when vertical writing.
+
+2005-10-27  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vf2ft.c (VF_GetBitmap): Returns ascend.
+	Rewrited bitmap transformation code.
+	* zeit.c (get_ZEIT_font): Modify glyph->y using ascend.
+	Renamed arg 'flag' -> 'tate'.
+	* version.h (JPVERSION): new version j1.31
+
+2005-10-24  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-init.c (free_bitmap2): New function.
+	Freeing g->pixmap2_gc2 is important for Fedora Core4.
+	http://oku.edu.mie-u.ac.jp/~okumura/texfaq/qa/38747.html
+
+2005-10-17  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* special.c (psfig_special): Call ps_parseraw() even if
+	INSIDE_MANE_WIN to rotate characters.
+
+	* vf2ft.c: Renamed isJISVertical() -> is_jis_vertical().
+
+2005-10-16  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vf2ft.c (VF_GetBitmap): Get vertical font only for specific
+	characters among JIS-V encode.
+	(isJISVertical): New code to decide if vertical font is needed.
+
+2005-10-14  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* xdvi.c (display_version_info): Added FreeType/VFlib information.
+
+2005-10-12  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (bbox_scale_bitmap, rotate_bitmap,
+	reverse_rotate_bitmap): Used ADD(), SUB() macro to suppress
+	gcc warning 'dereferencing type-punned pointer will break
+	strict-aliasing rules'.
+
+	* vf2ft.c (VF_OpenFont, VF_GetBitmap): Don't exit
+	when we didn't find a font file.
+
+	* vfontmap.c, ft2vert.c: Avoid compile error with VFLib.
+
+2005-10-08  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vfontmap.c: Modified comments and local variable names.
+	* vf2ft.c: Modified spacing. Added comments.
+	* ft2vert.c: Removed many debug prints.
+	* version.h (JPVERSION): new version j1.30
+	* vf2ft.c, vfontmap.c, vfontmap.h, vfontmap.sample:
+	Fix typo Identify -> Identity.
+
+2005-10-06  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vfontmap.h (vfontmap): Removed 'cidv' member variable.
+	Renamed a member variable of structure 'flag' -> 'fd'.
+
+	* vfontmap.c (addfontmap): Removed 'cid' arg.
+
+	* zeit.c (open_ZEIT_font): Removed 'cid' variable.
+
+	* vf2ft.c, vf2ft.h (VF_OpenFont): Removed 'cid' arg
+	which is equivalent to (encoding == ENC_*_V).
+	Removed 'FT_Select_Charmap(face, ft_encoding_unicode)'
+	because it is default action.
+
+	* vf2ft.h, vf2ft.c, zeit.c (VF_OpenFont):
+	Change arg encoding -> vfontmap.
+	* vf2ft.c (VF_OpenFont): Replaced "fonts[fontsmax]" by pointer.
+	* vfontmap.c (addfontmap): Clear more vfontmap members.
+	(get_vfontmap_name): Adjusted spacing.
+
+	* vf2ft.c (VF_GetBitmap): Replaced "vfonts[fid]" by pointer.
+	(VF_OpenFont): Added FT_Set_Transform() for extend/slant font.
+
+	* vf2ft.c (FT_FONTS_MAX, ft_fonts_max, ft_font):
+	Renamed from FONTSMAX, fontsmax, vfont.
+	(ft_fonts): Changed to array of pointer instead of array.
+
+2005-10-05  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-init.h, vfontmap.h (vfontmap):
+	Moved struct definition form dvi-init.h to vfontmap.h.
+
+	* dvi-init.c, vf2ft.c, zeit.c, vfontmap.c, Makefile.in:
+	Modified #include and dependence of vfontmap.h.
+
+	* vfontmap.c (read_VFontmap, str2encoding),
+	vf2ft.c (ENC_*), vf2ft.h, vfontmap.sample:
+	Changed 'vfontmap' format using JIS-H, JIS-V, etc.
+	This is *** IMPORTANT *** change.
+
+2005-09-30  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* ft2vert.c, ft2vert.h: Added new files to get vertical glyph
+	of TrueType/OpenType font by supporting GSUB vrt2/vert feature.
+
+	* Makefile.in, vf2ft.c (VF_OpenFont, VF_GetBitmap):
+	test code for ft2vert.c
+
+2005-09-20b Takanori Uchiyama <uchiyama@appi.keio.ac.jp>
+	* vfontmap.c: Cancel 2005-09-20.
+2005-09-20  Takanori Uchiyama <uchiyama@appi.keio.ac.jp>
+	* vfontmap.c (read_VFontmap): Fix a bug where a font file name 
+	(not begining with '/') was not substituted to vfname.
+
+2005-09-19  Takanori Uchiyama <uchiyama@appi.keio.ac.jp>
+
+	* vf2ft.c: FT_Select_Charmap() in case of ADOBEJAPAN encoding 
+	was deleated in VF_OpenFont() 
+
+2005-05-10  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.84.8 and xdvik-22.84.10.
+
+2005-04-25  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vfontmap.sample, vfontmap.vflib, Makefile.in (install-data):
+	Imported from
+	http://www.nn.iij4u.or.jp/~tutimura/tex/xdvik-22.40y1-j1.21.patch.gz.
+
+	* vf2ft.c (get_font_pathname): Added new code to search font file
+	by kpse_find_file().
+	(freetype/freetype.h): Removed duplicated include (FT_FREETYPE_H).
+
+2005-04-24  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* xdvi.c (display_version_info): Replaced XDVI_VERSION
+	by XDVI_TERSE_VERSION_INFO to output Japanese version.
+
+	* vfontmap.c (get_vfontmap_name): Search vfontmap as fontmap
+	and as text by kpse_find_file().
+
+2005-04-05  Robert Hart <enxrah@nottingham.ac.uk>
+
+	* dvi-draw.c (set_rotated_rule): Fix the bug which stucks when
+	displaying dvi files that contain rotated tables.
+
+2005-03-03  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* events.c (do_pages): Added checking page number for history.
+	It was up-streamed.
+
+2005-02-24  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* texmf/XDvi: Added i18n resources for Xaw.
+	Modified fontList for Motif.
+
+2005-02-09  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vf2ft.c (VF_GetBitmap): Removed multiple code.
+	(fonts): Removed useless #ifdef VF2FT .. #endif.
+
+2005-02-09  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* vf2ft.c (jis2cidv, VF_Init, VF_GetBitmap):
+	Suppress warnings. (cast (int), UNUSED(useless para), return 0)
+
+2005-02-07  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (do_char): Inserted '#ifdef KANJI'.
+	Adopted better kanji font judgment by (fontp->flags & FONT_KANJI).
+
+2005-02-05  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* encodings.c (jis2unicode): New code derived from cjk2unicode.
+	(guess_encoding): Added encoding from kanji to unicode.
+
+	* version.h (JPVERSION): j1.22.
+
+2005-02-05  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* encodings.c (cjk2unicode): Removed multiple code which warns
+	that xdvi is compiled without iconv.
+	I'll send this patch upstream.
+	
+2005-02-05  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-init.c, zeit.c, dvi-init.h (first_ptr):
+	Moved definition to header.
+
+	* Makefile.in, dvi-draw.h, dvi-init.h, dvi-init.c, font-open.c
+	(isdnpfont, iskanjifont):
+	Moved definitions to proper headers.
+	Added 'const' to the parameter.
+
+2005-02-05  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* Makefile.in, dvi-draw.h, dvi-init.h, zeit.h, dvi-init.c
+	(set_char2, read_ZEIT_index):
+	Moved definitions to proper headers.
+
+2005-02-04  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (do_char): Check kanji font case.
+	(geom_do_char): Added the case of set_char2
+	to prevent segmentation fault of find or select.
+
+2005-01-01  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.84.5 and xdvik-22.84.8.
+
+2004-11-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.84.3 and xdvik-22.84.5.
+
+2004-08-28  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (common_set_char): Exchanged the order of parameters.
+	(TEXXET): Reversed #ifndef condition
+	to catch up with the coding style of upstream.
+
+2004-08-27  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* xdvi.h (fontconf): Removed useless variable.
+
+	* xdvi.c (DEFAULT_FONTCONF,vfontcap):
+	Removed useless macro and command line option.
+
+2004-08-27  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* gui/help-window.c (default_help_general):
+	Added renderer information about FreeType or VFlib.
+
+2004-08-27  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* READMEs/README.xdvik-22.40y1-j1.21,
+	READMEs/ChangeLog.xdvik22.40y1-j1.21.html: imported from
+	http://www.nn.iij4u.or.jp/~tutimura/tex/xdvik-22.40y1-j1.21.patch.gz.
+
+	* READMEs/README.xdvik-22.40b-j1.05.patch:
+	renamed from READMEs/README.xdvik-22.40w-j1.07.patch.
+
+	* READMEs/ChangeLog.xdvik22.40b-j1.05:
+	renamed from READMEs/ChangeLog.xdvik22.40w-j1.17.
+
+2004-08-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.84.1 and xdvik-22.84.3.
+
+2004-06-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.84 and xdvik-22.84.1.
+
+2004-06-11  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.82 and xdvik-22.84.
+
+2004-04-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.81.1 and xdvik-22.82.
+
+2004-03-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.81 and xdvik-22.81.1.
+
+2004-03-04  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Makefile.in (vf2ft.o): Add vf2ft.c to its requirements.
+
+2004-03-03  Nobuyuki Tsuchimura  <tutimura(a)nn.iij4u.or.jp>
+
+	* dvi-draw.c (draw_part): Removed usless code in #ifndef PTEX --
+	#endif.
+
+2004-02-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Changes to change default path of vfontmap.
+
+	* Makefile.in (VFONTMAP): New macro.
+	(vflib_def): Refer the above.
+	(install-data): Use the above.
+
+	* withenable.ac (--with-vfontmap): New configure option.
+
+2004-02-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Changes to fix the build problem reported by Nobuyuki Tsuchimura
+	in [xdvi-jp:00640].
+
+	* configure.in: Write the include path of FreeType library to
+	FT2_CFLAGS instead of CFLAGS.
+	(FT2_CFLAGS): New output variable.
+
+	* Makefile.in (freetype_cflags): New macro.
+	(prog_cflags): Refer the above.
+
+2004-02-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* configure, configure.in: Relax the existence check of FreeType
+	library.
+
+	* vf2ft.c: Include "xdvi.h" at the top of this file, in order to
+	check "VF2FT" macro.
+
+	* dvi-draw.c: Apply the patch posted by Nobuyuki Tsuchimura in
+	[xdvi-jp:00638].
+
+2004-02-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* dvi-draw.c (set_rotated_rule): Do not refer an abolished macro
+	`HTEX'.
+
+	* version.h, vf2ft.c, vfontmap.c: Merge changes between
+	xdvik-jp-22.40w-1.17 and xdvik-jp-22.40y1-1.21.
+
+	* Merge changes between xdvik-22.77.1 and xdvik-22.81.
+
+2003-09-29  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* vf2ft.c: Apply the change described in
+	http://www.matsusaka-u.ac.jp/~okumura/texfaq/qa/21268.html.
+
+2003-09-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.77 and xdvik-22.77.1.
+
+2003-08-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.76.1 and xdvik-22.77.
+
+2003-08-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
+
+	* Merge changes between xdvik-22.40x and xdvik-22.76.1.
+
+	* Start this project based on
+	http://www.nn.iij4u.or.jp/~tutimura/tex/xdvik-22.40w-j1.17.patch.gz.
+
+	* See READMEs/ChangeLog.xdvik-22.40w-j1.17, for older entries.
+
+
+Local Variables:
+mode: change-log
+coding: utf-8
+End:
--- texk/xdvik/Makefile.am.orig	2013-04-16 07:22:53 UTC
+++ texk/xdvik/Makefile.am
@@ -87,6 +87,19 @@ libxdvi_a_SOURCES = \
 	xdvi-debug.h \
 	xserver-info.c \
 	xdvi.h \
+	ptexvf.c \
+	ptexvf.h \
+	ptexmap.c \
+	ptexmap.h \
+	ft2.c \
+	ft2.h \
+	jfm.c \
+	jfm.h \
+	fontconfig.c \
+	fontconfig.h \
+	ft2vert.c \
+	ft2vert.h \
+	AJ16.c \
 	xserver-info.h
 
 ## We cannot easily use two different libraries due to the mutual
@@ -173,9 +186,14 @@ bin_PROGRAMS = xdvi-bin
 
 xdvi_bin_SOURCES = main.c
 
-$(xdvi_bin_OBJECTS): libxdvi.a $(common_dependencies)
+$(xdvi_bin_OBJECTS): libxdvi.a $(common_dependencies) $(FREETYPE2_DEPEND) $(ZLIB_DEPEND)
 
-LDADD = libxdvi.a $(common_ldadd)
+LDADD = libxdvi.a $(common_ldadd) $(FREETYPE2_LIBS) $(ZLIB_LIBS)
+
+## Rebuild libfreetype
+@FREETYPE2_RULE@
+## Rebuild libz
+@ZLIB_RULE@
 
 # When cross-compiling, EXEEXT for the build and host systems may differ.
 # Thus we depend on the auxiliary file squeeze/stamp-squeeze.
@@ -206,14 +224,14 @@ dist_xdvi_DATA = texmf/XDvi
 pixmapdir = $(datarootdir)/texmf-dist/xdvi/pixmap
 dist_pixmap_DATA = pixmaps/toolbar.xpm pixmaps/toolbar2.xpm
 
-dist_noinst_DATA = texmf/config.xdvi
+dist_noinst_DATA = texmf/config.xdvi xdvi-ptex.sample
 
 install-data-hook:
 	@if grep "original config.xdvi --" "$(DESTDIR)$(dvipsconfdir)/config.xdvi" >/dev/null 2>&1 \
 	    || test ! -r "$(DESTDIR)$(dvipsconfdir)/config.xdvi"; then \
 	  echo " $(INSTALL_DATA) '$(srcdir)/texmf/config.xdvi' '$(DESTDIR)$(dvipsconfdir)/config.xdvi'"; \
-	  $(INSTALL_DATA) "$(srcdir)/texmf/config.xdvi" "$(DESTDIR)$(dvipsconfdir)/config.xdvi"; \
 	else :; fi
+	$(INSTALL_DATA) "$(srcdir)/xdvi-ptex.sample" "$(DESTDIR)$(xdvidir)/"
 
 uninstall-hook:
 	@if grep "original config.xdvi --" "$(DESTDIR)$(dvipsconfdir)/config.xdvi" >/dev/null 2>&1 \
--- texk/xdvik/Makefile.in.orig	2014-04-13 01:27:58 UTC
+++ texk/xdvik/Makefile.in
@@ -154,6 +154,8 @@ am_libxdvi_a_OBJECTS = browser.$(OBJEXT)
 	search-internal.$(OBJEXT) special.$(OBJEXT) \
 	string-utils.$(OBJEXT) string_list.$(OBJEXT) util.$(OBJEXT) \
 	vf.$(OBJEXT) x_util.$(OBJEXT) xdvi.$(OBJEXT) \
+	AJ16.$(OBJEXT) fontconfig.$(OBJEXT) ft2.$(OBJEXT) \
+	ft2vert.$(OBJEXT) jfm.$(OBJEXT) ptexmap.$(OBJEXT) ptexvf.$(OBJEXT) \
 	xserver-info.$(OBJEXT) gui/Panner.$(OBJEXT) gui/Tip.$(OBJEXT) \
 	gui/help-window.$(OBJEXT) gui/mag.$(OBJEXT) gui/menu.$(OBJEXT) \
 	gui/message-window.$(OBJEXT) gui/pagesel.$(OBJEXT) \
@@ -502,7 +504,7 @@ x_ldflags = $(X_LIBS) $(x_linker_options
 x_extra_libs = $(X_EXTRA_LIBS) $(iconv_libs)
 xdvi_x_libs = $(x_ldflags) $(x_tool_libs) $(x_xmu_lib) -lXt \
 	$(X_PRE_LIBS) $(x_ext_lib) $(x_xpm_libs) -lX11 $(x_extra_libs)
-common_ldadd = $(KPATHSEA_LIBS) $(FREETYPE2_LIBS) $(xdvi_x_libs)
+common_ldadd = $(KPATHSEA_LIBS) $(FREETYPE2_LIBS) $(xdvi_x_libs) -lpaper
 common_dependencies = $(KPATHSEA_DEPEND) $(FREETYPE2_DEPEND)
 libxdvi_dependencies = ${top_srcdir}/*.[ch] ${top_srcdir}/gui/*.[ch] ${top_builddir}/psheader.c
 AM_CPPFLAGS = -I$(srcdir)/gui $(common_includes)
@@ -521,6 +523,8 @@ libxdvi_a_SOURCES = alloc-debug.h browse
 	string-utils.c string-utils.h string_list.c string_list.h \
 	translations.h util.c util.h version.h vf.c x_util.c x_util.h \
 	xdvi.c xdvi-config.h xdvi-debug.h xserver-info.c xdvi.h \
+	ptexvf.c ptexvf.h ptexmap.c ptexmap.h ft2.c ft2.h jfm.c jfm.h \
+	fontconfig.c fontconfig.h ft2vert.c ft2vert.h AJ16.c \
 	xserver-info.h gui/Panner.c gui/Panner.h gui/PannerP.h \
 	gui/Tip.c gui/Tip.h gui/TipP.h gui/help-window.c \
 	gui/help-window.h gui/mag.c gui/mag.h gui/menu.c gui/menu.h \
@@ -562,10 +566,10 @@ EXTRA_DIST = psheader.txt mksedscript xd
 	xdvi.icon xdvizilla xdvizilla.1
 CLEANFILES = psheader.c sedscript xdvi.1
 nodist_man1_MANS = xdvi.1
-xdvidir = $(datarootdir)/texmf-dist/xdvi
-dvipsconfdir = $(datarootdir)/texmf-dist/dvips/config
+xdvidir = $(datarootdir)/texmf-dist/dvips/xdvi
+dvipsconfdir = $(datarootdir)/texmf-dist/dvips/xdvi
 dist_xdvi_DATA = texmf/XDvi
-pixmapdir = $(datarootdir)/texmf-dist/xdvi/pixmap
+pixmapdir = $(datarootdir)/texmf-dist/xdvi/pixmaps
 dist_pixmap_DATA = pixmaps/toolbar.xpm pixmaps/toolbar2.xpm
 dist_noinst_DATA = texmf/config.xdvi
 all: c-auto.h
--- texk/xdvik/README.xdvik-jp.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/README.xdvik-jp
@@ -0,0 +1,84 @@
+
+		<< xdvik-22.84.16-jp patch  >>
+
+		                               http://xdvi.sourceforge.jp/
+					       $Date: 2008/07/09 17:01:20 $
+
+
+[1] xdvik-22.84.16-jp patch 
+
+xdvik-22.84.16 
+
+
+
+
+
+  
+  
+  Zoom 
+  Vi 
+
+
+
+
+[2] 
+
+xdvik-22.84.16.tar.gz ./configure ; make 
+
+
+    --disable-ptex
+	
+
+FreeType 2.1.10 
+ VFlib 
+FreeType 2.2.1 GSUB 
+modules.cfg 
+'# AUX_MODULES \+= otvalid' 
+
+
+ vfontmap xdvi.cfg 
+
+	ptexmap xdvi-ptex.map
+
+xdvi.cfg  map 
+ VFONTMAP 
+ -vfontmap 
+map 
+
+NTT JTeX  (dm*/dg*) 
+
+dvips/dvipdfmx 
+ftp://ftp.math.s.chiba-u.ac.jp/tex/dvips-usage/n2bk.tar.gz
+ W32TeX 
+ftp://jupiter.fsci.fuk.kindai.ac.jp/pub/ptex/win32/current/vf-n2bk.tar.gz
+
+[3] 
+
+ upstream  import 
+
+    tar xzf xdvik-x.y.tar.gz
+    cd xdvik-x.y
+    cvs -d :ext:user@cvs.sourceforge.jp:/cvsroot/xdvi import -I ! -I CVS -m "Import xdvik-x.y." xdvik xdvik xdvik-x_y
+
+configure 
+
+    autoconf --macrodir=../etc/autoconf configure.in > configure
+
+[4] 
+
+
+ READMEs/ 
+
+
+ 
+(READMEs/ )
+
+
+	xdvi-jp  <xdvi-users(at)lists.sourceforge.jp>
+
+
+
+http://lists.sourceforge.jp/mailman/listinfo/xdvi-users 
+
+
+/* xdvi-jp  <xdvi-users(at)lists.sourceforge.jp> */
--- texk/xdvik/READMEs/ChangeLog.xdvik20a-j1.1.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/ChangeLog.xdvik20a-j1.1
@@ -0,0 +1,132 @@
+xdvik20a-j1.1 
+				 
+
+
+* xdvik20a-j1.1 ---> xdvik20a-j1.1p1  (15/5/97)
+
+	DVIFILTERCMD  jdvi2kps 
+	 (xdefs.make)
+	   
+
+	VI_KEY 
+	(xdvi.c)
+	   
+
+
+* xdvik20a-j1.1p1 ---> xdvik20a-j1.1p2  (6/6/97)
+
+	wwwlib  (markring.h)  linux 
+	   
+
+	 xdvi-17jp.960209  color special 
+	   xdvik-18f 
+	   
+
+
+* xdvik20a-j1.1p2 ---> xdvik20a-j1.1p3  (14/6/97)
+
+	SunOS 4.1.x  core dump 
+	(special.c)
+
+
+* xdvik20a-j1.1p3 ---> xdvik20a-j1.1p4  (18/6/97)
+
+	(ecl)epsf.sty  PS  height  width 
+	 (special.c)
+	   
+
+
+* xdvik20a-j1.1p4 ---> xdvik20a-j1.1p5  (23/6/97)
+
+	BSD/OS V2.1 
+	(config.h, sfinternal.h, markring.c)
+	 (ICU)  
+
+
+* xdvik20a-j1.1p5 ---> xdvik20a-j1.1p6  (24/6/97)
+
+	epsbox.sty  BoundingBox  (special.c)
+	   
+
+		fj.comp.texhax
+		<5oim44$6dj@news.cs.ehime-u.ac.jp>
+
+
+* xdvik20a-j1.1p6 ---> xdvik20a-j1.1p7  (30/6/97)
+
+	 xdvi-17jp.960209  color special 
+	eclcolor.sty  (special.c)
+
+	LaTeX 2.09 + dvips  colordvi.sty  (special.c)
+
+
+* xdvik20a-j1.1p7 ---> xdvik20a-j1.1p8  (2/8/97)
+
+	VFlib 
+	dvi --> ps  configure 
+	 (configure.in, withenable.ac, config.h)
+
+	epsbox.sty  \special  *.ps  PostScript 
+	 (special.c)
+
+
+* xdvik20a-j1.1p8 ---> xdvik20a-j1.1p9  (16/10/97)
+
+	 xdvik-20a epsf.sty  LaTeX2e  graphicx
+	 special  epsf_special() 
+	 (special.c)
+
+
+* xdvik20a-j1.1p9 ---> xdvik20a-j1.1p10  (8/11/97)
+
+	graphicx  \resizebox  \scalebox 
+	eps (gs )
+	 (special.c,
+	psgs.c, psdps.c, psnews.c)
+
+
+* xdvik20a-j1.1p10 ---> xdvik20a-j1.1p11  (25/11/97)
+
+	vfontmap 
+	(vfontmap.c)
+
+	dvi  TOC 
+	 (toc.c)
+
+
+* xdvik20a-j1.1p11 ---> xdvik20a-j1.1p12  (30/12/97)
+
+	sizeof(long)  4  (OSF1 )  (zeit.c)
+
+	vfontmap 
+	(dvi_init.c, zeit.c, vfontmap.c, xdvi.h)
+
+* xdvik20a-j1.1p12 ---> xdvik20a-j1.1p13  (04/01/98)
+
+	default  DVIFILTER  dvi2ps  dvips  (config.h)
+
+	vfontmap  (zeit.c)
+
+	dvips  -f  (config.h)
+
+
+* xdvik20a-j1.1p13 ---> xdvik20a-j1.1p14  (10/01/98)
+
+	xmalloc Segmentation Fault 
+	 (vfontmap.c)
+
+	   
+
+
+* xdvik20a-j1.1p14 ---> xdvik20a-j1.1p15  (16/01/98)
+
+	epsbox.sty 
+	"Too many open files" 
+	 (special.c)
+
+		fj.comp.texhax
+		<69cfvc$shr$1@picard.cs.osakafu-u.ac.jp>
+		<69hsme$64j$1@pine.cix.chiba-u.ac.jp>
+
+	sscanf()  BoundingBox 
+	 (special.c)
--- texk/xdvik/READMEs/ChangeLog.xdvik20c-j1.0.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/ChangeLog.xdvik20c-j1.0
@@ -0,0 +1,34 @@
+xdvik20c-j1.0p0.patch 
+                                        
+
+ xdvik20c-j1.0p0a                          (1998/4/20)
+         
+             README.xdvik20c-j1.0p0.patch
+             ChangeLog.xdvik20c-j1.0
+
+ xdvik20c-j1.0p0b                          (1998/4/24)
+         xdvi 
+                                  ()
+
+ xdvik20c-j1.0p0c                          (1998/4/24)
+         xdvi.c  prog_cflags 
+                      ()
+
+ xdvik20c-j1.0p0d                          (1998/5/19)
+         Makefile.in 
+                       (ATR)
+
+ xdvik20c-j1.0p0e                          (1999/1/20)
+         xdvi/Makefile.in 
+         xdvi/configure 
+                                         (JNC)
+
+ xdvik20c-j1.0p0f			     (1999/2/28)
+	SMALL_PANEL (pl18)
+	xdvik/events.c, xdvik-20c/xdvik/toc.c
+			  ()
+
+ xdvik20c-j1.0p1			     (1999/2/28)
+	JIS 
+	xdvik dvi_draw.c, dvi_init.c, vf.c, xdvi.h
+				      ()
--- texk/xdvik/READMEs/ChangeLog.xdvik22.40b-j1.05.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/ChangeLog.xdvik22.40b-j1.05
@@ -0,0 +1,69 @@
+/* ******************* *
+ *  xdvik-jp   *
+ * ******************* */
+
+[2001-07-08] xdvik-22.40-j1.05 (by Kenta MURATA <muraken2@nifty.com>)
+
+   xdvik-22.15-j1.04  22.40b .
+
+[2000-07-18] xdvik-22.15-j1.04 (by xdvi-jp ML)
+
+    epsbox_special() 
+    vfontmap 3
+      
+   big endian 
+     
+   PSNFSS\fontsize 5
+     
+   zoom, `10s``s`shrink
+     zoom(by 
+      & )
+
+[1999-10-04] xdvik-22.15-j1.03 (by xdvi-jp ML)
+
+    xdvik-22.15 
+   \scalebox{}  \rotatebox{}  special 
+    TFM  virtual font 
+   sizeof(int) != sizeof(long)  OS  core
+    dump 
+   VI_KEY  define 
+   PTEX  TEXXET 
+   dvips  B4 
+   ()
+
+
+[1999-03-19] xdvik-22.02-j1.02 (by @)
+
+    xdvik-22.02 
+   @  hal2 (ZOOM_BUTTON)
+   PRINTDVI (?) DVISEL 
+   
+   use_grey  use_color 
+   HSB  background special 
+   configure 
+    DVI 
+   XDvi*international: True
+   8x16 TOC 
+   
+    
+   1 DVI  First 
+   VI_KEY  define  man 
+    
+    color 2
+    
+
+
+[1999-02-28] xdvik20c-j1.0p1 (by @)
+
+ ##  READMEs/ChangeLog.xdvik20c-j1.0 
+
+
+[1998-01-16] xdvik20a-j1.1p15 (by @)
+
+ ##  READMEs/ChangeLog.xdvik20a-j1.1 
+
+
+##  READMEs/ 
+## :-)
+
+/* xdvi-jp  <xdvi-jp@bi.appi.keio.ac.jp> */
--- texk/xdvik/READMEs/ChangeLog.xdvik22.40y1-j1.21.html.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/ChangeLog.xdvik22.40y1-j1.21.html
@@ -0,0 +1,322 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
+<HTML>
+<HEAD>
+<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=EUC-JP">
+<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
+<META HTTP-EQUIV="Content-Script-type" CONTENT="text/javascript">
+<TITLE>xdvi </TITLE>
+<STYLE><!--
+P { line-height:130% }
+UL { line-height:130% }
+OL { line-height:130% }
+DL { line-height:130% }
+PRE { line-height:130% }
+--></STYLE>
+</HEAD>
+<BODY BGCOLOR="#333300" TEXT="#CCCCCC" LINK="#AACCFF" ALINK="#FF0000" VLINK="#CC99FF">
+<H2 ALIGN="center">xdvi </H2>
+<BR>
+<BLOCKQUOTE>
+<BLOCKQUOTE>
+<UL>
+<LI><A HREF="#xdvik-22.40y1">xdvik-22.40y1</A></LI><LI><A HREF="#xdvik-22.40y">xdvik-22.40y</A></LI><LI><A HREF="#xdvik-22.40w">xdvik-22.40w</A></LI><LI><A HREF="#xdvik-22.40v">xdvik-22.40v</A></LI><LI><A HREF="#xdvik-22.40u">xdvik-22.40u</A></LI><LI><A HREF="#xdvik-22.40s">xdvik-22.40s</A></LI><LI><A HREF="#xdvik-22.40q">xdvik-22.40q</A></LI><LI><A HREF="#xdvik-22.40o">xdvik-22.40o</A></LI><LI><A HREF="#xdvik-22.40l">xdvik-22.40l</A></LI><LI><A HREF="#xdvik-22.40k">xdvik-22.40k</A></LI><LI><A HREF="#makepatch">xdvik </A></LI><LI><A HREF="#update"></A></LI>
+</UL>
+</BLOCKQUOTE>
+<HR><H4><A NAME="xdvik-22.40y1">xdvik-22.40y1</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40y1-j1.21.patch.gz</CODE><BR>
+    [2004/ 2/25] dvips/dvipdfm  map  '%' 
+	vfontmap  '#' 
+	'%' 
+	
+<BR>[2004/ 2/23] oxdvi  Makefile.in 
+	texk/xdvik  <CODE>'mv Makefile.in.oxdvi Makefile.in'</CODE>
+	<CODE>'mv xdvi-sh oxdvi-sh'</CODE> 
+	oxdvi-sh  xdvi.bin  oxdvi.bin 
+	 ./configure 
+	 omega 
+	m(__)m
+<BR>[2004/ 2/23]  make; make install 
+	texmf/web2c/texmf.cnf 
+	ptex 
+	cd texk/xdvik  make install 
+	
+<LI><CODE>xdvik-22.40y1-j1.20.patch.gz</CODE><BR>
+    [2004/ 2/ 9] 
+<BR>[2004/ 2/ 9] -debug 2 
+	vf2ft  core 
+<BR>[2004/ 2/ 9] vfontmap 
+	 vfontmap 
+	 vfontmap.sample 
+	vfontmap.vflib  vfontmap.freetype 
+	 texmf/xdvi/ 
+	 texmf/xdvi/vfontmap 
+	
+	texmf/xdvi/vfontmap 
+	
+	
+	
+<LI><CODE>xdvik-22.40y1-j1.19.patch.gz</CODE><BR>
+    [2003/10/22] FreeType2 
+	
+	<A HREF="http://www.matsusaka-u.ac.jp/~okumura/texfaq/qa/22702.html">[TeX Q &amp; A:22702]</A>
+	
+	configure  freetype-config --cflags 
+	
+<BR>[2003/10/22]  VFlib/FreeType
+	
+	vf2ft.c 
+<LI><CODE>xdvik-22.40y1-j1.18.patch.gz</CODE><BR>
+    [2003/9/29] xdvik-22.40y1  update 
+	 <A HREF="http://www.matsusaka-u.ac.jp/~okumura/texfaq/qa/21268.html">[TeX Q &amp; A:21268]</A>
+	
+	vf2ft 
+	
+</UL>
+<HR><H4><A NAME="xdvik-22.40y">xdvik-22.40y</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40y-j1.17.patch.gz(155Kbyte)</CODE><BR>
+    [2003/8/20]  xdvik-22.40y 
+</UL>
+<HR><H4><A NAME="xdvik-22.40w">xdvik-22.40w</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40w-j1.17.patch.gz(155Kbyte)</CODE><BR>
+    [2003/4/9]  xdvik-22.40w 
+</UL>
+<HR><H4><A NAME="xdvik-22.40v">xdvik-22.40v</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40v-j1.17.patch.gz(155Kbyte)</CODE><BR>
+    [2003/4/7]  UTF/OTF 
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20030328/553.html">[xdvi-jp:553]</A>
+	
+<LI><CODE>xdvik-22.40v-j1.16.patch.gz(154Kbyte)</CODE><BR>
+    [2003/3/26]  UFT \CID
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20030325/546.html">[xdvi-jp:546]</A>
+	
+<LI><CODE>xdvik-22.40v-j1.15.patch.gz(154Kbyte)</CODE><BR>
+    [2003/3/26]  \scalebox 
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20030322/541.html">[xdvi-jp:541]</A>
+	
+<LI><CODE>xdvik-22.40v-j1.14.patch.gz(154Kbyte)</CODE><BR>
+    [2003/3/14] dvi-init.c  {} 
+	iNOUE 
+	<A HREF="http://www.r.dendai.ac.jp/cgi-bin/BB1/treebbs.cgi?log=3567">MacOSXLaTeXBBS</A>
+<BR>[2003/3/14] 
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20030310/532.html">[xdvi-jp:532]</A>
+	vfontmap.c 
+<LI><CODE>xdvik-22.40v-j1.13.patch.gz(153Kbyte)</CODE><BR>
+    [2003/2/11] 
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20030211/504.html">[xdvi-jp:504]</A>
+	
+<BR>[2003/2/11] resource.smallpanel 
+	btn_top_spacing 
+<BR>[2003/2/11] (^^;)
+<BR>[2003/2/10] vfontmap  kpathsea 
+	 vfontmap  close 
+<BR>[2003/2/10]    NTT jTeX 
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20030209/501.html">[xdvi-jp:501]</A>
+	
+<LI><CODE>xdvik-22.40v-j1.12.patch.gz(153Kbyte)</CODE><BR>
+    [2003/2/3]  xdvik-22.40v 
+	xdvi-search.el 
+	<BR>
+	 teTeX-src-2.0  xdvi 
+	
+	teTeX-src-2.0/reautoconf 
+</UL>
+<HR><H4><A NAME="xdvik-22.40u">xdvik-22.40u</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40u-j1.12.patch.gz(153Kbyte)</CODE><BR>
+    [2003/1/28] RPM  make install 
+	$(mandir)  $(man1dir) 
+<BR>[2003/1/23]  xdvik-22.40u 
+	
+	<BR>
+	teTeX-src-2.0-rc1  xdvi 
+	
+	configure  reject 
+	 configure.in 
+	teTeX-src-2.0-rc1/reautoconf 
+</UL>
+<HR><H4><A NAME="xdvik-22.40s">xdvik-22.40s</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40s-j1.12.patch.gz(153Kbyte)</CODE><BR>
+    [2002/12/2]  xdvik-22.40s 
+	
+	( configure  sh reautoconf 
+	xdvi-search.el ...
+</UL>
+<HR><H4><A NAME="xdvik-22.40q">xdvik-22.40q</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40q-j1.12.patch.gz(153Kbyte)</CODE><BR>
+    [2002/11/22]  xdvik-22.40q 
+	
+</UL>
+<HR><H4><A NAME="xdvik-22.40o">xdvik-22.40o</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40o-j1.12.patch.gz(153Kbyte)</CODE><BR>
+    [2002/11/22]  freetype-2.1 
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20021117/455.html">[xdvi-jp:455]</A>
+	
+<LI><CODE>xdvik-22.40o-j1.11.patch.gz(153Kbyte)</CODE><BR>
+    [2002/10/20]  xdvik-22.40o 
+	load_font() 
+	font-open.c 
+	xdvik-22.40o C (K&amp;R) 
+	
+	
+</UL>
+<HR><H4><A NAME="xdvik-22.40l">xdvik-22.40l</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40l-j1.11.patch.gz(152Kbyte)</CODE><BR>
+    [2002/9/26] @
+	<A HREF="ftp://ftp.cs.tohoku-gakuin.ac.jp/pub/TeX/TG-Local-TeX/xdvi-ft2.tar.gz">xdvi-ft2.tar.gz</A>
+	
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20020925/445.html">[xdvi-jp:445]</A>
+	
+	 texk/xdvik/READMEs/README.vf2ft 
+<LI><CODE>xdvik-22.40l-j1.10.patch.gz(126Kbyte)</CODE><BR>
+    [2002/9/16] dvi-draw.c  set_char()  set_char2()
+	
+<BR>[2002/9/16] 
+	 TOC 
+<LI><CODE>xdvik-22.40l-j1.09.patch.gz(126Kbyte)</CODE><BR>
+    [2002/9/14]  -zoombutton, -shrinkbutton
+	
+<BR>[2002/9/14] events.c  Act_zoom 
+	Act_shrink_to_dpi 
+<BR>[2002/9/14]  -smallpanel
+	+smallpanel
+	$TEXMF/xdvi/XDvi  xdvi.smallPanel: False/True 
+<BR>[2002/9/14] 
+<BR>[2002/9/14] 
+<LI><CODE>xdvik-22.40l-j1.08.patch.gz(126Kbyte)</CODE><BR>
+    [2002/9/5] xdvik-22.40l 
+	
+</UL>
+<HR><H4><A NAME="xdvik-22.40k">xdvik-22.40k</A></H4>
+<UL>
+<LI><CODE>xdvik-22.40k-j1.08.patch.gz(126Kbyte)</CODE><BR>
+    [2002/9/5] xdvi-config.h  PAGENUM 
+<BR>[2002/8/29] geom_do_rule() 
+	src-special 
+	put_rule() 
+<BR>[2002/8/28] (?) shrink_glyph_NeXT() 
+<BR>[2002/8/27] PAGENUM  TOC xdvi-config.h 
+	MARKPAGE  TOC 
+	 MAX_PAGE  RINGSIZE 
+	
+<BR>[2002/8/27] 
+	 XTRA_WID 
+	 xtra_wid 
+	
+<LI><CODE>xdvik-22.40k-j1.07.patch.gz(127Kbyte)</CODE><BR>
+    [2002/8/26] xdvik-22.40k-j1.06 
+	
+	gcc -Wall 
+	
+<LI><CODE>xdvik-22.40k-j1.06.patch.gz(126Kbyte)</CODE><BR>
+    [2002/8/26] #ifdef PAGENUM 
+<BR>[2002/8/23] 
+	
+	  
+	20.40l 
+<BR>[2002/8/20] delete_glyphs() 
+	color 
+	 struct 
+	
+<BR>[2002/8/19] dvi-init.c  SATO Tatsuya 
+	load_font() 
+<BR>[2002/8/19] dvi-init.c  job_id 
+	PTEX 
+<BR>[2002/8/19] delete_glyphs() 
+<LI><CODE>xdvik-22.40k-j1.05.patch.gz(127Kbyte)</CODE><BR>
+    [2002/8/16] #define TVERSION XDVERSION/**/JPVERSION  /**/  "" 
+<BR>[2002/8/9] 
+<BR>[2002/8/7]  delete_glyphs() 
+<BR>[2002/7/31] 
+	<EM>src special </EM>
+	
+<LI><CODE>xdvik-22.40k-j1.04.patch.gz(128Kbyte)</CODE><BR>
+    [2002/7/17] xdvik  update 
+	<A HREF="http://bi.appi.keio.ac.jp/~fml/xdvi-jp/20020121/413.html">xdvi-jp ML  @yo.rim </A> 
+	<A HREF="http://www.yo.rim.or.jp/~tnakai/xdvik-22.40g-japanese.patch.gz">xdvik-22.40g-japanese.patch.gz</A>
+	 xdvik-22.40k 
+	 DVI  src special 
+</UL>
+<p> READMEs/ChangeLog.xdvik22.40b-j1.05 
+</p>
+
+<HR><H4><A NAME="makepatch">xdvik </A></H4>
+<P> xdvik 
+
+</P>
+<P> xdvik-22.40o  xdvik-22.40o.orig/ 
+ xdvik-22.40o/ 
+</P>
+<UL>
+<LI> xdvik-22.40o/texk/xdvik 
+<LI>xdvik-22.40o/texk/xdvik/configure 
+    xdvik-22.40o/reautoconf 
+     autoconf 
+      
+    <BR>
+     gcc  -Wall 
+    xdvik-22.40o/texk/etc/autoconf/acspecific.m4
+     107  -Wall  reautoconf 
+<LI>xdvik-22.40o/texk/xdvik/Makefile.in
+    
+    
+    
+<LI>xdvik-22.40o/texk/xdvik  <CODE>'make distclean'</CODE>
+    
+    Makefile.in 
+<LI>
+    ;-p
+<LI>patch  -T 
+    
+    
+    
+</UL>
+<P>
+</P>
+<DIV ALIGN="center"><TABLE WIDTH="80%" BORDER="3" CELLPADDING="5" CELLSPACING="5">
+<TR><TD><PRE># 
+(cd xdvik-22.40o/texk/xdvi; rm *~; make distclean)
+
+# 
+diff -ruN xdvik-22.40o.orig/texk/xdvik/ xdvik-22.40o/texk/xdvik/ &gt; tmp
+
+# 
+zdiff -bBw xdvik-22.40o-j1.11.patch.gz tmp | less
+
+# 
+mv tmp xdvik-22.40o-j1.12.patch
+gzip -9 xdvik-22.40o-j1.12.patch</PRE></TD></TR></TABLE></DIV><BR>
+<HR><H4><A NAME="update"></A></H4>
+<P>
+
+
+</P>
+<UL>
+<LI>(1)
+	reject 
+<LI>(2)
+	reject 
+</UL>
+<DIV ALIGN="center"><TABLE BORDER="2" CELLPADDING="5">
+	<TR><TH>&nbsp;<TH><TD><TH></TR>
+	<TR><TH><TD>xdvik-22.40o<TD><TD>xdvik-22.40o-jp</TR>
+	<TR><TH><TD><TD><TD ALIGN="center">(2)</TR>
+	<TR><TH><TD>xdvik-22.40p<TD>(1)<TD>(xdvik-22.40p-jp)</TR>
+</TABLE></DIV>
+<P>
+
+ (2) 
+</P>
+</BLOCKQUOTE>
+<!-- footer -->
+<HR>
+<ADDRESS><A HREF="http://www.nn.iij4u.or.jp/~tutimura/"> </A>(tutimura@nn.iij4u.or.jp)</ADDRESS>
+</BODY>
+</HTML>
--- texk/xdvik/READMEs/HEADERS.DOC.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/HEADERS.DOC
@@ -0,0 +1,170 @@
+Path: tkyex1.phys.s.u-tokyo.ac.jp!news.u-tokyo.ac.jp!eccnews!ecc-s401!s31514
+From: s31514@secc.ecc.u-tokyo.ac.jp (s31514)
+Newsgroups: fj.comp.texhax
+Subject: a patch of xdvi PL18 for ASCII Nihongo TeX and VFlib 2.x
+Message-ID: <S31514.95Mar1175527@ecc-1000.ecc.u-tokyo.ac.jp>
+Date: 1 Mar 95 08:55:27 GMT
+Sender: news@secc.ecc.u-tokyo.ac.jp
+Distribution: fj
+Organization: Educational Computer Centre, The Univ. of Tokyo
+Lines: 354
+Nntp-Posting-Host: ecc-1000
+
+
+
+
+xdvi-17miyu.patch.beta6  ASCIITeX + VFlib 
+xdvi PL18 (VFlib 2.x 
+)
+
+(ASCIITeX, NTT JTeX) dvi
+(DNP, VFlib)(NTT JTeX+VFlib,
+etc.) 
+
+
+
+ memo
+=========================
+VFlib 2.15.2 ( VFlib 2.16.2 )
+patchImakefile xmkmf, make 
+
+  zeit.c  #include "VF.h" VFlib  VF.h 
+  
+porting & test  Linux 1.1.84 + gcc 2.5.8 
+  Linux + gcc 2.6.x  xdvi PL17+miyu.patch+VFlib 2.x 
+   xdvi PL18 
+  (dvi_draw.c)
+
+post(^^;
+=======================================================================
+                                     
+                      okagawa3%tkyvax.decnet@tkyux.phys.s.u-tokyo.ac.jp
+                                                        (19953)
+                       okagawa%tkyvax.decnet@tkyux.phys.s.u-tokyo.ac.jp
+                                                        (19954)
+=======================================================================
+
+Newsgroups: fj.comp.texhax
+Path: tkyex1.phys.s.u-tokyo.ac.jp!news.u-tokyo.ac.jp!wnoc-tyo-news!wnoc-sfc-news!wnoc-kyo-news!aist-nara!odins-suita!icluna!uchiyama
+From: uchiyama@bacchus.in.kobe-u.ac.jp (Takanori Uchiyama)
+Subject: Re: a patch of xdvi PL18 for ASCII Nihongo TeX and VFlib 2.x
+Sender: news@icluna.kobe-u.ac.jp (news-admin)
+Message-ID: <UCHIYAMA.95Mar13185933@in5at3.bacchus.in.kobe-u.ac.jp>
+In-Reply-To: miyu@shiratori.riec.tohoku.ac.jp's message of 13 Mar 1995 05:46:33 GMT
+Date: Mon, 13 Mar 1995 09:59:33 GMT
+Distribution: fj
+References: <S31514.95Mar1175527@ecc-1000.ecc.u-tokyo.ac.jp>
+	<UCHIYAMA.95Mar10222526@in5at3.bacchus.in.kobe-u.ac.jp>
+	<MIYU.95Mar13144633@pigeon.shiratori.riec.tohoku.ac.jp>
+Organization: Akazawa Lab. Dept. Comp. & Systems, Fac. Eng., Kobe Univ., Kobe,
+	JAPAN
+Lines: 3813
+
+.
+
+,  epsbox.sty  EPS 
+, , .
+dvi2ps-j  epsf.sty  EPS 
+,  vi  VI_KEY, DVI 
+ SELFILE . 
+
+ xdvi PL18 , , 
+.  epsbox.sty , 
+.
+
+Imakefile  VI_KEY, SELFILE . 
+. 
+
+, PL18 , . 
+	
+/usr/X11/lib/X11/app-defaults/XDvi 
+XDvi.shrinkFactor: 5
+XDvi.postscript: off
+. , shrink size  5 (400dpi 
+, 1280x1024  A4 ), ,
+ EPS  PS .
+
+, X server  16bpp ,
+. .
+
+In article <MIYU.95Mar13144633@pigeon.shiratori.riec.tohoku.ac.jp> miyu@shiratori.riec.tohoku.ac.jp (Shigeki "miyu" SUGIURA) writes:
+
+   miyu17beta.6 
+   miyu17beta.pre7 
+
+ beta.pre7 . .
+
+Newsgroups: fj.comp.texhax
+Path: tkyex1.phys.s.u-tokyo.ac.jp!news.u-tokyo.ac.jp!wnoc-tyo-news!aist-nara!odins-suita!icluna!uchiyama
+From: uchiyama@bacchus.in.kobe-u.ac.jp (Takanori Uchiyama)
+Subject: Re: a patch of xdvi PL18 for ASCII Nihongo TeX and VFlib 2.x
+Sender: news@icluna.kobe-u.ac.jp (news-admin)
+Message-ID: <UCHIYAMA.95Mar27154143@in5at3.bacchus.in.kobe-u.ac.jp>
+In-Reply-To: uchiyama@bacchus.in.kobe-u.ac.jp's message of Thu, 23 Mar 1995 08:46:43 GMT
+Date: Mon, 27 Mar 1995 06:41:43 GMT
+Distribution: fj
+References: <S31514.95Mar1175527@ecc-1000.ecc.u-tokyo.ac.jp>
+	<UCHIYAMA.95Mar10222526@in5at3.bacchus.in.kobe-u.ac.jp>
+	<MIYU.95Mar13144633@pigeon.shiratori.riec.tohoku.ac.jp>
+	<UCHIYAMA.95Mar13185933@in5at3.bacchus.in.kobe-u.ac.jp>
+	<UCHIYAMA.95Mar13221522@in5at3.bacchus.in.kobe-u.ac.jp>
+	<UCHIYAMA.95Mar14102353@in5at3.bacchus.in.kobe-u.ac.jp>
+	<UCHIYAMA.95Mar14134016@in5at3.bacchus.in.kobe-u.ac.jp>
+	<G3P012.95Mar23152316@aqua3a.cfi.waseda.ac.jp>
+	<UCHIYAMA.95Mar23174643@in5at3.bacchus.in.kobe-u.ac.jp>
+Organization: Akazawa Lab. Dept. Comp. & Systems, Fac. Eng., Kobe Univ., Kobe,
+	JAPAN
+Lines: 2567
+
+.
+
+In article <UCHIYAMA.95Mar23174643@in5at3.bacchus.in.kobe-u.ac.jp> uchiyama@bacchus.in.kobe-u.ac.jp (Takanori Uchiyama) writes:
+
+   , xdvipl18_epsbox+elepsf+selfile+vikey.patch ,
+   markpage+toc+printdvi , 
+   (640x480 
+   ). 
+
+, 
+IBM, .
+
+Newsgroups: comp.text.tex
+Path: tkyex1.phys.s.u-tokyo.ac.jp!news.u-tokyo.ac.jp!newssinet!daffy!uwvax!zebu.heurikon.com!news.sprintlink.net!howland.reston.ans.net!math.ohio-state.edu!scipio.cyberstore.ca!vanbc.wimsey.com!news.bc.net!newsserver.sfu.ca!fornax!botein.cs.sfu.ca!patrice
+From: patrice@botein.cs.sfu.ca (& Belleville)
+Subject: Re: latex2e psTricks and xdvi
+In-Reply-To: ram@cs.arizona.edu's message of 02 Apr 1995 02:05:18 GMT
+Message-ID: <PATRICE.95Apr5095907@botein.cs.sfu.ca>
+Sender: patrice@cs.sfu.ca (Patrice Belleville)
+Organization: Simon Fraser University
+References: <RAM.95Apr1190518@baskerville.cs.arizona.edu>
+Date: 05 Apr 1995 16:59:07 GMT
+Lines: 329
+
+In article <RAM.95Apr1190518@baskerville.cs.arizona.edu> ram@cs.arizona.edu (Achyutram Bhamidipaty) writes:
+
+ > I'm using the  very useful psTricks set  of macros by Timothy Van Zandt
+ > and I'm running into an annoyance.
+ > 
+ > When I use some of the special macros I can  no longer use xdvi to view
+ > my files. Is there something I need  to do to make  this work? Or is it
+ > an impossibility? Thanks for any clues or hints.
+
+	The  problem is  that pstricks requires   a PS header  file  to be
+loaded. It is normally  included at the  beginning  of your .ps file,  and
+contains  code required  used  later on by PStricks.   Since xdvi does not
+support the  "header=" special, it does not  load this file and  hence the
+bits of postscript included by PStricks fail.
+
+	I modified  the latest version   of xdvi to handle  the  "header="
+special. HOWEVER my changes only work  with gs at  the moment (if you want
+to use DPS or News, you would need to adapt  the changes I made to psgs.c,
+which  simply consist  of  detecting  when the  PostScript interpreter  is
+initialized and calling psh_includeall). I have included the context diffs
+below. You will need to apply them and recompile xdvi.
+
+Disclaimer:  these  changes seem to  work   for me.  Xdvi  might still get
+confused at times, but I believe that this is not caused  by the changes I
+made.
+
+							Good luck,
+								   Patrice
--- texk/xdvik/READMEs/InternalVars.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/InternalVars
@@ -0,0 +1,56 @@
+------------------------------------------------------------------------
+            <<<< Internal Variable for printdvi patch >>>>
+------------------------------------------------------------------------
+
+%A : like %T; '=' is put on each page number (assumed dviselect)
+%a : like %t; '=' is put on each page number (assumed dviselect)
+ B
+ b
+ C
+%c : current page number
+%D : temporal directory (environment var. TMPDIR; default is "/tmp")
+%d : directory where DVI file is placed (directory of pathname)
+ E
+%e : end page number of region; maximum of %c and %m
+%F : filename of DVI file (basename of pathname)
+%f : filename of DVI file (full pathname)
+%G : like %O; page-to-page form (=p1:p2) (assumed dviselect)
+%g : like %o; page-to-page form (=p1:p2) (assumed dviselect)
+ H
+ h
+ I
+ i
+ J
+ j
+%K : like %L; '=' is put on each page number (assumed dviselect)
+%k : like %l; '=' is put on each page number (assumed dviselect)
+%L : marked page list; marked order; separated by " "
+%l : marked page list; marked order; separated by ","
+ M
+%m : last marked page number
+ N
+ n
+%O : marked page list; sorted; page-to-page form (p1-p2); separated by " "
+%o : marked page list; sorted; page-to-page form (p1-p2); separated by ","
+%P : print command (environment var. PRINTCMD; default is "lpr -r -s -P%p")
+%p : printer name (environment var. PRINTER; default is "lp")
+ Q
+ q
+%R : DVI filter (environment var. DVIFILTER; default is "dvi2ps -o %Z")
+%r : proces id
+ S
+%s : start page number of region; minimum of %c and %m
+%T : marked page list; sorted; separated by " "
+%t : marked page list; sorted; separated by ","
+ U
+ u
+ V
+ v
+ W
+ w
+ X
+ x
+ Y
+ y
+%Z : paper size specified with -paper option (tranlated with table)
+%z : paper size specified with -paper option (lower case; ex. "a4")
--- texk/xdvik/READMEs/README.jp+toc+hal2.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.jp+toc+hal2
@@ -0,0 +1,57 @@
+ xdvi-17 (ver1.2)
+
+[ver1.1]
+@ xdvi-17jp.960209 
+  
+@ xdvi-17+markpage+toc+printdvi+paper (+patch1)
+   + 
+
+   +  button 
+
+"shrink1" xv 
+  "<"">" button 
+
+   "<" ">" +markpage 
+  toc  page (/)
+  toc  page ="T"(Top)/="B"(Bottom)
+  
+
+   xdvi  button 
+  ()
+  button 
+
+@
+
+   xdvi-18 Imakefile  #define SMALL_PANEL
+  button+toc 
+
+toctasai-ussy 
+  
+  format .dvi 
+  100000p  2p 1
+  
+
+
+xdvi-21 xdvi-21
+()
+ FreeBSD-2.1.5  ports FreeBSD 
+ version  compile 
+()
+Solaris2.3(gcc)/HPUX-9.07(gccccXmake)
+Imakefile 
+
+
+ xdvi-21\special (special.c)
+()
+
+[ver1.2]
+ FreeBSD ()
+FreeBSD-2.2.2-RELEASE(+PAO-970616) 
+/usr/include/*  package  install  /usr/X11R6/include  conflict
+ typedef PRINTDVI 
+dvi2ps  make depend 
+()
+600dpi platex-2e(2.09)
+TEXLIB  tfm(jfm) PATH 
+
+/*   hayashi@himeji-tech.ac.jp 08Aug97 */
--- texk/xdvik/READMEs/README.jp-patch.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.jp-patch
@@ -0,0 +1,778 @@
+
+            << xdvi PL17 jp-patch  >>
+
+                                        1996/02/09
+                                         
+                                        lh36112@hongo.ecc.u-tokyo.ac.jp
+                                        KHB11235@niftyserve.or.jp
+
+
+
+[0] 
+
+        [1] xdvi PL17 jp-patch 
+
+        [2] 
+          [2.1] 
+          [2.2] 
+          [2.3] 
+            [2.3.1] Imakefile 
+            [2.3.2] Makefile 
+          [2.4] 
+          [2.5] 
+          [2.6] 
+          [2.7] xdvi-17+markpage+toc+printdvi+paper patch 
+
+        [3] 
+          [3.1] ASCII pTeX  DVI 
+          [3.2] ps 
+          [3.3] postscript special 
+          [3.4] color special 
+          [3.5] DVI 
+          [3.6] -remote 
+          [3.7] VFlib version 2.x 
+          [3.8] less 
+          [3.9] tpic2.2 
+          [3.10] DVI 
+          [3.11] ASCII "" TeX 
+          [3.12] Zeit 
+          [3.13] ghostscript  postscript 
+          [3.14] dvips  epsf.sty 
+          [3.15] jdvi2kps  psfrag  ()
+          [3.16] "PS Fig" 
+
+        [4] 
+
+
+[1] xdvi PL17 jp-patch :
+
+   fj  xdvi 
+   xdvi PL17 
+  miyu patch for xdvi PL17 
+   xdvi PL17 jp-patch 
+
+  miyu-patch for xdvi PL17 
+
+    1.  ASCII pTeX  DVI 
+    2.  ps 
+    3.   postscript special 
+    4.  color special 
+    5.  DVI 
+    6.  -remote 
+    7.  VFlib version 2.x 
+    8.  less 
+
+   8  miyu-patch 
+
+    9.  tpic2.2 
+    10. DVI 
+    11. ASCII "" TeX 
+    12. Zeit 
+    13. ghostscript  postscript 
+    14. dvips  epsf.sty 
+    15. jdvi2kps  psfrag  ()
+    16. "PS Fig" 
+
+   ( 13.  
+  miyu-patch 
+
+   8 
+  [3] 
+
+[2] 
+
+  [2.1] 
+
+    
+
+      * xdvi-17.tar.gz
+         xdvi PL17 
+        ftp://ftp.tohoku.ac.jp/pub/tex/dviwares/xdvi/PL17 
+        anonymous ftp 
+
+      * xdvi-17jp.YYMMDD.gz
+        "YYMMDD"  960209 
+
+    
+     VFlib  version 2 
+    miyu patch  version 1.x 
+     ([3.7] )
+    
+
+    VFlib VFlib 
+    VFlib 
+
+      ftp://gull.se.hiroshima-u.ac.jp/pub/VFlib
+
+     anonymous ftp 
+
+     GNU  gzip  patch 
+    
+    
+
+  [2.2] 
+
+    * 
+    *  xdvi-17.tar.gz 
+    * 
+
+     xdvi-17.tar.gz 
+     xdvi-17  
+    
+
+        <  >
+
+	% set srcdir=$pwd
+	% mkdir xdvi-17
+	% cd xdvi-17
+	% gzip -dc $srcdir/xdvi-17.tar.gz | tar xf -
+	% gzip -dc $srcdir/xdvi-17jp.960209.gz | patch -p1
+
+  [2.3] 
+
+     Imakefile xmkmf  Makefile 
+    
+
+    [2.3.1] Imakefile 
+
+       Imakefile 
+       Imakefile
+      
+
+          
+          
+            xdvi PL17 
+           README 
+
+
+    * 
+
+        Use_Kanji, Use_ASCIIDNP, Use_ZEIT, Use_NTTZEIT
+
+         4  4 
+        
+
+        ----------------------------------------------------------------
+        1. NTT-JTeX  DVI  NTT-JTeX 
+            () 
+           ASCII TeX 
+
+           -->  #undef 
+        ----------------------------------------------------------------
+        2. NTT-JTeXASCII "" TeX pTeX  DVI 
+            NTT-JTeX  () 
+           
+
+           --> Use_KANJI  Use_ASCIIDNP  #define
+                #undef
+        ----------------------------------------------------------------
+        3. NTT-JTeX  DVI  NTT-JTeX 
+            () ASCII "" TeX  pTeX 
+            DVI  Zeit 
+           
+
+           --> Use_KANJI  Use_ZEIT  #define
+                #undef 
+        ----------------------------------------------------------------
+        4. NTT-JTeX, ASCII "" TeX,  pTeX  DVI 
+            Zeit 
+           
+
+           --> Use_KANJI, Use_ZEIT, Use_NTTZEIT  #define
+                #undef 
+        ----------------------------------------------------------------
+
+        Use_ASCIIDNP  Use_ZEIT 
+        Use_ASCIIDNP  
+        (2. )
+
+         2, 3, 4  ASCII pTeX 
+         DVI 
+        Use_PTEX  #define 
+         #undef 
+
+
+    * Use_MAKEPK
+
+        Use_MAKEPK  #define xdvi 
+         MakeTeXPK 
+
+        MakeTeXPK  MAKEPK_BINDIR 
+        makeTeXPK  
+        MAKEPK_DESTDIR 
+
+
+    * Use_SELFILE
+
+        Use_SELFILE  #define xdvi  DVI 
+        
+
+
+    * Use_PS, Use_PSCOLOR, GHOSTSCRIPT_BINDIR
+
+        Use_PS  #define  ghostscript  Postscript 
+        ghostscript 
+         GHOSTSCRIPT_BINDIR 
+        
+
+        Use_PSCOLOR  #define 
+        
+
+
+    * Use_COLOR
+
+        Use_COLOR  #define latex2e  graphics 
+        eclcolor.sty  color special  
+        ([3.4] ) 
+
+
+    * Use_VIKEY
+
+         vi 
+         #define 
+
+
+    * Use_SEARCH
+
+        dvi  #define 
+        
+
+
+    * Use_REMOTE
+
+        -remote  xdvi 
+         #define 
+
+
+    * 
+
+        xdvi  (GF, PK, PXL ) 
+        
+
+          DEFAULT_FONT_PATH=.:/usr/local/lib/tex/fonts/pk
+
+         DEFAULT_FONT_PATH 
+
+         
+        JFM  (ex. min10.tfm, goth9.tfm, etc) 
+        
+
+         TFM 
+        
+
+
+    * virtual font 
+
+        virtual font virtual font 
+
+          DEFAULT_VF_PATH=.:/usr/local/lib/tex/fonts/vf
+
+        DEFAULT_VF_PATH 
+
+
+    * DEFAULT_VFONTCAPDIR
+
+        VFlib 2.x 
+         vfontcap  DEFAULT_VFONTCAPDIR 
+        
+
+
+    * 
+
+        xdvi 
+
+          BDPI=300
+
+         BDPI  DPI 
+        
+
+
+    * 
+
+        300dpi 
+         xdvi 
+
+          DEFAULT_SHRINK=4
+
+         DEF_SHRINK 
+        
+
+           240DPI  DEFAULT_SHRINK=3
+                   300DPI  DEFAULT_SHRINK=4
+                   400DPI  DEFAULT_SHRINK=5
+
+        
+
+
+    * MSBITFIRST, BMLONG, BMSHORT
+
+        
+
+        MSBITFIRST  Intel 80x86  #define 
+        
+
+        BMLONG, BMSHORT 
+        
+
+
+    [2.3.2] Makefile 
+
+      Imakefile  Makefile 
+
+	  <  >
+
+	% xmkmf
+	% make includes
+	% make depend
+
+  [2.4] 
+
+    
+
+        <  >
+
+      % make
+
+
+  [2.5] 
+
+    , 
+    
+
+        <  >
+
+      % make install
+      % make install.man
+
+    ,  MakeTeXPK 
+
+        <  >
+
+      % make install.MakeTeXPK
+
+
+  [2.6] 
+
+    * 
+      
+      xmkmf  Makefile  "-DNARROWPROTO" 
+      
+      
+
+    * ghostscript 
+
+      ghostscript.c 
+
+      #define	USE_DUP2
+      #define	USE_FCLOSE
+
+       #undef 
+      
+
+
+  [2.7] xdvi-17+markpage+toc+printdvi+paper patch 
+
+     miyu-patch  xdvi PL17 
+     xdvi-17+markpage+toc+printdvi+paper patch 
+    
+
+    (
+    ) 
+    
+
+    xdvi-17+markpage+toc+printdvi+paper patch 
+     miyu-patch 
+    
+
+        <  >
+
+	% set srcdir=$pwd
+	% mkdir xdvi-17
+	% cd xdvi-17
+	% gzip -dc $srcdir/xdvi-17.tar.gz | tar xf -
+	% gzip -dc $srcdir/xdvi-17jp.960209.gz | patch -p1
+        % gzip -dc $srcdir/xdvi-pl17+markpage+toc+printdvi+paper.patch.gz | patch -p1
+
+
+    Imakefile, xdvi.c, util.c  3 
+     util.c 
+     Imakefile  xdvi.c Imakefile.rej,
+    xdvi.c.rej 
+    
+
+     xdvi-17+markpage+toc+printdvi+paper patch 
+    
+
+     xdvi-17+markpage+toc+printdvi+paper patch  markpage 
+     make less  ([3.8])
+    
+
+
+[3] 
+
+  [3.1] ASCII pTeX  DVI 
+
+        : 
+                  xdvi-17.miyu+ptex.patch       (1995/11; fj.comp.texhax)
+                  xdvi-17.miyu+ptex.patch.fixed (1995/11; fj.comp.texhax)
+
+    ASCII pTeX  DVI 
+    1995/11 pLaTeX 
+     version 
+    
+
+     Use_ASCIIDNP  () 
+    (?)
+
+     Use_PTEX  #define  DVI 
+    
+     tategaki.c 
+    
+    
+
+       struct TateCorrection TateCorrectionTable[] = {
+	       { TCOR_NOP, 0, 0 },
+	       { TCOR_AUTOSHIFT, 0, 0 },	/* 2122 '' */
+	       { TCOR_AUTOSHIFT, 0, 0 },	/* 2123 '' */
+	       { TCOR_SHIFT, 64, 96 },	/* 2124 '' */
+	       { TCOR_SHIFT, 64, 96 },	/* 2125 '' */
+	       { TCOR_SHIFT, 42, 42 },	/* 2126 '' */
+	       { TCOR_ROTATE, 0, 0 },	/* 2127 '' */
+			  :
+
+    ()
+    
+
+	TCOR_NOP            
+	TCOR_AUTOSHIFT      
+	TCOR_SHIFT          
+	TCOR_ROTATE         90
+	< (JIS)>  
+
+    2 3  TCOR_SHIFT 
+    2/3  x/y 
+    +/- 128 /
+
+     TCOR_AUTOSHIFT  TCOR_ROTATE 
+    
+
+  [3.2] ps 
+
+        : 
+                  (fj )
+
+     GHOSTVIEW_COLORS 
+    
+
+    xdvi PL20  -gspalette  palette 
+    
+
+        "Monochrome" 
+        "Greyscale"  
+        "Color" 
+
+     ()
+
+  [3.3] postscript special 
+
+        :  <uehara@yukawa.kyoto-u.ac.jp>
+                  (fj )
+
+                
+                  (fj )
+
+     epsfig.sty 
+    
+
+    eclepsf.sty dvips  ps special 
+     dvips 
+
+  [3.4] color special 
+
+        : 
+                  (fj )
+
+    dvips, dvi2ps  color special HSB 
+    
+
+     * HSL -> RGB HSB->RGB 
+       
+
+    dvips  named  X 
+    
+
+    Use_COLOR  make 
+     -usecolor   colorSpecial: True 
+    
+    
+
+  [3.5] DVI 
+
+        : 
+                  (fj )
+
+    '/' '?' 
+
+    
+    
+     [3.6]  -remote 
+    
+     .font 
+    
+
+     '\c'  'c' 
+     
+    hyphenation DVI 
+     '-' '--', '---' 
+    
+
+    DVI TeX 
+    
+    DVI 
+     TFM 
+     TeX 
+     TeX 
+     TFM 
+
+    TFM 
+    
+    ASCII 
+    
+
+      * 
+        
+        
+        
+
+  [3.6] -remote 
+
+        : 
+                  (fj )
+
+    Netscape  -remote  xdvi 
+
+      % xdvi -remote 'Command' foo.dvi
+
+     foo.dvi  xdvi 
+    dvi 
+     xdvi 
+
+    
+
+      OpenFile(foo.dvi)      foo.dvi 
+                             
+                             (Use_SELFILE )
+
+      Quit                   
+
+      Page(num)              num 
+
+      NextPage(num)          num 
+                             num  num = 1 
+
+      PrevPage(num)          num 
+
+      Search(String)          String  1 
+                             String 
+                             
+
+      SEARCH(String)          ()
+
+      SearchFwd(String)       String 
+                             
+
+      SEARCHFWD(String)       ()
+
+      SearchBwd(String)       String 
+                             
+
+      SEARCHBWD(String)       ()
+
+      SloppySearch(String)    String  1  
+                             () 
+
+      Raise                  xdvi  1 
+
+     () ()[]{}
+    
+     ESC 
+    
+
+     
+    -jcode Jcode JISEUCSJIS 
+    JIS 
+
+     xdvi 
+     raise  +noraise, -noraise 
+    AutoRaise raise 
+
+    * Emacs  TeX 
+       (ver.1.61) remote 
+      
+
+        ftp://ftp.ae.keio.ac.jp/pub/emacs-lisp/text/yatex
+
+      
+
+  [3.7] VFlib version 2.x 
+
+        : 
+                  (fj )
+
+     VFlib ver 2.x 
+     FontConf 
+    vfontcap miyu-patch  -fontconf 
+     .FontConf  -vfontcap.vfontcap 
+
+    VFlib ver 1.x Imakefile 
+
+      #define VFLIB_VERSION	2
+
+     2  1  make 
+    
+    
+
+     JFM  
+    segmentation fault 
+    
+
+  [3.8] less 
+
+        : 
+                  (fj )
+
+     m +  ' + 
+    
+
+  [3.9] tpic2.2 
+
+        :  <wasisaka@rouge.brl.ntt.jp>
+                  xdvi-16-tpic2.2      (1993/02; fj.sources.d,fj.comp.texhax)
+                  xdvi-16-tpic2.2-fix1 (1993/02; fj.sources.d,fj.comp.texhax)
+
+  [3.10] DVI 
+
+        :  <miyu@shiratori.riec.tohoku.ac.jp>
+                . <dai@is.s.u-tokyo.ac.jp>
+                  (fj )
+
+  [3.11] ASCII "" TeX 
+
+        :  <noro@iias.flab.fujitsu.co.jp>
+                  xdvi-16j.patch        (1992/09; fj.sources)
+
+  [3.12] Zeit 
+
+        :  <hayashi@dale.eng.shizuoka.ac.jp>
+                  xdvi-zeit             (1993/08; fj.sources)
+
+  [3.13] ghostscript  postscript 
+
+     miyu-patch 
+
+        
+          xdvi-14jgs.patch              (199?/??; ???)
+          xdvi-16jgs.patch-fix4         (1993/06; fj.sources)
+          xdvi-16jgs.patch-fix5         (1993/08; fj.sources.d)
+
+         <senda@kuis.kyoto-u.ac.jp>
+          xdvi-16jgs.patch              (1992/09; fj.sources.d)
+
+         <masutani@me.es.osaka-u.ac.jp>
+          xdvi-16jgs.patch-fix1         (1992/09; fj.sources.d)
+          xdvi-16jgs.patch-fix2         (1992/09; fj.sources.d)
+
+        
+          xdvi-16jgs.patch-fix3         (1992/09; fj.sources.d)
+
+    
+
+    
+    
+    
+    
+
+    
+    
+     xdvi PL20 
+    psgs.c  _setenv() 
+
+     -ps, +ps  psSpecial 
+    xdvi PL20 
+
+                   
+      -interpreter     interpreter     Ghostscript 
+      [-+]nogssafer    gsSafer         -dSAFER  gs 
+      -gspalette       palette         gs 
+
+  [3.14] dvips  epsf.sty 
+
+        : 
+                
+                  (fj )
+
+  [3.15] jdvi2kps  psfrag  ()
+
+        : 
+                  (fj )
+
+  [3.16] "PS Fig" 
+
+        : 
+                 <kaol@SCEI.sony.co.jp>
+
+  [3.17] 
+
+    xdvi PL17 
+
+      % xdvi foo
+
+    foo.dvi  foo 
+    foo DVI 
+    
+
+     xdvi  PL20  foo.dvi 
+    
+    
+
+
+[4] 
+
+  8. tpic2.2 SeeTeX/Xtex/DviPage2.c 
+   tpic.c 
+   Copyright Notice 
+  
+
+  9. DVI 
+  "XsraSelFile File Selection Dialog Package" 
+  Dir.c, Draw.c, Path.c, SelFile.c 
+   Copyright Notice 
+
+  13. ghostscript  postscript 
+  ghostscript.c  _setenv()  xdvi PL20  
+  psgs.c  Copyright Notice
+  
+
+  
+
+    
+    
+    
+
+   10,13,14,15,16 
+  
+  
+
+  
+  
+  
+
+    
+    
+
+  
+  13  ghostscript  [3.13] 
+  
+  
+
+-- END OF DOCUMENT --
--- texk/xdvik/READMEs/README.markpage+toc+printdvi.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.markpage+toc+printdvi
@@ -0,0 +1,200 @@
+
+        << xdvi-17+markpage+toc+printdvi patch  >>
+
+					1993/09/13
+					 
+					onono@fuka.info.waseda.ac.jp
+
+xdvi-17+markpage+toc+printdvi patch 
+  xdvi-17 + miyu-patch for xdvi PL17 
+   xdvi 
+
+  1) Use_MARKPAGE
+  GNU Emacs 
+  (`m',`a')/(`U',`A')
+  (`'',``')('"')
+  ('<','>')
+  2)  toc 
+
+  2) Use_TOC
+  
+  ()()(
+  )/
+  
+
+  3) Use_PRINTDVI
+  `o'  Print  Print-out 
+  (
+  )
+  
+
+
+	SunOS 4.1.3 / sun4c (SPARCstation)
+
+
+
+  , xdvi PL17  xdvi-17.tar.gz 
+   xdvi-17miyu.patch-beta4.gz (*1)
+   xdvi-17+markpage+toc+printdvi.patch 
+
+  , , , 
+  xdvi-17.tar.gz , , 
+  xdvi-17miyu.patch-beta4.gz 
+  , GNU  gzip  patch  (*2)
+   xdvi-17+markpage+toc+printdvi.patch 
+
+  ,  Imakefile , 
+  xmkmf  Makefile , make 
+
+  miyu-patch for xdvi PL17 README.miyu-patch 
+  
+
+  (*1) , 
+       ftp.tohoku.ac.jp[130.34.8.9]:~ftp/pub/tex/dviwares/xdvi/PL17 
+       anonymous ftp 
+  (*2) , 
+       ftp.waseda.ac.jp[133.9.1.32]:~ftp/pub/GNU/prep 
+       ftp.ecei.tohoku.ac.jp[130.34.222.67]:~ftp/pub/GNU/gzip 
+       ftp.ecei.tohoku.ac.jp[130.34.222.67]:~ftp/pub/GNU/patch 
+
+Use_MARKPAGE  Use_TOC 
+   1024DVI  
+  1024 
+  Imakefile  RINGSIZE  MAX_PAGE 
+
+Use_PRINTDVI 
+  Imakefile  Use_PRINTDVI 
+  %d print.h 
+   dvi2ps  dviselect 
+  
+   xdvi 
+  
+  xdvi dvi2ps, dvips, jdvi2kps,
+  dviselect 
+   Imakefile  xdvi 
+   lpr  -v PostScript 
+   -v 
+  
+   dvi2ps  lpr 
+  lpr  1Mbyte 
+  
+  dvi2ps (/tmp/%F:%c@%r.ps )
+   lpr -s  rm 
+  -s 
+   rm 
+   lpr 
+  1Mbyte 
+  xdvi 
+	% dvi2ps file.dvi > /tmp/file.ps
+	% lpr -s /tmp/file.ps
+	()
+	% rm /tmp/file.ps
+  :-)
+
+(%f )
+  print.h 
+  Imakefile  PRCMD??? 
+	PRCMDLST="(cd %d; dviselect -i %F -o /tmp/%F:%t@%r.dvi %A; dvi2ps /tmp/%F:%t@%r.dvi) | lpr -P%p -J'%F (Page %t)'; /bin/rm /tmp/%F:%t@%r.dvi"
+	/* all marked pages */
+  % DVI 
+  
+    PRCMDALL  DVI ()
+    PRCMDCUR  ()
+    PRCMDMRK  
+    PRCMDRGN  (
+              )
+    PRCMDLST  
+  Print-out 
+	All pages
+	Current page
+	Marked page
+	Region
+	All marked pages
+  
+  % 
+  
+    %f :  DVI ()
+    %F :  DVI (basename)
+    %d :  DVI 
+         ( %f = %d/%F )
+    %p : ( PRINTER 
+         Print-menu )
+    %r : xdvi  ID
+  (
+  1\count )
+    %c : 
+    %m : 
+    %s : (%c  %m )
+    %e : (%c  %m )
+    %l : ();  ',' 
+         
+    %L : ();  ' ' 
+         
+    %t : (); 
+         ',' 
+    %T : (); 
+         ' ' 
+    %k : %l  '=' 
+         (dviselect )
+    %K : %L  '=' 
+         (dviselect )
+    %a : %t  '=' 
+         (dviselect )
+    %A : %T  '=' 
+         (dviselect )
+   PRCMDLST /home/onono/doc/sample.dvi 
+  3,6,11,17Print-out 
+   all marked pages 
+  
+	(cd /home/onono/doc;
+	 dviselect -i sample.dvi -o /tmp/sample.dvi:3,6,11,17@3255.dvi
+		 =3 =6 =11 =17;
+	 dvi2ps /tmp/sample.dvi:3,6,11,17@3255.dvi)
+	| lpr -Plp -J'sample.dvi (Page 3.6.11.17)';
+	/bin/rm /tmp/sample.dvi:3,6,11,17@3255.dvi
+  xdvi  ID = 3255 = lp 
+
+
+  Use_MARKPAGE, Use_TOC, Use_PRINTDVI #define/#undef
+  ()
+	#undef	Use_MARKPAGE
+	#define	Use_TOC
+	#define	Use_PRINTDVI
+  toc ()
+  Print-out  All pages  current page 
+  
+
+
+  
+	markring.c
+	markring.h
+	markpage.c
+	markpage.h
+	toc.c
+	toc.h
+	print.c
+	print.h
+  
+	      MATSUURA Syun      syun@fuka.info.waseda.ac.jp
+	    HIRAHARA Atsushi   hirahara@fuka.info.waseda.ac.jp
+	    ONO Kouichi        onono@fuka.info.waseda.ac.jp
+  
+  
+
+
+
+1. , , 
+			-printer	*printer
+	XDVIPRALL	-prall		*print.all
+	XDVIPRCUR	-prcur		*print.currentPage
+	XDVIPRMKD	-prmarked	*print.markedPage
+	XDVIPRRGN	-prregion	*print.region
+	XDVIPRLST	-prlist		*print.list
+
+2.  toc 
+
+3. toc  \count0 ()
+
+4. 
+	5,8-12,27,29,35-36,41
+   
--- texk/xdvik/READMEs/README.markpage+toc+printdvi+paper.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.markpage+toc+printdvi+paper
@@ -0,0 +1,583 @@
+
+      << xdvi-17+markpage+toc+printdvi+paper patch >>
+
+					1995/10/07
+					 
+					onono@fuka.info.waseda.ac.jp
+
+xdvi-17+markpage+toc+printdvi+paper patch
+  xdvi-17 + miyu-patch(beta.pre7) for xdvi PL17
+  fj
+  
+
+
+  fj
+
+  (1) xdvi-17+markpage+toc+printdvi patch
+      (xdvi-pl17+markpage+toc+printdvi.patch.gz)
+      TOCDVI
+      : ,  ,  
+        From: onono@fuka.info.waseda.ac.jp (ONO Kouichi)
+        Newsgroups: fj.sources,fj.comp.texhax
+        Subject: xdvi-17+markring+toc+printdvi patch
+        Date: 13 Sep 1993 23:14:24 +0900
+        Message-ID: <ONONO.93Sep13231424@akira.fuka.info.waseda.ac.jp>
+
+  (2) xdvi-17+markring+toc+printdvi patch fix-1
+      (1)#1
+      : 
+        From: onono@fuka.info.waseda.ac.jp (ONO Kouichi)
+        Newsgroups: fj.comp.texhax,fj.sources.d
+        Subject: xdvi-17+markring+toc+printdvi patch fix-1
+        Date: 14 Sep 1993 22:26:07 +0900
+        Message-ID: <ONONO.93Sep14222607@fuhito.fuka.info.waseda.ac.jp>
+
+  (3) xdvi-17+markpage+toc+printdvi patch fix-2
+      (1)+(2)#2
+      : 
+        From: onono@fuka.info.waseda.ac.jp (ONO Kouichi)
+        Newsgroups: fj.comp.texhax,fj.sources
+        Subject: xdvi-17+markpage+toc+printdvi patch fix-2
+        Date: 17 Sep 1993 22:54:04 +0900
+        Message-ID: <ONONO.93Sep17XDVIpatch.fix-2@akira.fuka.info.waseda.ac.jp>
+
+  (4) tasai-ussy patch
+      (xdvi-17.tasai-ussy.patch)
+      (1)TOC
+      :(tasai)& (ussy)
+        Newsgroups: fj.comp.texhax,fj.sources.d
+        From: ussy@int.titech.ac.jp (Takuya Harakawa)
+        Subject: BugPatch for Xdvi-17.miyu.path(beta.7)
+        Message-ID: <USSY.93Nov12211358@ayame.int.titech.ac.jp>
+        Date: 12 Nov 1993 21:13:58 +0900
+
+  (5) tasai-ussy pagenumber patch
+      (xdvi-17.page.patch)
+      (1)+(4)TOC
+      
+      :(tasai)& (ussy)
+        Newsgroups: fj.sources.d
+        From: ussy@int.titech.ac.jp (Takuya Harakawa)
+        Subject: UnOfficial Patch for Xdvi-17.miyu.patch(beta.7)
+        Message-ID: <USSY.93Nov12231403@ayame.int.titech.ac.jp>
+        Date: 12 Nov 1993 23:14:03 +0900
+        (
+        )
+        Newsgroups: fj.sources.d
+        From: ussy@int.titech.ac.jp (Takuya Harakawa)
+        Subject: an unofficial patch for Xdvi-17.miyu.patch(beta.pre7)
+        Message-ID: <USSY.93Nov15175604@kisaragi.int.titech.ac.jp>
+        Date: 15 Nov 1993 17:56:04 +0900
+        ()
+        Newsgroups: fj.sources.d
+        From: ussy@int.titech.ac.jp (Takuya Harakawa)
+        Subject: Re: an unofficial patch for Xdvi-17.miyu.patch(beta.pre7)
+        Message-ID: <USSY.93Nov15202826@kisaragi.int.titech.ac.jp>
+        Date: 15 Nov 1993 20:28:26 +0900
+
+  (6) tasai-ussy pagenumber patch fix-1
+      (xdvi-17.pagenumber-fix.patch)
+      (1)(5)fixversion-up
+      :(tasai)& (ussy)
+        Newsgroups: fj.comp.texhax,fj.sources.d
+        From: ussy@int.titech.ac.jp (Takuya Harakawa)
+        Subject: Xdvi-17 pagenumber patch fix
+        Message-ID: <USSY.93Nov18065838@ayame.int.titech.ac.jp>
+        Date: 18 Nov 1993 06:58:38 +0900
+
+  fj
+
+  (7) 
+      10-13
+      : 
+
+  (8) 
+      -geometryTOCX11R4
+      : 
+
+  (9) DVI()
+      DVI()
+      : 
+
+ (10) 
+      
+      
+      : 
+
+ (11) 
+      Paper
+      : 
+
+
+  xdvi
+
+  1) Use_MARKPAGE
+  GNU Emacs
+  (`m',`a')/(`U',`A')
+  (`'',``')('"')
+  ('<','>')
+  2)TOC
+
+  2) Use_TOC / Use_PAGENUM
+  
+  ()()(
+  )/
+  &
+  tasai-ussy1
+  
+
+  3) Use_PRINTDVI
+  `o'PrintPrint-out
+  (
+  )
+  
+
+  4) Use_PAPER
+  `t'PaperSet Paper Type
+  
+  selFileDVI
+  
+  Print%Z(%z)
+  ()
+  
+
+
+	SunOS 4.1.3	SPARCstation	/usr/ucb/cc	X11R5
+
+
+  (*1)
+
+  (1) xdvi PL17
+      (xdvi-17.tar.gz)
+  (2) miyu-patch for xdvi PL17 (beta.pre7)
+      (xdvi-17miyu.patch-beta.pre7)
+  (3) markpage+toc+printdvi+paper patch ()
+      (xdvi-pl17+markpage+toc+printdvi+paper.patch.gz)
+
+  
+  xdvi-17.tar.gz
+  xdvi-17miyu.patch-beta.pre7.gzGNU
+  gzippatch(*2)
+  xdvi-17+markpage+toc+printdvi+paper.patch.gz
+
+    % gzip -d -c xdvi-17.tar.gz | tar xf -
+    % gzip -d -c xdvi-17miyu.patch-beta.pre7.gz | patch -p1
+    % gzip -d -c xdvi-pl17+markpage+toc+printdvi+paper.patch.gz | patch -p1
+
+  ImakefilexmkmfMakefile
+  make
+
+    % xmkmf -a
+    % make
+    % make xdvi.man
+    % make MakeTeXPK
+
+  make
+
+    % make install
+    % make install.man
+    % make install.MakeTeXPK
+
+  miyu-patch for xdvi PL17README.miyu-patch
+  tasai-ussyREADME.tasai-ussy
+  
+
+  (*1) (1)(2)
+       ftp://ftp.tohoku.ac.jp/pub/TeX/dviwares/xdvi/PL17
+       ftp://ftp.fuka.info.waseda.ac.jp/pub/xdvi/PL17
+       anonymous ftp
+       (3)
+       ftp://ftp.fuka.info.waseda.ac.jp/pub/xdvi/PL17
+       anonymous ftp
+
+  (*2) 
+       ftp://ftp.waseda.ac.jp/pub/GNU/prep
+       anonymous ftp
+
+Use_MARKPAGEUse_TOC
+  1024DVI 1024
+  
+  ImakefileRINGSIZEMAX_PAGE
+
+Use_PRINTDVI
+  ImakefileUse_PRINTDVI
+  %dprint.h
+  defaultdvi2ps-jdviselect
+  
+  xdvi
+  
+  xdvidvi2ps-j, dvips, jdvi2kps, dviselect
+  
+  Imakefilexdvi
+  defaultlpr-vPostScript
+  -v
+  defaultdvi2ps-j
+  lpr -s -r-r
+  dvi2ps-j(DVI(
+  ))lpr
+  
+  lpr1Mbyte
+  
+  DVI/
+  lpr -srm
+  -rrm
+  lpr
+  1Mbyte
+  xdvi
+	% dvi2ps file.dvi > /tmp/file.ps
+	% lpr -s /tmp/file.ps
+	()
+	% rm /tmp/file.ps
+  :-)
+
+(%f)
+  print.h
+  ImakefilePRCMD???
+	PRCMDLST="cd %d; dviselect -i %F -o %D/%F:%o@%r.dvi %G; %R %D/%F:%o@%r.dvi > %D/%F:%o@%r.ps; /bin/rm %D/%F:%o@%r.dvi; %P -J'%F (Page %o)' %D/%F:%o@%r.ps"
+	/* all marked pages */
+  %DVI
+  
+    PRCMDALL  DVI()
+    PRCMDCUR  ()
+    PRCMDMRK  
+    PRCMDRGN  (
+              )
+    PRCMDLST  
+  Print-out
+	All pages
+	Current page
+	Last marked page
+	Region
+	All marked pages
+  
+  %
+  
+    %% : '%'
+    %f : DVI()
+    %F : DVI(basename)
+    %d : DVI
+         (%f == %d/%F)
+    %D : (TMPDIR
+         TEMPDIR)
+    %p : (PRINTER
+         Print-menu)
+    %P : (PRINTCMD
+         
+         PRINTCMD("lpr -s -r -P%p"))
+    %z : -paper(; ex. "a4")
+         
+    %Z : -paperDVI
+         ()
+         (ex. "a4r" ---> "a4landscape" for dvi2ps-j)
+         
+    %r : xdviID
+    %R : DVI()(DVIFILTER
+         
+         DVIFILTERCMD)
+  (
+  1\count)
+    %c : 
+    %m : 
+    %s : (%c%m)
+    %e : (%c%m)
+    %l : (); ','
+         
+    %L : (); ' '
+         
+    %t : (); ','
+         
+    %T : (); ' '
+         
+    %o : (); 
+         '-'','
+         
+    %O : (); 
+         '-'' '
+         
+    %k : %l'='
+         (dviselect)
+    %K : %L'='
+         (dviselect)
+    %a : %t'='
+         (dviselect)
+    %A : %T'='
+         (dviselect)
+    %g : %o'='
+         (dviselect)
+    %G : %O'='
+         (dviselect)
+  PRCMDLST/home/onono/doc/sample.dvi
+  3,6,11,17Print-out
+  All marked pages
+	cd /home/onono/doc;
+	dviselect -i sample.dvi -o /tmp/sample.dvi:3,6,11,17@3255.dvi
+		=3 =6 =11 =17;
+	dvi2ps -o a4 /tmp/sample.dvi:3,6,11,17@3255.dvi > /tmp/sampe.dvi:3,6,11,17@3255.ps;
+	/bin/rm /tmp/sample.dvi:3,6,11,17@3255.dvi;
+	lpr -s -r -Plp -J'sampe.dvi (Page 3,6,11,17)' /tmp/sampe.dvi:3,6,11,17@3255.ps;
+  xdviID = 3255 = lp-paper
+  a4
+
+%z/%Z(xdvi -paper/dvi2ps -o/jdvi2kps -pa)
+  %z-paper/.paper
+  
+	dvi2ps -o %z
+  dvi2ps
+  xdvidefault(a4)B4dvi
+  -paper b4xdvi
+  
+
+  xdvi -paperdvi2ps -o, jdvi2kps -pa
+  
+
+        xdvi -paper  dvi2ps-j -o  jdvi2kps -pa
+      letter                              
+      legal                               
+      tabloid                             
+      us                                  
+      usr                                 
+      foolscap                            
+      a[1-2]                              
+      a[3-5]                              
+      a[6-7]                              
+      a4extra                             
+      b[1-3]                              
+      b[4-5]                              
+      b[6-7]                              
+      c[1-7]                              
+      [a-c][1-7]r                         
+
+  DVI()
+  
+  %Z%z
+  (DVI)
+  
+
+-->DVI()
+  xdvi-paperDVI
+  ()
+  dvi2ps-j, jdvi2kps, dvipsDVI
+  ()
+  
+  
+  
+
+  dvi2ps-j(xdvipaper.dvi2ps-j)
+  jdvi2kps(xdvipaper.jdvi2kps)dvips(xdvipaper.dvips)
+  
+
+  
+
+  '#'
+  whitespace()whitespace
+  
+
+  a. <>
+  b. <>  <DVI()>
+  c. =             <DVI()>
+
+  b<><>whitespace
+  c"="<>whitespace
+  <>whitespace
+  (<>)
+
+  <>xdvi
+  (ex. a4r)
+
+  
+
+  "="<>
+  <>(b, c)
+  <>(a)<>
+  ("=")
+  
+
+  
+  a4r(%Z)"a4 -l"
+
+    ### sample
+    a4			# A4 portrait
+    b4		b4	# B4 portrait
+    a4r		a4 -l	# A4 landscape
+    =		a4	# default is A4 portrait
+
+
+  %P%R
+  
+  
+  
+  
+  %P%RImakefile
+  %P%R
+  PRINTCMDDVIFILTER
+
+
+  
+  
+
+  (0) 
+      Print-out
+      
+	1. 
+	   (-printall, -printcurrent, -printmarked, -printregion, -printlist)
+	2. 
+	   (.printAll, .printCurrent, .printMarked, .printRegion, .printList)
+	3. default
+	   (PRCMDALL, PRCMDCUR, PRCMDMRK, PRCMDRGN, PRCMDLST)
+
+  (1) 
+      %p
+      
+	0. Print-out
+	1. -printer
+	2. .printer
+	3. PRINTER
+	4. default(DVIPRINTER)
+
+  (2) 
+      %D
+      
+      
+	1. TMPDIR
+	2. default(TEMPDIR)
+
+  (3) DVI()
+      %R
+     DVI()
+      
+	1. DVIFILTER
+	2. default(DVIFILTERCMD)
+
+  (4) 
+      %P
+      (DVI
+      )
+      
+	1. PRINTCMD
+	2. default(PRINTCMD)
+
+  (5) -->DVI()
+      %Z
+      DVI()xdvi
+      
+	1. XDVIFILTOPTTBL
+	2. default(FILTOPTTBLFILE)
+
+  jdvi2kps
+	DVIFILTER"jdvi2kps -p%Z"
+	XDVIFILTOPTTBL"/usr/local/lib/TeX/xdvipaper.jdvi2kps"
+  dvips
+	DVIFILTER"dvips -t%Z"
+	XDVIFILTOPTTBL"/usr/local/lib/TeX/xdvipaper.dvips"
+  
+
+
+  Use_MARKPAGE, Use_TOC(Use_PAGENUM), Use_PRINTDVI, Use_PAPER
+  #define/#undef()
+	#undef	Use_MARKPAGE
+	#define	Use_TOC
+	#define Use_PAGENUM
+	#define	Use_PRINTDVI
+	#define Use_PAPER
+  TOC()
+  Print-outAll pagesCurrent page
+  Use_TOCUse_PAGENUMREADME.tasai-ussy
+
+
+  
+	markring.c
+	markring.h
+	markpage.c
+	markpage.h
+	toc.c
+	toc.h
+	print.c
+	print.h
+	paper.c
+	paper.h
+  
+	      MATSUURA Syun      syun@fuka.info.waseda.ac.jp
+	    HIRAHARA Atsushi   hirahara@fuka.info.waseda.ac.jp
+	    ONO Kouichi        onono@fuka.info.waseda.ac.jp
+  
+  
+  &tasai-ussy
+  
+
+
+Revision 1			1993/09/13	fj.comp.texhax,fj.sources
+	markpage+toc+printdvi patch Revision 1
+fix-1				1993/09/14	fj.comp.texhax,fj.sources.d
+Message-ID: <ONONO.93Sep14222607@fuhito.fuka.info.waseda.ac.jp>
+(1)	DVI'F'File
+	selFileDVITOC
+	
+	[ : NEC   ]
+
+fix-2				1993/09/17	fj.comp.texhax,fj.sources
+Message-ID: <ONONO.93Sep17XDVIpatch.fix-2@akira.fuka.info.waseda.ac.jp>
+(1)	-expert
+	
+	[ :    ]
+(2)	Print-out popup
+	``Marked page''``All marked pages''
+	``Last marked page''
+	[ :    ]
+(3)	DVI()lpr
+	DVI()
+	lpr -s -r
+	[ :    ]
+(4)	ULTRIX V4.0strdup()xmalloc()StrDup()
+	
+	[ :    ]
+fix-3				1993/09/23
+(1)	
+		5,8-12,27,29,35-36,41
+	%o,%O,%g,%G
+fix-4				1993/10/02
+(1)	-geometryTOC(resize)
+	(miyu)
+	[ :    ]
+(2)	X11R4viewport widget0
+	(X11R4viewport widgetX11R5)
+	[/ :    ]
+(3)	font_open.c(orignal
+	xdvi)
+	[/ :    ]
+fix-5				1994/08/20
+(1)	-paper(ex. "a4")
+	%z,%Z
+fix-6				1995/01/28
+(1)	print.csystem()
+	execl()
+	[ :    ]
+Revision 2			1995/09/23
+	markpage+toc+printdvi patch Revision 2
+	Paper	markpage+toc+printdvi+paper
+	
+(1)	DVI()
+	%R
+	[ :    ]
+(2)	
+	%D
+(3)	-paper
+	DVI()
+	%Z
+(4)	-printer
+	.printer
+			
+	-printer	.printer	Printer
+(5)	
+	
+			
+	-printall	.printAll	PrintAll
+	-printcurrent	.printCurrent	PrintCurrent
+	-printmarked	.printMarked	PrintMarked
+	-printregion	.printRegion	PrintRegion
+	-printlist	.printList	PrintList
+(6)	%P
+	
+(7)	Paper't'
+	
+fix-1				1995/10/07
+(1)	redraw
--- texk/xdvik/READMEs/README.miyu-beta6.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.miyu-beta6
@@ -0,0 +1,239 @@
+
+                << miyu-patch for xdvi PL17  >>
+
+miyu-patch for xdvi PL17 : 
+   xdvi , xdvi PL17 
+  
+
+    1) tpic2.2 
+       xdvi-16-tpic2.2         (1993/02 @NTT; fj.sources.d,fj.comp.texhax)
+       xdvi-16-tpic2.2-fix1    (1993/02 @NTT; fj.sources.d,fj.comp.texhax)
+
+    2) DVI 
+       xdvi+selfile            (fj )
+
+    3) ASCII "" TeX 
+       xdvi-16j.patch          (1992/09 ; fj.sources)
+
+    4) Zeit 
+       xdvi-zeit               (1993/08 ; fj.sources)
+
+    5) ghostscript  ps 
+       xdvi-16jgs.patch        (1992/09 ; fj.sources.d)
+       xdvi-16jgs.patch-fix1   (1992/09 ; fj.sources.d)
+       xdvi-16jgs.patch-fix2   (1992/09 ; fj.sources.d)
+       xdvi-16jgs.patch-fix3   (1992/09 ; fj.sources.d)
+       xdvi-16jgs.patch-fix4   (1993/06 ; fj.sources)
+       xdvi-16jgs.patch-fix5   (1993/08 ; fj.sources.d)
+
+    6) dvips  epsf.sty 
+       ()              (fj )
+
+    7) jdvi2kps  psfrag  ()
+       ()              (fj )
+
+    8) "PS Fig" 
+       ()              (fj )
+
+   header 
+
+  , 
+  2) . <dai@is.s.u-tokyo.ac.jp> , 
+  6)  <uehara@yisun1.yukawa.kyoto-u.ac.jp> , 
+  8)  <kaol@is.crl.sony.co.jp> , 
+  
+
+  , . <dai@is.s.u-tokyo.ac.jp> , 
+  
+
+: 
+  1. 
+
+    , xdvi PL17  xdvi-17.tar.gz 
+     xdvi-17miyu.patch-beta6.gz  (*1)
+
+  2. 
+
+    , , , 
+    xdvi-17.tar.gz , , 
+    xdvi-17miyu.patch-beta6.gz 
+    , GNU  gzip  patch  (*2)
+
+        <  >
+
+      % set srcdir=$cwd
+      % mkdir xdvi-17
+      % cd xdvi-17
+      % gzip -d -c $srcdir/xdvi-17.tar.gz | tar xvf -
+      % gzip -d -c $srcdir/xdvi-17miyu.patch-beta6.gz | patch -p1
+
+  3. 
+
+     Imakefile , 
+    xmkmf  Makefile 
+
+  3.1 Imakefile 
+
+    ,  xdvi 
+    
+
+    ,  Use_MAKEPK, Use_SELFILE, 
+    Use_KANJI, Use_ASCIIDNP, Use_ZEIT, Use_NTTZEIT, Use_PS 
+    #define  #undef 
+    
+        Use_MAKEPK      MakeTeXPK , 
+
+        Use_SELFILE     
+
+        Use_KANJI       ASCII "" TeX  DVI 
+
+        Use_ASCIIDNP     
+                        ASCII "" TeX 
+
+        Use_ZEIT        ASCII "" TeX  DVI 
+                        Zeit 
+        Use_NTTZEIT     NTT-JTeX 
+
+        Use_PS          ghostscript  ps 
+
+    * , Use_KANJI, Use_ASCIIDNP, Use_ZEIT, Use_NTTZEIT 
+
+       TeX  NTT-JTeX  DVI 
+      PK , GF , PXL , 
+       #undef 
+
+      ASCII "" TeX  DVI  
+      NTT-JTeX  () 
+      , Use_KANJI  Use_ASCIIDNP  #define , 
+       #undef 
+
+      ASCII "" TeX  DVI  
+      Zeit , 
+      Use_KANJI  Use_ZEIT  #define , Use_ASCIIDNP  #undef 
+      , NTT-JTeX  DVI  
+      Zeit , 
+       Use_NTTZEIT  #define 
+      , NTT-JTeX  DVI  
+       () , 
+      Use_NTTZEIT  #undef 
+
+      ,  Use_ASCIIDNP  Use_ZEIT 
+      
+      , Use_ASCIIDNP 
+
+    * Use_MAKEPK, Use_SELFILE, Use_PS  
+      #define  #undef 
+
+    ,  
+    DEFAULT_FONT_PATH, DEFAULT_VF_PATH, DEFAULT_SUBDIR_PATH 
+
+        DEFAULT_FONT_PATH     
+                              , PK , GF ,
+                              PXL , 
+                              USE_ZEIT , , 
+                              ASCII "" TeX  tfm 
+                              
+
+        DEFAULT_VF_PATH       Virtual Font 
+
+        DEFAULT_SUBDIR_PATH   SEARCH_SUBDIRECTORIES 
+                              
+                              
+
+    , Use_MAKEPK  #define ,
+    MakeTeXPK  MAKEPK_BINDIR 
+    makeTeXPK  MAKEPK_DESTDIR 
+    
+
+    , Use_ZEIT  #define , 
+     FontConf 
+     DEFAULT_FONTCONFDIR 
+
+    , Use_PS  #define , 
+    ps  DEFAULT_PS_PATH  
+    ghostscript  GHOSTSCRIPT_BINDIR 
+    
+
+     DEFS 
+    , , DEFS  -DMSBITFIRST 
+     i[34]86 
+    , , DEFS  -DBLONG, -DBMSHORT 
+    -DBMLONG, -DBMSHORT , , 
+    
+    -DBMLONG  -DBMSHORT  -DBMLONG 
+    ,  -DBDPI= , 
+     -DDEFAULT_SHRINK= 
+    , 240DPI  -DBDPI=240, 300DPI  -DBDPI=300, 
+    400DPI  -DBDPI=400 
+    , , 
+     240DPI  -DDEFAULT_SHRINK=\"3\", 
+    300DPI  -DDEFAULT_SHRINK=\"4\", 
+    400DPI  -DDEFAULT_SHRINK=\"5\" 
+    , 
+    vi  -DVI_KEY 
+
+        <  >
+
+      % vi Imakefile
+      ()
+
+  3.2 Makefile 
+
+    Imakefile  Makefile 
+
+        <  >
+
+      % xmkmf
+      % make includes
+      % make depend
+
+  3.3 
+
+    , USE_ZEIT  Imakefile  #define ,
+    VFlib-1.32 , config.h  FontConf 
+     Doc,euc 
+
+        <  >
+
+      % cd VFlib-1.32
+      % vi config.h
+      ()
+      % vi FontConf
+      ()
+      % cd ..
+
+  4. 
+
+    
+
+        <  >
+
+      % make
+
+  5. 
+
+    , 
+    
+
+        <  >
+
+      % make install
+      % make install.man
+
+    ,  MakeTeXPK 
+
+        <  >
+
+      % make install.MakeTeXPK
+
+    *1 , 
+       ftp.tohoku.ac.jp[130.34.8.9]:~ftp/pub/tex/dviwares/xdvi/PL17 
+       anonymous ftp 
+
+    *2 , 
+       ftp.ecei.tohoku.ac.jp[130.34.222.67]:~ftp/pub/GNU/gzip 
+       ftp.ecei.tohoku.ac.jp[130.34.222.67]:~ftp/pub/GNU/patch 
+
+--
+1993 915()           <miyu@ftp.tohoku.ac.jp>
+
--- texk/xdvik/READMEs/README.ptex.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.ptex
@@ -0,0 +1,80 @@
+
+		  << xdvi-17+ptex patch  >>
+
+					1995/11/09
+					 
+					lh36112@hongo.ecc.u-tokyo.ac.jp
+					KHB11235@niftyserve.or.jp
+
+xdvi-17+ptex patch 
+  xdvi-17 + miyu-patch for xdvi PL17  ASCII pTeX  DVI 
+   xdvi 
+  
+
+
+	linux 1.3.24 + Slackware 2.2 + JE-0.9.6
+
+
+
+  , xdvi PL17  xdvi-17.tar.gz 
+   xdvi-17miyu.patch-beta7.pre.gz (*1) 
+  xdvi-17+ptex.patch  
+
+  , , , 
+  xdvi-17.tar.gz , , 
+  xdvi-17miyu.patch-beta7.pre.gz 
+  , GNU  gzip  patch  (*2)
+   xdvi-17+ptex.patch 
+
+  ,  Imakefile , 
+  xmkmf  Makefile , make 
+
+  miyu-patch for xdvi PL17 README.miyu-patch 
+  
+
+  (*1) , ftp://ftp.tohoku.ac.jp/pub/tex/dviwares/xdvi/PL17 
+        anonymous ftp 
+       xdvi-17miyu.patch-beta6.gz Linux-JE  xdvi  OK 
+       
+
+  xdvi-17+markpage+toc+printdvi[+paper] patch 
+   Imakefile 
+  Imakefile.rej 
+
+
+Use_PTEX 
+   define  pTeX 
+   Use_ASCIIDNP 
+  
+
+tategaki.c 
+  xdvi-17+ptex.patch 
+   tategaki.c 
+
+     struct TateCorrection TateCorrectionTable[] = {
+	     { TCOR_NOP, 0, 0 },
+	     { TCOR_SHIFT, 64, 96 },	/* 2122 '' */
+	     { TCOR_SHIFT, 64, 96 },	/* 2123 '' */
+	     { TCOR_SHIFT, 64, 96 },	/* 2124 '' */
+	     { TCOR_SHIFT, 64, 96 },	/* 2125 '' */
+	     { TCOR_SHIFT, 42, 42 },	/* 2126 '' */
+	     { TCOR_ROTATE, 0, 0 },	/* 2127 '' */
+			:
+
+  
+
+   TCOR_NOP TCOR_SHIFT 
+  TCOR_ROTATE 90
+  '0x2121'  JIS 
+  
+
+  23 xy +/- 128 
+  ()()
+
+  
+  
+
+
+  
+  
+
--- texk/xdvik/READMEs/README.tasai-ussy.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.tasai-ussy
@@ -0,0 +1,312 @@
+
+               ** pagenumber-patch for Xdvi PL17 + etc. **
+
+
+  xdvi-17.pagenumber.patch"xdvi-17+miyu-patch for xdvi PL17"
+"xdvi-17+markpage+toc+printdvi"
+
+/
+  /
+
+  1) PageTOC
+     xdvi-17+markpage+toc+printdvi 
+  (toc)toc
+  
+    
+
+  2) toc
+    'g'toc
+  :-)
+
+  3) 
+    'g'
+  'P''g'
+  
+
+
+  
+
+        1) xdvi-17.tar.gz
+        2) xdvi-17miyu.patch-beta6
+        3) xdvi-17miyu.beta6-beta.pre7(fj.sources.d)
+        4) xdvi-pl17+markpage+toc+printdvi(fj.sources,fj.comp.texhax)
+        5) fix-1(fj.sources.d,fj.comp.texhax)
+        6) fix-2(fj.sources,fj.comp.texhax)
+        7) xdvi-17.tasai-ussy.patch(fj.sources.d,fj.comp.texhax)
+           Message-ID: <USSY.93Nov12211358@ayame.int.titech.ac.jp>
+        8) xdvi-17.pagenumber.patch(fj.sources.d)
+           Message-ID: <USSY.93Nov15175604@kisaragi.int.titech.ac.jp>
+
+  ()
+    7)(expert)6)reject
+  8)
+
+  1) 2)8)
+        % patch -p2 < xdvi-17.pagenumber-fix.patch
+
+
+
+  Use_PAGENUM  Imakefile  define/undefine 
+/
+  xdvi-pl17+markpage+toc+printdvi Use_TOC  define 
+Use_TOC  Use_PAGENUM 
+
+
+
+
+Nov.12, 1993
+    Message-ID: <USSY.93Nov12231403@ayame.int.titech.ac.jp>
+    --
+    (T_T)
+    * toc
+
+Nov.15, 1993
+    Message-ID: <USSY.93Nov15175604@kisaragi.int.titech.ac.jp>
+    --
+    * Imakefile
+
+Nov.18, 1993
+    --
+    
+    * ()
+    * toc
+
+From ussy@int.titech.ac.jp Mon Dec 13 18:58:45 1993
+Newsgroups: fj.comp.texhax,fj.sources.d
+Path: hiromi.fuka.info.waseda.ac.jp!waseda-mail!wnoc-tyo-news!nirvana.cs.titech!cs.titech!is.titech!sys.titech.ac.jp!int.titech.ac.jp!ussy
+From: ussy@int.titech.ac.jp (Takuya Harakawa)
+Subject: BugPatch for Xdvi-17.miyu.path(beta.7)
+Content-Type: text/plain; charset=ISO-2022-JP
+Message-ID: <USSY.93Nov12211358@ayame.int.titech.ac.jp>
+Followup-To: fj.sources.d
+Sender: news@int.titech.ac.jp
+Organization: Tokyo Institute of Tech., Dept. of Intelligence Science, Japan
+Mime-Version: 1.0
+Distribution: fj
+Date: 12 Nov 1993 21:13:58 +0900
+Lines: 188
+Xref: hiromi.fuka.info.waseda.ac.jp fj.comp.texhax:3143 fj.sources.d:1547
+
+
+  
+  fj.comp.texhaxfj.sources.d
+
+  xdvi-17+miyu.patch(beta.7)+markpage+toc+printdvi 
+
+
+  ()
+
+ExpertMark/UnMark
+(tasai@int.titech.ac.jp: ASAI Toru)
+
+  List Widget
+
+
+
+/ 
+(ussy@int.titech.ac.jp: HARAKAWA Takuya)
+
+  Y15
+List Widget
+
+
+   shell archive 
+  xdvi-17+miyu.patch(beta.7)+markpage+toc+printdvi 
+
+             % patch -p2 < xdvi-17.tasai-ussy.patch
+
+
+From ussy@int.titech.ac.jp Mon Dec 13 18:58:50 1993
+Newsgroups: fj.sources.d,fj.comp.texhax
+Path: hiromi.fuka.info.waseda.ac.jp!waseda-mail!wnoc-tyo-news!cs.titech!is.titech!sys.titech.ac.jp!int.titech.ac.jp!ussy
+From: ussy@int.titech.ac.jp (Takuya Harakawa)
+Subject: Re: BugPatch for Xdvi-17.miyu.path(beta.7)
+In-Reply-To: ussy@int.titech.ac.jp's message of Fri, 12 Nov 1993 12:13:58 GMT
+Content-Type: text/plain; charset=ISO-2022-JP
+Message-ID: <USSY.93Nov15152917@kisaragi.int.titech.ac.jp>
+Followup-To: fj.sources.d
+Sender: news@int.titech.ac.jp
+Organization: Tokyo Institute of Tech., Dept. of Intelligence Science, Japan
+References: <USSY.93Nov12211358@ayame.int.titech.ac.jp>
+Mime-Version: 1.0
+Distribution: fj
+Date: 15 Nov 1993 15:29:16 +0900
+Lines: 26
+Xref: hiromi.fuka.info.waseda.ac.jp fj.sources.d:1548 fj.comp.texhax:3144
+
+
+  
+
+>  
+>  fj.comp.texhaxfj.sources.d
+>
+>  xdvi-17+miyu.patch(beta.7)+markpage+toc+printdvi 
+>
+
+  (^^;
+  ...
+
+        xdvi-17+miyu.patch(beta.7)+markpage+toc+printdvi
+
+
+
+        xdvi-17+miyu.patch(beta.pre7)+markpage+toc+printdvi
+                                ~~~
+
+  :-(
+  ...
+
+--
+USSY /         | Tokyo Institute of Tech.,
+Email: ussy@int.titech.ac.jp | Dept. of Intelligence Science, Japan
+       USSY@Pekin etc...     | Hara Lab.(R1-520) ext.2473 in Nagatsuta
+
+From ussy@int.titech.ac.jp Mon Dec 13 18:59:08 1993
+Newsgroups: fj.sources.d
+Path: hiromi.fuka.info.waseda.ac.jp!waseda-mail!wnoc-tyo-news!cs.titech!is.titech!sys.titech.ac.jp!int.titech.ac.jp!ussy
+From: ussy@int.titech.ac.jp (Takuya Harakawa)
+Subject: UnOfficial Patch for Xdvi-17.miyu.patch(beta.7)
+Content-Type: text/plain; charset=ISO-2022-JP
+Message-ID: <USSY.93Nov12231403@ayame.int.titech.ac.jp>
+Followup-To: fj.sources.d
+Sender: news@int.titech.ac.jp
+Organization: Tokyo Institute of Tech., Dept. of Intelligence Science, Japan
+Mime-Version: 1.0
+Distribution: fj
+Date: 12 Nov 1993 23:14:03 +0900
+Lines: 242
+
+
+  
+  xdvi-17+miyu.patch(beta.7)+markpage+toc+printdvi+tasai-ussy 
+
+
+  
+TOC
+
+  .dvi
+(
+)
+:-<
+
+[] 'g'
+
+   shell archive 
+  xdvi-17+miyu.patch(beta.7)+markpage+toc+printdvi+tasai-ussy 
+
+             % patch -p2 < xdvi-17.page.patch
+
+
+From ussy@int.titech.ac.jp Mon Dec 13 18:59:28 1993
+Newsgroups: fj.sources.d
+Path: hiromi.fuka.info.waseda.ac.jp!waseda-mail!wnoc-tyo-news!cs.titech!is.titech!sys.titech.ac.jp!int.titech.ac.jp!ussy
+From: ussy@int.titech.ac.jp (Takuya Harakawa)
+Subject: an unofficial patch for Xdvi-17.miyu.patch(beta.pre7)
+Content-Type: text/plain; charset=ISO-2022-JP
+Message-ID: <USSY.93Nov15175604@kisaragi.int.titech.ac.jp>
+Sender: news@int.titech.ac.jp
+Organization: Tokyo Institute of Tech., Dept. of Intelligence Science, Japan
+Mime-Version: 1.0
+Distribution: fj
+Date: 15 Nov 1993 17:56:04 +0900
+Lines: 251
+
+
+  
+
+   Xdvi-17 
+(^^;
+  
+ ( Imakefile ... Thanks to miura@cs.titech.ac.jp)
+
+---
+
+  
+TOC
+
+  .dvi
+(
+)
+:-<
+
+[] 'g'
+
+   shell archive 
+  xdvi-17+miyu.patch(beta.pre7)+markpage+toc+printdvi+tasai-ussy
+
+             % patch -p2 < xdvi-17.page.patch
+
+
+From ussy@int.titech.ac.jp Mon Dec 13 18:59:32 1993
+Newsgroups: fj.sources.d
+Path: hiromi.fuka.info.waseda.ac.jp!waseda-mail!wnoc-tyo-news!cs.titech!is.titech!sys.titech.ac.jp!int.titech.ac.jp!ussy
+From: ussy@int.titech.ac.jp (Takuya Harakawa)
+Subject: Re: an unofficial patch for Xdvi-17.miyu.patch(beta.pre7)
+In-Reply-To: ussy@int.titech.ac.jp's message of Mon, 15 Nov 1993 08:56:04 GMT
+Content-Type: text/plain; charset=ISO-2022-JP
+Message-ID: <USSY.93Nov15202826@kisaragi.int.titech.ac.jp>
+Lines: 31
+Sender: news@int.titech.ac.jp
+Fcc: |/usr/local/lib/mh/rcvstore +AuthorCopy
+Organization: Tokyo Institute of Tech., Dept. of Intelligence Science, Japan
+References: <USSY.93Nov15175604@kisaragi.int.titech.ac.jp>
+Mime-Version: 1.0
+Distribution: fj
+Date: 15 Nov 1993 20:28:26 +0900
+
+
+   
+
+>   Xdvi-17 
+>(^^;
+>  
+> ( Imakefile ... Thanks to miura@cs.titech.ac.jp)
+
+  
+
+
+   Imakefile  ...
+
+    #define Use_PAGENUM
+    PAGE_DEFS=-DPAGENUM
+    #else
+    ...
+
+
+
+    #ifdef Use_PAGENUM	         <-- 
+    PAGE_DEFS=-DPAGENUM
+    #else
+    ...
+
+( T_T)
+
+--
+USSY /         | Tokyo Institute of Tech.,
+Email: ussy@int.titech.ac.jp | Dept. of Intelligence Science, Japan
+       USSY@Pekin etc...     | Hara Lab.(R1-520) ext.2473 in Nagatsuta
+
+From ussy@int.titech.ac.jp Mon Dec 13 18:59:55 1993
+Newsgroups: fj.comp.texhax,fj.sources.d
+Path: hiromi.fuka.info.waseda.ac.jp!waseda-mail!wnoc-tyo-news!cs.titech!is.titech!sys.titech.ac.jp!int.titech.ac.jp!ussy
+From: ussy@int.titech.ac.jp (Takuya Harakawa)
+Subject: Xdvi-17 pagenumber patch fix
+Content-Type: text/plain; charset=ISO-2022-JP
+Message-ID: <USSY.93Nov18065838@ayame.int.titech.ac.jp>
+Followup-To: fj.sources.d
+Lines: 469
+Sender: news@int.titech.ac.jp
+Fcc: |/usr/local/lib/mh/rcvstore +AuthorCopy
+Organization: Tokyo Institute of Tech., Dept. of Intelligence Science, Japan
+Mime-Version: 1.0
+Distribution: fj
+Date: 18 Nov 1993 06:58:38 +0900
+Xref: hiromi.fuka.info.waseda.ac.jp fj.comp.texhax:3157 fj.sources.d:1556
+
+
+  
+
+  xdvi-17+miyu-patcj+markpage+toc+printdvi+tasai-ussy+pagenumber(^^;
+fix & version up
+
+   
--- texk/xdvik/READMEs/README.vf2ft.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.vf2ft
@@ -0,0 +1,100 @@
+ xdvik-22.40l-j1.09-vf2ft.patch 
+
+http://www.matsusaka-u.ac.jp/~okumura/texfaq/qa/6610.html 
+VFlibfreetype2xdvi
+configure
+
+
+	$ ./configure --with-vflib=vf2ft
+
+VFlib APIFreetype
+xdvi-jp
+
+VFlibfreetype2
+
+
+tarball
+memomemo1,2,3
+
+
+
+ xdvi-ft2.tar.gz 
+
+URL: http://www.matsusaka-u.ac.jp/~okumura/texfaq/qa/6610.html
+Title: xdvi using freetype
+: otofuji
+: 2002-02-15 22:57:22
+
+@.
+
+, xdvi
+VFlibFreetype
+
+ftp://ftp.cs.tohoku-gakuin.ac.jp/pub/TeX/TG-Local-TeX/xdvi-ft2.tar.gz
+
+. ...
+
+xdvittfotf
+.
+
+
+o XFree86Freetype, VFlibX Window
+  
+o FreetypeOpentype, Opentype
+  
+
+
+P.S. Ghostscript.
+
+
+
+ xdvi-ft2.tar.gzmemo
+
+xdvikFreetype. vf2ft-utils.c
+. VFlib.
+
+VFlib2, XFree86freetype
+, X window
+. freetypeOpentype, 
+.
+
+.
+
+1. texk/xdvik, vf2ft-utils.c,
+   cc -c -O2 -I/usr/X11/include/freetype2 vf2ft-utils.c
+   .
+
+2. configure , make texk/xdvikMakefile.
+  2.1. objects  vf2ft-utils.o .
+  2.2 -lVFlib  -lfreetype .
+
+3.  "make", "make install".
+   make VF.h . include 
+   , ()
+
+4. vfontmap.
+
+	min	ttf   or otf
+	goth	ttf or otf
+----
+Edition Record:  020215, 020220
+
+
+ vfontmap
+
+WinUNIXCygwin/XFree86
+/usr/local/share/texmf/xdvi/vfontmap 
+
+
+min	/cygdrive/c/WINDOWS/Fonts/msmincho.ttc
+goth	/cygdrive/c/WINDOWS/Fonts/msgothic.ttc
+
+
+ASCII pTeXdvi
+xdvi-jp
+
+
+tarballsuppl.tar
+get-mapping.c
+get-origfontfile.c
+( <taiji@aihara.co.jp>)
--- texk/xdvik/READMEs/README.xdvik-22.15-j1.04.patch.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik-22.15-j1.04.patch
@@ -0,0 +1,217 @@
+
+		<< xdvik-22.15-j1.04 patch  >>
+
+							2000718
+
+
+[1] xdvik-22.15-j1.04 patch 
+
+  xdvik-22.15 
+
+ CHANGES.xdvik-jp 
+
+
+[2] 
+
+  xdvik-22.15.tar.gz  xdvik-22.15-j1.04.patch.gz 
+
+
+	% gzip -dc xdvik-22.15.tar.gz | tar xf -
+	% cd xdvik-22.15
+	% gzip -dc ../xdvik-22.15-j1.04.patch.gz | patch -p1 -s
+	% ./configure
+	% make
+	# make install
+
+
+
+  kpathsea  xdvi 
+texk/xdvik  make install 
+
+   -g  make 
+configure 
+
+	% env CFLAGS="-O2" ./configure
+
+
+
+
+   configure 
+
+
+
+   --enable-a4			A4 ()
+   --disable-a4			US letter
+
+   xdvik  US letter 
+ A4 
+
+
+
+
+  --enable-static	kpathsea  ()
+  --enable-shared	kpathsea 
+
+
+
+
+   --with-vfontmap			()
+   --without-vfontmap			
+
+  vfontmap /usr/local/share/texmf/xdvi/vfontmap 
+ --enable-xdvietcdir --with-vfontmap
+
+()
+
+
+
+
+   --with-vflib		ASCII, NTT  VFlib ()
+   --with-vflib=nontt	ASCII  VFlib NTT  PK 
+   --without-vflib	ASCII, NTT  PK 
+
+  --without-vflib  --without-vfontmap 
+
+
+
+
+   --enable-vikey		vi  h,j,k,l  ()
+   --disable-vikey		xdvi  l,d,u,r 
+
+
+
+
+   --enable-smallpanel		 ()
+   --disable-smallpanel		xdvi 
+
+
+
+
+   --enable-zoombutton		 ()
+   --disable-zoombutton		xdvi 
+
+
+Shrink 
+
+   --enable-shrink=6		 Shrink 
+
+   10 
+
+
+
+ DPI 
+
+   --enable-bdpi=300		PK  DPI 
+
+   600dpi 
+
+
+xdvi 
+
+   --enable-xdviprint	 DVISEL  ()
+   --disable-xdviprint	 PRINTDVI 
+
+  DVISEL  PRINTDVI 
+
+  DVISEL
+      xdvi  DVI 
+      () DVI 
+       dvips/dvi2ps/jdvi2kps 
+      READMEs/README.xdvi20c-j1.0+hal2+dvisel 
+      
+
+  PRINTDVI
+      xdvi (%P %R )
+      ( dviselect)
+      
+      
+      READMEs/README.markpage+toc+printdvi+paper 
+      
+
+  DVISEL 
+
+   --enable-xdviprint=/usr/libexec/xdviprint
+
+ /usr/local/bin/xdviprint 
+()
+
+  PRINTDVI  texk/xdvik/xdvi-config.h 
+PRCMDALL, PRCMDCUR, PRCMDMRK, PRCMDRGN, PRCMDLST, TEMPDIR, DVIFILTERCMD,
+FILTOPTTBLFILE configure
+
+
+
+ DVIPS 
+
+   --with-dvifilter=dvips	dvips ()
+   --with-dvifilter=dvi2ps	dvi2ps
+   --with-dvifilter=jdvi2kps	jdvi2kps
+   --without-dvifilter		xdvi 
+
+   DVISEL  PRINTDVI 
+
+
+  DVISEL 
+ --enable-xdviprint
+DVISEL 
+xdvi 
+
+
+  PRINTDVI  xdvi xdvi 
+(
+)
+
+  --without-dvifilter DVISEL  PRINTDVI 
+
+
+
+
+
+   --enable-xdvietcdir=/etc/tex		
+
+  vfontmap  xdvipaper.dvips 
+ /usr/local/share/texmf/xdvi 
+
+
+
+
+
+  texk/xdvik/  Makefile  xdvi-config.h
+
+
+   TeX 2.99 (ASCII jtex-1.7 )  kpathsea
+ TeX 3.x (ASCII pTeX 2.x )
+ kpathsea 
+:-)
+   texk/kpathsea/texmf.in  PKFONTS  TFMFONTS 
+
+
+PKFONTS = .;/usr/local/lib/fonts/pk600;/usr/local/lib/fonts/pk300
+
+ configure static  make OK
+kpathsea 
+()
+mf --without-mktexpk-default  --without-mktexmf-default
+
+
+
+[3] 
+
+  
+ READMEs/ 
+
+
+   
+(READMEs/ )
+
+
+	xdvi-jp  <xdvi-jp@bi.appi.keio.ac.jp>
+
+
+
+
+  ML  subscribe guide 
+ <xdvi-jp-ctl@bi.appi.keio.ac.jp> 
+ xdvi-jp  xdvi-jp-ctl 
+
+/* xdvi-jp  <xdvi-jp@bi.appi.keio.ac.jp> */
--- texk/xdvik/READMEs/README.xdvik-22.40b-j1.05.patch.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik-22.40b-j1.05.patch
@@ -0,0 +1,220 @@
+
+		<< xdvik-22.40b-j1.05 patch  >>
+
+							2001708
+
+
+[1] xdvik-22.40b-j1.05 patch 
+
+  xdvik-22.40b 
+
+ CHANGES.xdvik-jp 
+
+
+[2] 
+
+  xdvik-22.40b.tar.gz  xdvik-22.40b-j1.05.patch.gz 
+
+
+	% gzip -dc xdvik-22.40b.tar.gz | tar xf -
+	% cd xdvik-22.40b
+	% gzip -dc ../xdvik-22.40b-j1.04.patch.gz | patch -p1 -s
+	% ./configure
+	% make
+	# make install
+
+
+
+  kpathsea  xdvi 
+texk/xdvik  make install 
+
+   -g  make 
+configure 
+
+	% env CFLAGS="-O2" ./configure
+
+
+
+
+   configure 
+
+
+
+   --enable-a4			A4 ()
+   --disable-a4			US letter
+
+   xdvik  US letter 
+ A4 
+
+
+
+
+  --enable-static	kpathsea  ()
+  --enable-shared	kpathsea 
+
+
+
+
+   --with-vfontmap			()
+   --without-vfontmap			
+
+  vfontmap /usr/local/share/texmf/xdvi/vfontmap 
+ --enable-xdvietcdir --with-vfontmap
+
+()
+
+
+
+
+   --with-vflib		ASCII, NTT  VFlib ()
+   --with-vflib=nontt	ASCII  VFlib NTT  PK 
+   --without-vflib	ASCII, NTT  PK 
+
+  --without-vflib  --without-vfontmap 
+
+
+
+
+   --enable-vikey		vi  h,j,k,l  ()
+   --disable-vikey		xdvi  l,d,u,r 
+
+
+
+
+   --enable-smallpanel		 ()
+				 +smallpanel 
+				
+   --disable-smallpanel		xdvi 
+				 -smallpanel 
+
+
+
+
+   --enable-zoombutton		 ()
+   --disable-zoombutton		xdvi 
+
+
+Shrink 
+
+   --enable-shrink=6		 Shrink 
+
+   10 
+
+
+
+ DPI 
+
+   --enable-bdpi=300		PK  DPI 
+
+   600dpi 
+
+
+xdvi 
+
+   --enable-xdviprint	 DVISEL  ()
+   --disable-xdviprint	 PRINTDVI 
+
+  DVISEL  PRINTDVI 
+
+  DVISEL
+      xdvi  DVI 
+      () DVI 
+       dvips/dvi2ps/jdvi2kps 
+      READMEs/README.xdvi20c-j1.0+hal2+dvisel 
+      
+
+  PRINTDVI
+      xdvi (%P %R )
+      ( dviselect)
+      
+      
+      READMEs/README.markpage+toc+printdvi+paper 
+      
+
+  DVISEL 
+
+   --enable-xdviprint=/usr/libexec/xdviprint
+
+ /usr/local/bin/xdviprint 
+()
+
+  PRINTDVI  texk/xdvik/xdvi-config.h 
+PRCMDALL, PRCMDCUR, PRCMDMRK, PRCMDRGN, PRCMDLST, TEMPDIR, DVIFILTERCMD,
+FILTOPTTBLFILE configure
+
+
+
+ DVIPS 
+
+   --with-dvifilter=dvips	dvips ()
+   --with-dvifilter=dvi2ps	dvi2ps
+   --with-dvifilter=jdvi2kps	jdvi2kps
+   --without-dvifilter		xdvi 
+
+   DVISEL  PRINTDVI 
+
+
+  DVISEL 
+ --enable-xdviprint
+DVISEL 
+xdvi 
+
+
+  PRINTDVI  xdvi xdvi 
+(
+)
+
+  --without-dvifilter DVISEL  PRINTDVI 
+
+
+
+
+
+   --enable-xdvietcdir=/etc/tex		
+
+  vfontmap  xdvipaper.dvips 
+ /usr/local/share/texmf/xdvi 
+
+
+
+
+
+  texk/xdvik/  Makefile  xdvi-config.h
+
+
+   TeX 2.99 (ASCII jtex-1.7 )  kpathsea
+ TeX 3.x (ASCII pTeX 2.x )
+ kpathsea 
+:-)
+   texk/kpathsea/texmf.in  PKFONTS  TFMFONTS 
+
+
+PKFONTS = .;/usr/local/lib/fonts/pk600;/usr/local/lib/fonts/pk300
+
+ configure static  make OK
+kpathsea 
+()
+mf --without-mktexpk-default  --without-mktexmf-default
+
+
+
+[3] 
+
+  
+ READMEs/ 
+
+
+   
+(READMEs/ )
+
+
+	xdvi-jp  <xdvi-jp@bi.appi.keio.ac.jp>
+
+
+
+
+  ML  subscribe guide 
+ <xdvi-jp-ctl@bi.appi.keio.ac.jp> 
+ xdvi-jp  xdvi-jp-ctl 
+
+/* xdvi-jp  <xdvi-jp@bi.appi.keio.ac.jp> */
--- texk/xdvik/READMEs/README.xdvik-22.40y1-j1.21.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik-22.40y1-j1.21
@@ -0,0 +1,239 @@
+
+		<< xdvik-22.40y1-j1.21 patch  >>
+
+							2004225
+
+
+[1] xdvik-22.40y1-j1.21 patch 
+
+  xdvik-22.40y1 
+
+ CHANGES.xdvik-jp.html 
+
+
+[2] 
+
+  xdvik-22.40y1.tar.gz  xdvik-22.40y1-j1.21.patch.gz 
+
+
+	% gzip -dc xdvik-22.40y1.tar.gz | tar xf -
+	% cd xdvik-22.40y1
+	% gzip -dc ../xdvik-22.40y1-j1.21.patch.gz | patch -p1 -s
+	% ./configure
+	% make
+	% cd texk/xdvik  
+	% su
+	# make install
+
+
+
+  texk/xdvik  make install kpathsea 
+texmf/web2c/texmf.cnf 
+ ptex texmf.cnf 
+
+
+   -g  make 
+configure 
+
+	% env CFLAGS="-O2" ./configure
+
+
+
+	# strip /usr/local/bin/xdvi.bin
+
+
+
+
+   configure 
+
+
+
+   --enable-a4			A4 ()
+   --disable-a4			US letter
+
+   xdvik  US letter 
+ A4 
+
+
+
+
+  --enable-static	kpathsea  ()
+  --enable-shared	kpathsea 
+
+
+
+
+   --with-vfontmap			()
+   --without-vfontmap			
+
+  vfontmap /usr/local/share/texmf/xdvi/vfontmap 
+ --enable-xdvietcdir --with-vfontmap
+
+() vfontmap 
+
+"tfm name" "/etc/vfontcap entry" "{,tate}"
+
+
+
+"/font/file/name"
+   "tfm name1" "{,unicode,adobejapan,cidv}"
+   "tfm name2" "{,unicode,adobejapan,cidv}"
+
+
+tfm  tfm 
+
+
+
+
+   --with-vflib=yes	ASCII, NTT  VFlib ()
+   --with-vflib=vf2ft	ASCII, NTT  FreeType 
+   --with-vflib=nontt	ASCII  VFlib NTT  PK 
+   --without-vflib	ASCII, NTT  PK 
+
+  --without-vflib  --without-vfontmap 
+
+
+
+   --enable-vikey		vi  h,j,k,l  ()
+   --disable-vikey		xdvi  l,d,u,r 
+
+
+
+
+   --enable-smallpanel		 ()
+				 +smallpanel 
+				
+   --disable-smallpanel		xdvi 
+				 -smallpanel 
+
+
+
+
+   --enable-zoombutton		 ()
+   --disable-zoombutton		xdvi 
+
+
+Shrink 
+
+   --enable-shrink=6		 Shrink 
+
+   10 
+
+
+
+ DPI 
+
+   --enable-bdpi=300		PK  DPI 
+
+   600dpi 
+
+
+xdvi 
+
+   --enable-xdviprint	 DVISEL  ()
+   --disable-xdviprint	 PRINTDVI 
+
+  DVISEL  PRINTDVI 
+
+  DVISEL
+      xdvi  DVI 
+      () DVI 
+       dvips/dvi2ps/jdvi2kps 
+      READMEs/README.xdvi20c-j1.0+hal2+dvisel 
+      
+
+  PRINTDVI
+      xdvi (%P %R )
+      ( dviselect)
+      
+      
+      READMEs/README.markpage+toc+printdvi+paper 
+      
+
+  DVISEL 
+
+   --enable-xdviprint=/usr/libexec/xdviprint
+
+ /usr/local/bin/xdviprint 
+()
+
+  PRINTDVI  texk/xdvik/xdvi-config.h 
+PRCMDALL, PRCMDCUR, PRCMDMRK, PRCMDRGN, PRCMDLST, TEMPDIR, DVIFILTERCMD,
+FILTOPTTBLFILE configure
+
+
+
+ DVIPS 
+
+   --with-dvifilter=dvips	dvips ()
+   --with-dvifilter=dvi2ps	dvi2ps
+   --with-dvifilter=jdvi2kps	jdvi2kps
+   --without-dvifilter		xdvi 
+
+   DVISEL  PRINTDVI 
+
+
+  DVISEL 
+ --enable-xdviprint
+DVISEL 
+xdvi 
+
+
+  PRINTDVI  xdvi xdvi 
+(
+)
+
+  --without-dvifilter DVISEL  PRINTDVI 
+
+
+
+
+
+   --enable-xdvietcdir=/etc/tex		
+
+  vfontmap  xdvipaper.dvips 
+ /usr/local/share/texmf/xdvi 
+
+
+
+
+
+  texk/xdvik/  Makefile  xdvi-config.h
+
+
+   TeX 2.99 (ASCII jtex-1.7 )  kpathsea
+ TeX 3.x (ASCII pTeX 2.x )
+ kpathsea 
+:-)
+   texk/kpathsea/texmf.in  PKFONTS  TFMFONTS 
+
+
+PKFONTS = .;/usr/local/lib/fonts/pk600;/usr/local/lib/fonts/pk300
+
+ configure static  make OK
+kpathsea 
+()
+mf --without-mktexpk-default  --without-mktexmf-default
+
+
+
+[3] 
+
+  
+ READMEs/ 
+
+
+   
+(READMEs/ )
+
+
+	xdvi-jp  <xdvi-jp@bi.appi.keio.ac.jp>
+
+
+
+
+  ML  subscribe guide 
+ <xdvi-jp-ctl@bi.appi.keio.ac.jp> 
+ xdvi-jp  xdvi-jp-ctl 
+
+/* xdvi-jp  <xdvi-jp@bi.appi.keio.ac.jp> */
--- texk/xdvik/READMEs/README.xdvik18f-j1.0.patch.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik18f-j1.0.patch
@@ -0,0 +1,103 @@
+*
+   (xdvik18f-j1.0.patch)  xdvik18f 
+()xdvi PL18 
+
+version 1.0 
+
+
+*
+   VFlib 2.*  VFlib.a 
+
+
+
+*
+   xdvik18f 
+
+    % patch < xdvik18f-j1.0.patch
+
+
+
+
+*
+   OSF/1 
+-DOSF1 
+
+
+*
+   xdefs.make (printdvi  config.h) 
+
+  -DNOZEIT       ASCIITeX/NTT JTeX  dnp () 
+  -DNONTTZEIT    NTT JTeX  dnp () 
+  -DNOTOC        TOC 
+  -DNOMARKPAGE   MARKPAGE 
+  -DNOPRINTDVI   PRINTDVI 
+  -DVI_KEY        vi 
+  -DSMALL_PANEL  
+   VFlib  markpage,
+toc, printdvi 
+  markpage, toc, printdvi 
+(README.markpage+toc+printdvi)
+
+
+*
+   DEC OSF/1 V3.0B + gcc 2.6.3  GNU malloc 
+ xdvi 
+    (ASCII/NTT)VFlib dnp () 
+    toc, vi_key, printdvi, small_panel ()
+    eclepsf.sty, epsbox.sty  EPS 
+
+
+*
+  
+    1. -DNOTEXXET 
+    2. configure script (OS 
+       )
+    3. \special{header=...} 
+    4. ASCIITeX  dnp () 
+        MakeTeXPK 
+    5. 
+
+
+
+*
+   xdvi PL18 
+    @ xdvi18.vflib.patch
+    @ xdvipl18_epsbox+elepsf+selfile+vikey.patch 
+       selfile 
+    @ markpage, toc, printdvi, small_panel
+      
+    Patrice Belleville@Simon Fraser Univ.  \special{header=...}
+       patch
+
+
+   HEADERS.DOC 
+
+
+*xdvi PL18 
+    1. font-open.c  jfm  open 
+    2. special.c  psh_header  kpathsea 
+       
+    3. OSF/1 
+    4. 600 dpi  shrink  7 
+    5. 
+
+
+*
+  
+    1. 
+       
+       
+    2.  xdvi PL18 
+       
+  
+(
+)
+
+
+*
+   @
+
+
+ 
+
+nakayama@monet.phys.s.u-tokyo.ac.jp
--- texk/xdvik/READMEs/README.xdvik18f-j1.1p5.patch.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik18f-j1.1p5.patch
@@ -0,0 +1,322 @@
+*xdvik18f-j1.1p5.patch 
+
+					 
+					 (yamaga@ipc.chiba-u.ac.jp)
+
+
+   xdvi (xdvik-18f)  (ASCII-pTeX  NTT-JTeX) 
+
+
+ (:)  xdvik18f-j1.0 
+
+
+         1.   xdvi-17  markpage+toc+printdvi 
+             markpage+toc+printdvi+paper 
+            
+
+         2.  xdvi-17  pTeX 
+            ( )
+
+         3. 
+ 
+         4. 
+
+ READMEs/README.xdvik18f-j1.0.patch 
+
+
+
+
+[1] 
+
+ (1) 
+
+     % gunzip -c xdvik-18f.tar.gz | tar xvf -
+
+ (2) 
+
+     % cd xdvik-18f/xdvik
+     % patch -p < (somewhere)/xdvik18f-j1.1p5.patch
+
+ (3) xdefs.make 
+
+     % vi xdefs.make  mule xdefs.make
+
+      FILTOPTTBLDIR FILTOPTTBLDIR
+      xdvi  dvi --> ps 
+      xdvipaper.* 
+     
+
+      dvi --> ps  default  dvi2ps-j 
+      xdefs.make  FILTOPTTBLFILE  config.h  DVIFILTERCMD 
+      default 
+      config.h  DVIPRINTER  PRINTCMD 
+     
+
+      markpage+toc+printdvi+paper  
+     READMEs/README.markpage+toc+printdvi+paper 
+
+     
+    
+ (3-1) VFlib 
+
+     xdefs.make  DEFAULT_FONTMAP 
+
+  *********************************************************************
+  *  DEFAULT_FONTMAP  VFlib   *
+  *                 *
+  *                                                                   *
+  *          vfontmap  VFlib  vfontcap          *
+  *                                                                   *
+  *   [2]                                   *
+  *********************************************************************
+
+     
+      XDEFS  -DNOVFONTMAP 
+
+ (3-2) VFlib  pk 
+
+     xdefs.make  XDEFS -DNOZEIT VFLIB 
+      vfontmap 
+     
+
+ (3-3) NTT-JTeX  pk 
+
+     xdefs.make  XDEFS  -DNONTTZEIT 
+     ASCII-pTeX  NTT-JTeX 
+     
+
+
+ (4)  configure --> make
+
+     % cd ..
+     % ./configure
+     % make
+
+ (5) 
+
+     % su
+
+     # make install
+   
+    ()  TeX (3.1415)
+          xdvik  make install 
+
+
+
+[2] 
+
+   (default  /usr/local/lib/texmf/xdvi/vfontmap) 
+
+
+	mgoth	maru
+	fmin	fmin
+	fgoth	goth
+
+ "dvi "
+ "VFlib  vfontcap " 
+ xdvi 
+
+
+
+default 
+
+	min	min	# for ASCII
+	nmin	min	# for ASCII
+	goth	goth	# for ASCII
+	ngoth	goth	# for ASCII
+	dm	min	# for NTT
+	dg	goth	# for NTT
+
+
+
+ # 
+ VFONTMAP  
+
+	-vfontmap []
+
+ X  resource
+
+	xdvi*vfontmap:	[]
+
+
+
+	1. 
+	2. X  resource (xdvi*vfontmap)
+	3.  VFONTMAP
+
+
+
+   vfontmap  NTT-JTeX   
+  xdvik18f-j1.0+vfontmap-ntt.patch 
+
+
+# NTT-JTeX 
+#  Web page
+#
+# 	http://www.cim.pe.u-tokyo.ac.jp/~kawachi/software/xdvik18f.html
+#
+# 
+#
+#  ASCII-pTeX  VFlib  jTeX/README.euc 
+#  doc/QA.txt 
+
+
+
+[3] 
+
+   xdvik18f-j1.0.patch 
+
+
+
+          miyu patch 
+                  <miyu@akiu.gw.tohoku.ac.jp>
+                 
+
+                 ( READMEs/README.jp-patch
+                  )
+
+          pTeX 
+                  <lh36112@hongo.ecc.u-tokyo.ac.jp>
+                 (xdvi-17jp.960209 )
+
+          markpage+toc+printdvi+paper  
+                  <syun@fuka.info.waseda.ac.jp>
+                  <hirahara@fuka.info.waseda.ac.jp>
+                  <onono@fuka.info.waseda.ac.jp>
+                 
+
+                 (
+                  READMEs/README.markpage+toc+printdvi+paper
+                  )
+
+   vfontmap  (vfontmap.c) 
+(yamaga@ipc.chiba-u.ac.jp)
+
+
+
+   , 
+
+
+
+
+
+[4] 
+
+ (1) default  Shrink factor  4 (xdvi.c)
+
+ (2) -help (xdvi.c)
+
+ (3) xdvi.1  mksedscript  xdvi.man 
+	( config.h )
+
+ (4) Shrink  core dump (zeit.c)
+
+      Hayakawa Koichi     
+
+ (5) FreeBSD 
+
+       fj.comp.texhax  patches.tgz
+        (HITOSHI.96Apr30100219@mail01.tuat.ac.jp)
+        freebsd.patch 
+
+ (6) \"  Shrink  NTT-JTeX 
+      Shrink (dvi_init.c)
+
+      NTT HI  
+
+ (7)  FreeBSD  Segmentation Fault  (vfontmap.c)
+
+        
+
+ (8) ASCII pTeX  (jfm)  virtual font 
+      (font-open.c)  Linux 
+
+        
+
+ (9) FreeBSD, Linux  selfile 
+      (sfinternal.h)
+
+        
+
+(10) SMALL_PANEL 
+      (toc.c)
+
+        
+
+(11) pstricks  PS 
+     (special.c)
+
+        
+
+(12) SunOS4.1.3_U1  cc 
+     (dvi_init.c, special.c, xdvi.h)
+
+        
+
+(13)  vfontmap
+      (dvi_init.c)
+
+        
+
+        fj.comp.texhax
+              <G540001.97Feb24012306@ecc-as52.komaba.ecc.u-tokyo.ac.jp>
+
+(14)  (dvi_draw.c, dvi_init.c, xdvi.h)
+
+         xdvi-17   
+         xdvik-18f 
+
+        fj.comp.texhax
+              <no7pvxq2pg9.fsf@ecc-as01.hongo.ecc.u-tokyo.ac.jp>
+              <G540001.97Feb25061004@ecc-as51.komaba.ecc.u-tokyo.ac.jp>
+              <G540001.97Feb25174119@ecc-as52.komaba.ecc.u-tokyo.ac.jp>
+
+	<http://www.komaba.ecc.u-tokyo.ac.jp/~g540001/pub/unix/
+                                            xdvik18f-j1.1p1-vfix.patch>
+
+(15) -DNOZEIT, -DNONTTZEIT, -DNOPRINTDVI 
+     (font-open.c, xdvi.c, dvi_init.c, vfontmap.c, print.c)
+
+(16) ASCIIDNP  pTeX  (dvi_init.c, pk.c)
+
+(17) ASCIIDNP  pTeX  min8  core dump 
+     
+     (dvi_init.c, tategaki.c)
+
+        
+
+
+
+[5] 
+
+   
+(READMEs )
+
+(yamaga@ipc.chiba-u.ac.jp)
+
+
+
+
+
+[6] 
+
+  
+
+
+
+        
+        
+        
+        
+          
+        
+          
+
+      ()
+
+
+
+		yamaga@ipc.chiba-u.ac.jp
+
+
+						
--- texk/xdvik/READMEs/README.xdvik20a-j1.1.patch.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik20a-j1.1.patch
@@ -0,0 +1,273 @@
+*xdvik20a-j1.1.patch 
+
+					 
+					 (yamaga@ipc.chiba-u.ac.jp)
+
+
+   xdvi (xdvik-20a)  (ASCII-pTeX  NTT-JTeX) 
+
+
+ xdvik-18f 
+xdvik18f-j1.1p5.patch  xdvik-20a 
+#    
+
+xdvik18f-j1.1p5.patch  READMEs/README.xdvik18f-j1.1p5.patch
+
+
+
+
+[1] 
+
+ (1) 
+
+     % gunzip -c xdvik-20a.tar.gz | tar xvf -
+
+
+ (2) 
+
+     % cd xdvik-20a/xdvik
+     % patch -p < (somewhere)/xdvik20a-j1.1*.patch
+
+
+ (3)  configure  Makefile 
+
+     % cd ..
+     % ./configure
+
+      xdvi 
+      dvi --> ps  configure 
+     
+
+      configure  ASCII, NTT 
+      VFlib 
+      dvi --> ps  dvips 
+
+   (3-1) ASCII, NTT  pk 
+
+          --without-vflib
+
+   (3-2) NTT  pk ASCII  VFlib 
+
+          --with-vflib=asciionly  --with-vflib=nontt
+
+   (3-3) 
+
+          --without-vfontmap
+
+        --without-vflib 
+       
+
+   (3-4) dvi --> ps  dvi2ps 
+
+          --with-dvifilter=dvi2ps
+
+   (3-5) dvi --> ps  jdvi2kps 
+
+          --with-dvifilter=jdvi2kps
+
+
+ (4) Makefile  ( Shrink )
+
+    % vi xdvik/Makefile  mule xdvik/Makefile
+
+     XDEFS  600dpi  Shrink
+      "6"  "8" 
+      SMALL_PANEL  "10" 
+     
+
+        ( 1) -DSHRINK=\"8\"
+        ( 2) -DSHRINK=\"10\" -DSMALL_PANEL
+        ( 3) -DBDPI=300 -DSHRINK=\"4\"
+        ( 4) -DBDPI=300 -DSHRINK=\"5\" -DSMALL_PANEL
+
+
+ (5) config.h 
+
+     % vi xdvik/config.h  mule xdvik/config.h
+
+   (5-1) 
+
+     default 
+     DVIPRINTER  PRINTCMD 
+
+      xdvi  dvi --> ps 
+      xdvipaper.* 
+     (default  /usr/local/share/texmf/xdvi)  config.h
+      FILTOPTTBLFILE xdvik/Makefile 
+     FILTOPTTBLDIR 
+
+      markpage+toc+printdvi+paper  
+     READMEs/README.markpage+toc+printdvi+paper 
+
+   (5-2) 
+
+     configure  --without-vfontmap 
+     
+
+     DEFAULT_FONTMAP default 
+     /usr/local/share/texmf/xdvi/vfontmap 
+
+  *********************************************************************
+  *  DEFAULT_FONTMAP  VFlib   *
+  *                 *
+  *                                                                   *
+  *          vfontmap  VFlib  vfontcap          *
+  *                                                                   *
+  *   [3]                                   *
+  *********************************************************************
+
+
+ (6) 
+
+     % make
+     % su
+
+     # make install
+
+
+
+[2] color special 
+
+     -usecolor 
+
+        xdvi*colorSpecial: on
+
+    
+    READMEs/README.jp-patch 
+
+
+
+[3] 
+
+   ( /usr/local/share/texmf/xdvi/vfontmap) 
+
+
+	mgoth	maru
+	fmin	fmin
+	fgoth	goth
+
+ "dvi "
+ "VFlib  vfontcap " 
+ xdvi 
+
+
+
+
+
+	min	min	# for ASCII
+	nmin	min	# for ASCII
+	goth	goth	# for ASCII
+	ngoth	goth	# for ASCII
+	dm	min	# for NTT
+	dg	goth	# for NTT
+
+
+
+ # 
+ VFONTMAP  
+
+	-vfontmap []
+
+ X  resource
+
+	xdvi*vfontmap:	[]
+
+
+
+	1.  vfontmap
+	2. 
+	3. X  resource (xdvi*vfontmap)
+	4.  VFONTMAP
+
+
+
+   vfontmap  NTT-JTeX   
+  xdvik18f-j1.0+vfontmap-ntt.patch 
+
+
+# NTT-JTeX 
+#  Web page
+#
+# 	http://www.cim.pe.u-tokyo.ac.jp/~kawachi/software/xdvik18f.html
+#
+# 
+#
+#  ASCII-pTeX  VFlib  jTeX/README.euc 
+#  doc/QA.txt 
+
+
+
+[4] 
+
+   xdvik18f-j1.0.patch 
+
+
+
+          miyu patch 
+                  <miyu@akiu.gw.tohoku.ac.jp>
+                 
+
+                 ( READMEs/README.jp-patch
+                  )
+
+          pTeX  color special 
+                  <lh36112@hongo.ecc.u-tokyo.ac.jp>
+                 (xdvi-17jp.960209 )
+
+          markpage+toc+printdvi+paper  
+                  <syun@fuka.info.waseda.ac.jp>
+                  <hirahara@fuka.info.waseda.ac.jp>
+                  <onono@fuka.info.waseda.ac.jp>
+                 
+
+                 (
+                  READMEs/README.markpage+toc+printdvi+paper
+                  )
+
+   vfontmap  (vfontmap.c) 
+(yamaga@ipc.chiba-u.ac.jp)
+
+
+
+
+[5] 
+
+  xdvik18f-j1.1p5.patch 
+ChangeLog.xdvik20a-j1.1 
+
+
+
+[6] 
+
+   
+(READMEs )
+
+(yamaga@ipc.chiba-u.ac.jp)
+
+
+
+
+
+[7] 
+
+  
+
+
+
+        
+        
+        
+        
+        
+          
+        
+          
+
+      ()
+
+
+
+		yamaga@ipc.chiba-u.ac.jp
+
+
+						
--- texk/xdvik/READMEs/README.xdvik20c-j1.0+hal2+dvisel.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik20c-j1.0+hal2+dvisel
@@ -0,0 +1,179 @@
+
+		<< xdvik20c+hal2+dvisel patch  >>
+
+				1999/03/04
+				 
+				watanabe@komadori.planet.sci.kobe-u.ac.jp
+
+xdvik20c+hal2+dvisel patch 
+
+  xdvik20c-j1.0p0e /
+
+
+/
+
+ 1) @ xdvi-17jp+toc+hal2 patch 
+
+  xdvi-17jp+toc+hal2 patch  READMEs/README.jp+toc+hal2 
+ xdvi-17jp  xdvi-21 
+ xdvik-20c 
+
+
+
+   1.1)  shrink 
+     
+
+     jp+toc+hal2 patch 
+    #ifdef ZOOM_BUTTON #undef 
+   Makefile.in  -DZOOM_BUTTON 
+    make  'Z' ()
+   'z'() 
+
+   1.2) TOC  DVI 
+     
+
+      Appendix 
+    README.jp+toc+hal2 
+
+
+ 2) PRINTDVI (?) DVISEL ()
+
+  Print xdvi 
+ TeX 
+xdvi 
+() PRINTDVI 
+(^^)
+
+  *  % :-)
+     PRINTDVI % 
+   %w %v 
+   :-)
+
+  * dviselect 
+      PRINTDVI 
+   
+   
+
+  * 
+      FreeBSD  Linux 
+   PRINTDVI 
+    dvips, dvi2ps,
+   jdvi2kps 
+   ?(^^;;)
+
+xdvi 
+
+  * xdvi  TeX  DVI 
+   DVI 
+  
+
+dviselect  xdvi !!
+
+
+  % dviselect 
+dviselect  xdvi 
+% 
+
+  print-out 
+
+dviselect  xdvi 
+ DVI 
+
+  dvips, dvi2ps, jdvi2kps 
+
+
+xdvi ()
+
+
+
+  ()
+UNIX 
+DVI 
+
+ xdvi 
+
+
+  DVISEL  define  dviselect 
+( /usr/local/bin/xdviprint-xdviprint 
+.xdviPrint ) DVI 
+
+   DVI 
+dvips 
+:-)
+  DVISEL  define % 
+
+  PRINTDVI landscape  xdvipaper.dvips
+xdvi 
+ xdvi xdvi
+
+
+PRINTDVI 
+:-)
+
+  DVISEL  PRINTDVI 
+ PRINTDVI dviselect 
+
+
+  DVISEL  DVI dviselect 
+DVI dviselect 
+ DVISEL 
+  DVI  063 1
+64 2
+ DVI  65
+ 64
+dviselect  DVI 
+1 DVISEL 
+ DVI 
+dviselect  DVI 
+
+   65 TeX 
+ DVI 
+:-)
+DVI 
+TeX  DVI :-)
+
+
+ 3)  ()
+
+   3.1) SMALL_PANEL 
+
+      SMALL_PANEL 
+   
+    SMALL_PANEL 
+   
+   
+   
+   
+
+   3.2) XDvi*international: TrueTOC 
+     
+     SELFILE 
+
+     (^^;;)Athena Widget
+    i18n  XFontStruct 
+   :-)
+     X11R4 (? ^^;;)#ifdef 
+   :-)  X11R4 ()
+
+   3.3) 
+
+     xdvi  man 
+   PRINTDVI 
+   :-)
+
+
+ ( TODO ())
+
+  *  xdvi-17 xdvik-20c 
+ xdvi-17jp.960209 
+    5.  DVI 
+    6.  -remote 
+ 
+
+
+
+
+   READMEs/ 
+
+
+/* Takeshi WATANABE <watanabe@komadori.planet.sci.kobe-u.ac.jp> */
--- texk/xdvik/READMEs/README.xdvik20c-j1.0p1.patch.orig	2015-07-19 18:49:41 UTC
+++ texk/xdvik/READMEs/README.xdvik20c-j1.0p1.patch
@@ -0,0 +1,43 @@
+xdvik20c-j1.0p1.patch 
+
+                                          
+                                           (knakau@sk.tsukuba.ac.jp)
+
+
+   xdvi (xdvik-20c) 
+   (ASCII-pTeX, NTT-JTeX)
+
+
+    xdvi-20a-j1.1p15.patch 
+   
+   
+
+
+    xdvik20a-j1.1p15.patch 
+   xdvik-20c
+   
+
+      xdvik-20
+      xdvik-20
+
+   xdvik20c-j1.0p1jisx0212
+   
+   
+    http://www.tooyoo.l.u-tokyo.ac.jp/fkr/makejvf.html
+    http://macptex.appi.keio.ac.jp/~uchiyama/gaiji.html
+
+
+   linux, Digital UNIX
+   
+   URL
+   http://ecopolis.sk.tsukuba.ac.jp/~knakau/unix/
+
+   README.xdvik20a-j1.1.patch 
+   
+
+
+    20a  20c 
+   
+
+      Makefile       ()
+      xdvi-config.h  ( config.h )
--- texk/xdvik/ac/withenable.ac.orig	2013-04-05 00:03:01 UTC
+++ texk/xdvik/ac/withenable.ac
@@ -6,5 +6,5 @@ dnl
 dnl extra_dirs = texk/xdvik/squeeze
 dnl
 ## configure options and TL libraries required for xdvik
-KPSE_ENABLE_PROG([xdvik], [kpathsea freetype2], [x])
+KPSE_ENABLE_PROG([xdvik], [kpathsea freetype2 zlib], [x])
 m4_include(kpse_TL[texk/xdvik/ac/xdvik.ac])
--- texk/xdvik/c-auto.in.orig	2014-04-13 01:27:58 UTC
+++ texk/xdvik/c-auto.in
@@ -72,6 +72,9 @@
 /* Define to 1 if you have the <float.h> header file. */
 #undef HAVE_FLOAT_H
 
+/* Using fontconfig */
+#undef HAVE_FONTCONFIG
+
 /* Define to 1 if you have the `fork' function. */
 #undef HAVE_FORK
 
@@ -108,6 +111,9 @@
 /* Define to 1 if you have the <iconv.h> header file. */
 #undef HAVE_ICONV_H
 
+/* Define to 1 if you have the `ptexenc' library. */
+#undef HAVE_PTEXENC
+
 /* Define to 1 if you have the <ieeefp.h> header file. */
 #undef HAVE_IEEEFP_H
 
@@ -346,6 +352,9 @@
 /* Define to the version of this package. */
 #undef PACKAGE_VERSION
 
+/* Enabled Japanese pTeX support. */
+#undef PTEX
+
 /* Define as the return type of signal handlers (`int' or `void'). */
 #undef RETSIGTYPE
 
--- texk/xdvik/configure.orig	2014-04-13 03:58:38 UTC
+++ texk/xdvik/configure
@@ -667,6 +667,7 @@ X_CFLAGS
 XMKMF
 LIBOBJS
 ALLOCA
+FONTCONFIGCPPFLAGS
 PS_DEF
 CPP
 OTOOL64
@@ -13309,6 +13310,20 @@ $as_echo "#define A4 1" >>confdefs.h
 
 fi
 
+
+$as_echo "#define PTEX 1" >>confdefs.h
+
+if pkg-config fontconfig --modversion > /dev/null 2>&1; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: adding fontconfig-\`pkg-config fontconfig --modversion\` library" >&5
+$as_echo "adding fontconfig-\`pkg-config fontconfig --modversion\` library" >&6; }
+  FONTCONFIGCPPFLAGS="`pkg-config fontconfig --cflags`"
+  LIBS="`pkg-config fontconfig --libs` $LIBS"
+
+
+$as_echo "#define HAVE_FONTCONFIG 1" >>confdefs.h
+
+fi
+
 ac_config_headers="$ac_config_headers c-auto.h:c-auto.in"
 
 
@@ -18409,6 +18424,82 @@ ${top_builddir}/../../libs/freetype2/fre
 	cd ${top_builddir}/../../libs/freetype2 && $(MAKE) $(AM_MAKEFLAGS) rebuild'
 fi
 
+## _KPSE_LIB_FLAGS: Setup zlib (-lz) flags
+
+# Check whether --with-system-zlib was given.
+if test "${with_system_zlib+set}" = set; then :
+  withval=$with_system_zlib;
+fi
+
+# Check whether --with-zlib-includes was given.
+if test "${with_zlib_includes+set}" = set; then :
+  withval=$with_zlib_includes;
+fi
+
+# Check whether --with-zlib-libdir was given.
+if test "${with_zlib_libdir+set}" = set; then :
+  withval=$with_zlib_libdir;
+fi
+if test "x$with_system_zlib" = xyes; then
+  if test "x$with_zlib_includes" != x && test "x$with_zlib_includes" != xyes; then
+  ZLIB_INCLUDES="-I$with_zlib_includes"
+fi
+ZLIB_LIBS="-lz"
+if test "x$with_zlib_libdir" != x && test "x$with_zlib_libdir" != xyes; then
+  ZLIB_LIBS="-L$with_zlib_libdir $ZLIB_LIBS"
+fi
+else
+  ZLIB_INCLUDES="-I$kpse_BLD/libs/zlib/include"
+  ZLIB_LIBS="$kpse_BLD/libs/zlib/libz.a"
+  ZLIB_DEPEND='${top_builddir}/../../libs/zlib/libz.a'
+  ZLIB_RULE='# Rebuild libz
+$(ZLIB_DEPEND): ${top_builddir}/../../libs/zlib/include/zconf.h
+	cd ${top_builddir}/../../libs/zlib && $(MAKE) $(AM_MAKEFLAGS) rebuild
+${top_builddir}/../../libs/zlib/include/zconf.h:
+	cd ${top_builddir}/../../libs/zlib && $(MAKE) $(AM_MAKEFLAGS) rebuild'
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if <zlib.h> defines 'z_const'" >&5
+$as_echo_n "checking if <zlib.h> defines 'z_const'... " >&6; }
+if ${kpse_cv_have_decl_z_const+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  eval CPPFLAGS=\"$ZLIB_INCLUDES \$CPPFLAGS\"
+eval LIBS=\"$ZLIB_LIBS \$LIBS\"
+
+                cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <zlib.h>
+int
+main ()
+{
+z_const char * foo();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  kpse_cv_have_decl_z_const=yes
+else
+  kpse_cv_have_decl_z_const=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+                CPPFLAGS=$kpse_save_CPPFLAGS
+LIBS=$kpse_save_LIBS
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $kpse_cv_have_decl_z_const" >&5
+$as_echo "$kpse_cv_have_decl_z_const" >&6; }
+case $kpse_cv_have_decl_z_const in #(
+  yes) :
+
+$as_echo "#define ZLIB_CONST 1" >>confdefs.h
+ ;; #(
+  *) :
+
+$as_echo "#define z_const /**/" >>confdefs.h
+ ;;
+esac
+
 
 
 # Check whether --with-default-gs-lib-path was given.
--- texk/xdvik/configure.ac.orig	2014-04-13 03:58:39 UTC
+++ texk/xdvik/configure.ac
@@ -67,6 +67,16 @@ AS_IF([test "x$enable_a4" = xno],
       [AC_MSG_NOTICE([Disabled a4/cm, using letter/in instead])],
       [AC_DEFINE([A4], 1, [Define to use A4 as the default paper size.])])
 
+dnl Kanji support
+AC_DEFINE([PTEX], 1, [Enabled Japanese pTeX support.])
+if pkg-config fontconfig --modversion > /dev/null 2>&1; then
+  AC_MSG_RESULT(adding fontconfig-`pkg-config fontconfig --modversion` library)
+  FONTCONFIGCPPFLAGS="`pkg-config fontconfig --cflags`"
+  LIBS="`pkg-config fontconfig --libs` $LIBS"
+  AC_SUBST(FONTCONFIGCPPFLAGS)
+  AC_DEFINE(HAVE_FONTCONFIG, 1, [Using fontconfig])
+fi
+
 AC_CONFIG_HEADERS([c-auto.h:c-auto.in])
 
 AC_FUNC_FORK
@@ -263,6 +273,7 @@ fi
 
 KPSE_KPATHSEA_FLAGS
 KPSE_FREETYPE2_FLAGS
+KPSE_ZLIB_FLAGS
 
 XDVI_GS_LIB_PATH
 
--- texk/xdvik/dvi-draw.c.orig	2013-09-01 05:55:44 UTC
+++ texk/xdvik/dvi-draw.c
@@ -56,6 +56,9 @@ in xdvi.c.
 #include "statusline.h"
 #include "hypertex.h"
 #include "special.h"
+#ifdef PTEX
+#include "ptexmap.h"
+#endif
 #include "my-snprintf.h"
 #include "kpathsea/tex-file.h"
 #include "mag.h"
@@ -531,8 +534,8 @@ print_char(ubyte ch, struct glyph *g)
 }
 
 static const char *dvi_table1[] = {
-    "SET1", "SET2", NULL, NULL, "SETRULE", "PUT1", "PUT2", NULL,
-    NULL, "PUTRULE", "NOP", "BOP", "EOP", "PUSH", "POP", "RIGHT1",
+    "SET1", "SET2", "SET3", "SET4", "SETRULE", "PUT1", "PUT2", "PUT3",
+    "PUT4", "PUTRULE", "NOP", "BOP", "EOP", "PUSH", "POP", "RIGHT1",
     "RIGHT2", "RIGHT3", "RIGHT4", "W0", "W1", "W2", "W3", "W4",
     "X0", "X1", "X2", "X3", "X4", "DOWN1", "DOWN2", "DOWN3",
     "DOWN4", "Y0", "Y1", "Y2", "Y3", "Y4", "Z0", "Z1",
@@ -542,7 +545,12 @@ static const char *dvi_table1[] = {
 static const char *dvi_table2[] = {
     "FNT1", "FNT2", "FNT3", "FNT4", "XXX1", "XXX2", "XXX3", "XXX4",
     "FNTDEF1", "FNTDEF2", "FNTDEF3", "FNTDEF4", "PRE", "POST", "POSTPOST",
-    "SREFL", "EREFL", NULL, NULL, NULL, NULL
+    "SREFL", "EREFL", NULL, NULL, NULL,
+#ifdef PTEX
+    "DIRECTION"
+#else /* !PTEX */
+    NULL
+#endif /* !PTEX */
 };
 
 static void
@@ -667,6 +675,146 @@ sample(bmUnitT *bits, int bytes_wide, in
     return n;
 }
 
+extern	double	bbox_matrix[2][2];
+extern	Boolean	bbox_scaled, bbox_rotated;
+
+static void moveH(int dir, long dx)
+{
+  int pint=TATE;
+  if (pint&2) { pint&=1; dx=-dx;}
+  if (pint) {
+    DVI_H -= dx * bbox_matrix[1][0];
+    DVI_V += dx * bbox_matrix[0][0];
+  } else {
+    DVI_H += dir * dx * bbox_matrix[0][0];
+    DVI_V += dir * dx * bbox_matrix[1][0];
+  }
+  PXL_V = pixel_conv(DVI_V);
+}
+
+static void moveV(int dir, long dy)
+{
+  int pint=TATE;
+  if (pint&2) { pint&=1; dy=-dy;}
+  if (pint) {
+    DVI_H -= dy * bbox_matrix[1][1];
+    DVI_V += dy * bbox_matrix[0][1];
+  } else {
+    DVI_H += dir * dy * bbox_matrix[0][1];
+    DVI_V += dir * dy * bbox_matrix[1][1];
+  }
+  PXL_V = pixel_conv(DVI_V);
+}
+
+#define PUSH_POSITION do { \
+	dvi_h_sav = DVI_H; \
+	dvi_v_sav = DVI_V; \
+	pxl_v_sav = PXL_V; } while (0)
+#define POP_POSITION do { \
+	DVI_H = dvi_h_sav; \
+	DVI_V = dvi_v_sav; \
+	PXL_V = pxl_v_sav; } while (0)
+#define DEFINE_POSITION_VAL \
+	long dvi_h_sav, dvi_v_sav, pxl_v_sav
+
+#ifndef   WORDS_BIGENDIAN
+#define EXTREME_LEFT_BIT   (1 << 0)
+#define EXTREME_RIGHT_BIT  ((bmUnitT)(1 << (BMBITS-1)))
+#define SHIFT_RIGHT(a)     ((a) <<= 1)
+#else  /* WORDS_BIGENDIAN */
+#define EXTREME_LEFT_BIT   ((bmUnitT)(1 << (BMBITS-1)))
+#define EXTREME_RIGHT_BIT  (1 << 0)
+#define SHIFT_RIGHT(a)     ((a) >>= 1)
+#endif /* WORDS_BIGENDIAN */
+
+static	void
+bbox_scale_bitmap(struct glyph *g)
+{
+    bmUnitT *new_ptr;
+    int xmax, ymax, xmin, ymin, x, y;
+    double d;
+ 
+    if (g->bitmap3.bits) {
+	if (g->matrix[0][0] == (float) bbox_matrix[0][0]
+	    && g->matrix[0][1] == (float) bbox_matrix[0][1]
+	    && g->matrix[1][0] == (float) bbox_matrix[1][0]
+	    && g->matrix[1][1] == (float) bbox_matrix[1][1])
+	    return;
+	else
+	    free(g->bitmap.bits);
+    } else {
+	g->bitmap3 = g->bitmap;
+	g->x3 = g->x;
+	g->y3 = g->y;
+    }
+
+    xmax = ymax = xmin = ymin = 0;
+    x = g->bitmap3.w * bbox_matrix[0][0];
+    y = g->bitmap3.w * bbox_matrix[1][0];
+    if (xmax < x) xmax = x;
+    else if (xmin > x) xmin = x;
+    if (ymax < y) ymax = y;
+    else if (ymin > y) ymin = y;
+    x = g->bitmap3.w * bbox_matrix[0][0] + g->bitmap3.h * bbox_matrix[0][1];
+    y = g->bitmap3.w * bbox_matrix[1][0] + g->bitmap3.h * bbox_matrix[1][1];
+    if (xmax < x) xmax = x;
+    else if (xmin > x) xmin = x;
+    if (ymax < y) ymax = y;
+    else if (ymin > y) ymin = y;
+    x = g->bitmap3.h * bbox_matrix[0][1];
+    y = g->bitmap3.h * bbox_matrix[1][1];
+    if (xmax < x) xmax = x;
+    else if (xmin > x) xmin = x;
+    if (ymax < y) ymax = y;
+    else if (ymin > y) ymin = y;
+    xmin--; ymin--; xmax++; ymax++;
+
+    d = bbox_matrix[0][0] * bbox_matrix[1][1]
+	- bbox_matrix[0][1] * bbox_matrix[1][0];
+
+    g->x = g->x3 * bbox_matrix[0][0] + g->y3 * bbox_matrix[0][1] - xmin;
+    g->y = g->x3 * bbox_matrix[1][0] + g->y3 * bbox_matrix[1][1] - ymin;
+    g->matrix[0][0] = (float) bbox_matrix[0][0];
+    g->matrix[0][1] = (float) bbox_matrix[0][1];
+    g->matrix[1][0] = (float) bbox_matrix[1][0];
+    g->matrix[1][1] = (float) bbox_matrix[1][1];
+
+    free_bitmap2(g);
+    g->bitmap.w = xmax - xmin + 1;
+    g->bitmap.h = ymax - ymin + 1;
+    alloc_bitmap(&g->bitmap);
+    clear_bitmap(&g->bitmap);
+
+    new_ptr = (bmUnitT *) g->bitmap.bits;
+    for (y = ymin; y <= ymax; y++) {
+	register bmUnitT m, *cp;
+
+	cp = new_ptr;
+	m = EXTREME_LEFT_BIT;
+	for (x = xmin; x <= xmax; x++) {
+	    int bx, by;
+	    bx = (x * bbox_matrix[1][1] - y * bbox_matrix[0][1]) / d;
+	    by = (y * bbox_matrix[0][0] - x * bbox_matrix[1][0]) / d;
+	    if (bx >= 0 && bx < g->bitmap3.w
+		&& by >= 0 && by < g->bitmap3.h
+		&& *((bmUnitT *)g->bitmap3.bits
+		     + by * (g->bitmap3.bytes_wide / BMBYTES) + bx / BMBITS)
+#ifndef	WORDS_BIGENDIAN
+		& (1 << (bx % BMBITS)))
+#else
+		& (1 << (BMBITS - 1 - bx % BMBITS)))
+#endif
+		    *cp |= m;
+	    if (m == EXTREME_RIGHT_BIT) {
+		m = EXTREME_LEFT_BIT;
+		++cp;
+	    }
+	    else SHIFT_RIGHT(m);
+	}
+	new_ptr = ADD(new_ptr, g->bitmap.bytes_wide);
+    }
+}
+
 static void
 shrink_glyph(struct glyph *g)
 {
@@ -757,6 +905,89 @@ shrink_glyph(struct glyph *g)
 	print_bitmap(&g->bitmap2);
 }
 
+#ifdef PTEX
+void
+rotate_bitmap(struct bitmap *bm)
+{
+      struct bitmap new_bm;
+      bmUnitT *old_ptr, *new_ptr, *cp;
+      int    x, y;
+      bmUnitT m1, m2;
+ 
+      new_bm.h = bm->w;
+      new_bm.w = bm->h;
+      alloc_bitmap(&new_bm);
+      clear_bitmap(&new_bm);
+      old_ptr = ADD(bm->bits, bm->bytes_wide * bm->h);
+      new_ptr = (bmUnitT *)new_bm.bits;
+
+      m1 = EXTREME_LEFT_BIT;
+      for (y = 0; y < bm->h; y++) {
+	old_ptr = SUB(old_ptr, bm->bytes_wide);
+	cp = old_ptr;
+	m2 = EXTREME_LEFT_BIT;
+	for (x = 0; x < bm->w; x++) {
+	  if (*cp & m2)
+	    *ADD(new_ptr, x*new_bm.bytes_wide) |= m1;
+	  if (m2 == EXTREME_RIGHT_BIT) {
+	    m2 = EXTREME_LEFT_BIT;
+	    ++cp;
+	  }
+	  else SHIFT_RIGHT(m2);
+	}
+	if (m1 == EXTREME_RIGHT_BIT) {
+	  m1 = EXTREME_LEFT_BIT;
+	  ++new_ptr;
+	}
+	else SHIFT_RIGHT(m1);
+      }
+
+      free(bm->bits);
+      *bm = new_bm;
+}
+
+
+void
+reverse_rotate_bitmap(struct bitmap *bm)
+{
+      struct bitmap new_bm;
+      bmUnitT *old_ptr, *new_ptr, *cp;
+      int    x, y;
+      bmUnitT m1, m2;
+
+      new_bm.h = bm->w;
+      new_bm.w = bm->h;
+      alloc_bitmap(&new_bm);
+      clear_bitmap(&new_bm);
+      old_ptr = (bmUnitT *)bm->bits;
+      new_ptr = (bmUnitT *)new_bm.bits;
+
+      m1 = EXTREME_LEFT_BIT;
+      for (y = 0; y < bm->h; y++) {
+	cp = old_ptr;
+	old_ptr = ADD(old_ptr, bm->bytes_wide);
+	m2 = EXTREME_LEFT_BIT;
+	for (x = bm->w; x--;) {
+	  if (*cp & m2)
+	    *ADD(new_ptr, x * new_bm.bytes_wide) |= m1;
+	  if (m2 == EXTREME_RIGHT_BIT) {
+	    m2 = EXTREME_LEFT_BIT;
+	    ++cp;
+	  }
+	  else SHIFT_RIGHT(m2);
+	}
+	if (m1 == EXTREME_RIGHT_BIT) {
+	  m1 = EXTREME_LEFT_BIT;
+	  ++new_ptr;
+	}
+	else SHIFT_RIGHT(m1);
+      }
+
+      free(bm->bits);
+      *bm = new_bm;
+}
+#endif /* PTEX */
+
 #ifdef	GREY
 
 #ifdef RGB_ANTI_ALIASING
@@ -970,6 +1201,7 @@ shrink_glyph_grey(struct glyph *g)
 				 BMBITS, 0);
 	size = g->image2->bytes_per_line * g->bitmap2.h;
 	g->pixmap2 = g->image2->data = xmalloc(size != 0 ? size : 1);
+	ASSERT(g->pixmap2_gc2 == NULL, "pixmap2_gc2 is not NULL.");
     }
     /* ... and the pixmap used for globals.gc.fore2: */
     if (globals.gc.fore2 != NULL && g->pixmap2_gc2 == NULL) {
@@ -1283,8 +1515,13 @@ static ubyte scantable[256] = {
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     1, 2,	/* SET1,SET2 (128,129) */
-    /* -,-,SETRULE,PUT1,PUT2,-,-,PUTRULE,NOP,BOP (130-139) */
+#ifdef PTEX
+    /* SET3,SET4,SETRULE,PUT1,PUT2,PUT3,PUT4,PUTRULE,NOP,BOP (130-139) */
+    3, 4, 8, 1, 2, 3, 4, 8, 0, 44,
+#else
+    /* -,-,SETRULE,PUT1,PUT2,-,-,PUTRULE,NOP,BOP (132-139) */
     M4, M4, 8, 1, 2, M4, M4, 8, 0, 44,
+#endif
     M1, 0, 0, 1, 2, 3, 4, 0, 1, 2,	/* EOP,PUSH,POP,RIGHT1-4,W0M2 (140-149) */
     3, 4, 0, 1, 2, 3, 4, 1, 2, 3,	/* W3-4,X0-4,DOWN1-3 (150-159) */
     4, 0, 1, 2, 3, 4, 0, 1, 2, 3,	/* DOWN4,Y0-4,Z0-3 (160-169) */
@@ -1337,9 +1574,11 @@ spcl_scan(Boolean (*spcl_proc)(char *str
 		ch = xone(fp);
 		xskip(fp, (long)ch + (long)xone(fp));
 		break;
+#ifndef PTEX
 	    case M4:	/* unrecognizable */
 		XDVI_FATAL((stderr, "unknown op-code %d", ch));
 		break;
+#endif /* !PTEX */
 	    case M5:	/* doesn't belong */
 		dvi_fmt_error("spcl_scan: shouldn't happen: %s encountered",
 			      dvi_table2[ch - (FNTNUM0 + 64)]);
@@ -1453,6 +1692,46 @@ prescan(FILE *fp)
  *	Routines to print characters.
  */
 
+#ifdef PTEX
+static void
+set_char_rotate_glyph(struct glyph *g)
+{
+  int tmp, rot = TATE - g->tdir;
+  if (rot<0) rot+=4;
+  switch(rot) {
+  case 2:
+    rotate_bitmap(&g->bitmap);
+    tmp = g->x;
+    g->x = g->bitmap.w - g->y;
+    g->y = tmp;
+    g->tdir = TATE;
+    free_bitmap2(g);
+  case 1:
+    rotate_bitmap(&g->bitmap);
+    tmp = g->x;
+    g->x = g->bitmap.w - g->y;
+    g->y = tmp;
+    g->tdir = TATE;
+    free_bitmap2(g);
+    break;
+  case 3:
+    reverse_rotate_bitmap(&g->bitmap);
+    tmp = g->x;
+    g->x = g->y;
+    g->y = g->bitmap.h - tmp;
+    g->tdir = TATE;
+    free_bitmap2(g);
+  }
+}
+#endif /* PTEX */
+
+static setcharRetvalT
+common_set_char(
+#ifdef TEXXET
+		wide_ubyte,
+#endif
+		struct glyph *);
+
 setcharRetvalT
 set_char(
 #ifdef TEXXET
@@ -1461,9 +1740,6 @@ set_char(
 	 wide_ubyte ch)
 {
     struct glyph *g;
-#ifdef TEXXET
-    long dvi_h_sav;
-#endif
 
     if (ch > maxchar)
 	realloc_font(currinf.fontp, (wide_ubyte)ch);
@@ -1497,14 +1773,41 @@ set_char(
 	    print_char((ubyte) ch, g);
 	currinf.fontp->timestamp = ++current_timestamp;
     }
+#ifdef PTEX
+    set_char_rotate_glyph(g);
+#endif /* PTEX */
+#ifdef TEXXET
+    common_set_char(cmd, g);
+#else
+    return common_set_char(g);
+#endif
+}
 
+static setcharRetvalT
+common_set_char(
 #ifdef TEXXET
-    dvi_h_sav = DVI_H;
-    if (currinf.dir < 0)
-	DVI_H -= g->dvi_adv;
+		wide_ubyte cmd,
+#endif
+		struct glyph *g)
+{
+#ifdef	TEXXET
+    DEFINE_POSITION_VAL;
+    PUSH_POSITION;
+    if (! TATE && currinf.dir < 0)
+	moveH(1, -g->dvi_adv);
 
     if (scan_frame == NULL) {
 #endif
+	if (bbox_scaled)
+	    bbox_scale_bitmap(g);
+	else if (g->bitmap3.bits) {
+	    free(g->bitmap.bits);
+	    g->bitmap = g->bitmap3;
+	    g->bitmap3.bits = NULL;
+	    g->x = g->x3;
+	    g->y = g->y3;
+	    free_bitmap2(g);
+	}
 	
 #ifdef RGB_ANTI_ALIASING
 	if (currwin.shrinkfactor == -1) {
@@ -1546,9 +1849,9 @@ set_char(
 #ifdef TEXXET
     }
     if (cmd == PUT1 || (resource.omega && cmd == PUT2))
-	DVI_H = dvi_h_sav;
-    else if (currinf.dir > 0)
-	DVI_H += g->dvi_adv;
+	POP_POSITION;
+    else if (TATE || currinf.dir > 0)
+	moveH(1, g->dvi_adv);
     return;
 #else
     return g->dvi_adv;
@@ -1603,6 +1906,33 @@ set_empty_char(
 #endif
 }
 
+#ifdef PTEX
+setcharRetvalT
+set_char2(
+#ifdef TEXXET
+	 wide_ubyte cmd,
+#endif
+	 wide_ubyte ch)
+{
+    struct glyph *g;
+
+    if (ch > currinf.fontp->maxchar ||
+	(g = currinf.fontp->kglyph[ch]) == NULL || g->bitmap.bits == NULL) {
+	(*currinf.fontp->read_char)(currinf.fontp, ch);
+	g = currinf.fontp->kglyph[ch];
+	free_bitmap2(g);
+	g->tdir = currinf.fontp->dir;
+	if (globals.debug & DBG_BITMAP) print_char((ubyte) ch, g);
+    }
+    set_char_rotate_glyph(g);
+#ifdef TEXXET
+    common_set_char(cmd, g);
+#else
+    return common_set_char(g);
+#endif
+}
+#endif /* PTEX */
+
 setcharRetvalT
 load_n_set_char(
 #ifdef TEXXET
@@ -1650,7 +1980,7 @@ set_vf_char(
     wide_ubyte oldmaxchar;
     static ubyte c;
 #ifdef TEXXET
-    long dvi_h_sav;
+    DEFINE_POSITION_VAL;
 #endif
 
     if (ch > maxchar)
@@ -1666,9 +1996,9 @@ set_vf_char(
 #endif
     }
 #ifdef TEXXET
-    dvi_h_sav = DVI_H;
-    if (currinf.dir < 0)
-	DVI_H -= m->dvi_adv;
+    PUSH_POSITION;
+    if (! TATE && currinf.dir < 0)
+	moveH(1, -m->dvi_adv);
     if (scan_frame == NULL) {
 #endif
 	oldinfo = currinf;
@@ -1693,9 +2023,9 @@ set_vf_char(
 #ifdef TEXXET
     }
     if (cmd == PUT1 || (resource.omega && cmd == PUT2))
-	DVI_H = dvi_h_sav;
-    else if (currinf.dir > 0)
-	DVI_H += m->dvi_adv;
+	POP_POSITION;
+    else if (TATE || currinf.dir > 0)
+	moveH(1, m->dvi_adv);
     return;
 #else
     return m->dvi_adv;
@@ -1813,9 +2143,64 @@ set_no_char(
  *	Set rule.  Arguments are coordinates of lower left corner.
  */
 
+static	void
+set_rotated_rule(long h, long w)
+{
+    XPoint points[4];
+    int pint = TATE;
+    if (pint&2) { pint&=1;
+      w=-w; h=-h;
+    }
+    points[0].x = PXL_H - currwin.base_x;
+    points[0].y = PXL_V - currwin.base_y;
+#ifdef PTEX
+    if (pint) {
+	points[1].x = -w * bbox_matrix[1][0];
+	points[1].y = w * bbox_matrix[0][0];
+	points[2].x = h * bbox_matrix[1][1];
+	points[2].y = -h * bbox_matrix[0][1];
+    } else
+#endif /* PTEX */
+    {
+	points[1].x = DIR * w * bbox_matrix[0][0];
+	points[1].y = DIR * w * bbox_matrix[1][0];
+	points[2].x = -h * bbox_matrix[0][1];
+	points[2].y = -h * bbox_matrix[1][1];
+    }
+    points[3].x = -points[1].x;
+    points[3].y = -points[1].y;
+
+    if (--globals.ev.ctr == 0) {
+	if (read_events(EV_NOWAIT) & EV_GE_MAG_GONE) {
+	    /* fprintf(stderr, "longjmp1!\n"); */
+	    longjmp(globals.ev.canit, 1);
+	}
+    }
+#if COLOR
+    if (fg_active != fg_current)
+	do_color_change();
+#endif
+    XFillPolygon(DISP, currwin.win,
+		 htex_inside_href ? globals.gc.high: globals.gc.rule,
+		 points, 4, Convex, CoordModePrevious);
+}
+
 static void
 set_rule(int h, int w)
 {
+    if (bbox_rotated) {
+	set_rotated_rule(h, w);
+	return;
+    }
+    h = h * bbox_matrix[1][1];
+    w = w * bbox_matrix[0][0];
+#ifdef PTEX
+    if (TATE==1)
+	put_rule(PXL_H, PXL_V, (unsigned int)h, (unsigned int)w);
+    else if (TATE==3) /* dtou */
+	put_rule(PXL_H - h + 1, PXL_V - w + 1, (unsigned int)h, (unsigned int)w);
+    else
+#endif /* PTEX */
 #ifdef TEXXET
     put_rule(PXL_H - (currinf.dir < 0 ? w - 1 : 0), PXL_V - h + 1,
 	     (unsigned int)w, (unsigned int)h);
@@ -1860,7 +2245,7 @@ draw_part(FILE *fp, struct frame *minfra
 #ifdef TEXXET
 	    (*currinf.set_char_p) (ch, ch);
 #else
-	    DVI_H += (*currinf.set_char_p) (ch);
+	    moveH(1, (*currinf.set_char_p) (ch));
 #endif
 	}
 	else if (FNTNUM0 <= ch && ch <= (ubyte) (FNTNUM0 + 63)) {
@@ -1877,7 +2262,7 @@ draw_part(FILE *fp, struct frame *minfra
 #else
 		a = (*currinf.set_char_p) (xone(fp));
 		if (ch != PUT1)
-		    DVI_H += a;
+		    moveH(1, a);
 #endif
 		break;
 
@@ -1892,7 +2277,39 @@ draw_part(FILE *fp, struct frame *minfra
 #else
 		    a = (*currinf.set_char_p) (xnum(fp, 2));
 		    if (ch != PUT2)
-			DVI_H += a;
+			moveH(1, a);
+#endif
+		}
+		break;
+
+	    case SET3:
+	    case PUT3:
+		if (!resource.omega)
+		    dvi_fmt_error("%s:%d: draw_part: op-code %d only works with the \"-omega\" option",
+				  __FILE__, __LINE__, ch);
+		else {
+#ifdef TEXXET
+		    (*currinf.set_char_p) (ch, xnum(fp, 3));
+#else
+		    a = (*currinf.set_char_p) (xnum(fp, 3));
+		    if (ch != PUT3)
+			moveH(1, a);
+#endif
+		}
+		break;
+
+	    case SET4:
+	    case PUT4:
+		if (!resource.omega)
+		    dvi_fmt_error("%s:%d: draw_part: op-code %d only works with the \"-omega\" option",
+				  __FILE__, __LINE__, ch);
+		else {
+#ifdef TEXXET
+		    (*currinf.set_char_p) (ch, xnum(fp, 4));
+#else
+		    a = (*currinf.set_char_p) (xnum(fp, 4));
+		    if (ch != PUT4)
+			moveH(1, a);
 #endif
 		}
 		break;
@@ -1910,7 +2327,7 @@ draw_part(FILE *fp, struct frame *minfra
 		    ) {
 		    set_rule(pixel_round(xspell_conv(a)), pixel_round(b));
 		}
-		DVI_H += DIR * b;
+		moveH(DIR, b);
 		break;
 
 	    case PUTRULE:
@@ -1934,6 +2351,9 @@ draw_part(FILE *fp, struct frame *minfra
 		DVI_V = OFFSET_Y;
 		PXL_V = pixel_conv(DVI_V);
 		WW = XX = YY = ZZ = 0;
+		bbox_matrix[0][0] = bbox_matrix[1][1] = 1.0;
+		bbox_matrix[0][1] = bbox_matrix[1][0] = 0.0;
+		bbox_scaled = bbox_rotated = False;
 		break;
 
 	    case EOP:
@@ -2028,7 +2448,7 @@ draw_part(FILE *fp, struct frame *minfra
 	    case RIGHT2:
 	    case RIGHT3:
 	    case RIGHT4:
-		DVI_H += DIR * xspell_conv(xsnum(fp, ch - RIGHT1 + 1));
+		moveH(DIR, xspell_conv(xsnum(fp, ch - RIGHT1 + 1)));
 		break;
 
 	    case W1:
@@ -2037,7 +2457,7 @@ draw_part(FILE *fp, struct frame *minfra
 	    case W4:
 		WW = xspell_conv(xsnum(fp, ch - W0));
 	    case W0:
-		DVI_H += DIR * WW;
+		moveH(DIR, WW);
 		break;
 
 	    case X1:
@@ -2046,15 +2466,14 @@ draw_part(FILE *fp, struct frame *minfra
 	    case X4:
 		XX = xspell_conv(xsnum(fp, ch - X0));
 	    case X0:
-		DVI_H += DIR * XX;
+		moveH(DIR, XX);
 		break;
 
 	    case DOWN1:
 	    case DOWN2:
 	    case DOWN3:
 	    case DOWN4:
-		DVI_V += xspell_conv(xsnum(fp, ch - DOWN1 + 1));
-		PXL_V = pixel_conv(DVI_V);
+		moveV(1, xspell_conv(xsnum(fp, ch - DOWN1 + 1)));
 		break;
 
 	    case Y1:
@@ -2063,8 +2482,7 @@ draw_part(FILE *fp, struct frame *minfra
 	    case Y4:
 		YY = xspell_conv(xsnum(fp, ch - Y0));
 	    case Y0:
-		DVI_V += YY;
-		PXL_V = pixel_conv(DVI_V);
+		moveV(1, YY);
 		break;
 
 	    case Z1:
@@ -2073,8 +2491,7 @@ draw_part(FILE *fp, struct frame *minfra
 	    case Z4:
 		ZZ = xspell_conv(xsnum(fp, ch - Z0));
 	    case Z0:
-		DVI_V += ZZ;
-		PXL_V = pixel_conv(DVI_V);
+		moveV(1, ZZ);
 		break;
 
 	    case FNT1:
@@ -2121,6 +2538,11 @@ draw_part(FILE *fp, struct frame *minfra
 		dvi_fmt_error("%s:%d: draw_part: shouldn't happen: %s encountered",
 			      __FILE__, __LINE__, dvi_table2[ch - (FNTNUM0 + 64)]);
 		break;
+#ifdef PTEX
+	    case TDIR:
+		TATE = xone(fp);
+		break;
+#endif /* PTEX */
 
 	    default:
 		dvi_fmt_error("%s:%d: draw_part: unknown op-code %d", __FILE__, __LINE__, ch);
@@ -2311,7 +2733,7 @@ draw_page(void)
     psp.endpage();
 #endif
     if (currwin.win == mane.win && resource.postscript != 1) {
-	display_bboxes();
+       display_bboxes();
     }
     if (search_have_match(current_page)) {
 	/* highlight search match */
@@ -2921,7 +3343,15 @@ do_char(wide_ubyte ch,
     last_dvi_h1 = DVI_H;
     last_u_glyph = u_glyph;
     last_pxl_v = pxl_v1;
+#ifdef PTEX
+    if (currinf.fontp->flags & FONT_KANJI) {
+    last_dvi_h2 = DVI_H + currinf.fontp->kglyph[ch]->dvi_adv;
+    } else {
+#endif /* PTEX */
     last_dvi_h2 = DVI_H + currinf.fontp->glyph[ch].dvi_adv;
+#ifdef PTEX
+    }
+#endif /* PTEX */
     last_x = x2;
 }
 
@@ -2935,6 +3365,10 @@ text_do_char(FILE *fp, struct scan_info 
 	    return 0;	/* error; we'll catch it later */
 	maxchar = currinf.fontp->maxchar;
 	currinf.set_char_p = currinf.fontp->set_char_p;
+#if FREETYPE
+        if (currinf.set_char_p == set_ft_char)
+	    do_load_freetype_font();
+#endif
     }
 
     if (currinf.set_char_p == set_empty_char)
@@ -2962,10 +3396,6 @@ text_do_char(FILE *fp, struct scan_info 
 	}
 	maxchar = currinf.fontp->maxchar;
 	currinf.set_char_p = currinf.fontp->set_char_p;
-#if FREETYPE
-	if (currinf.set_char_p == set_ft_char)
-	    do_load_freetype_font();
-#endif
     }
 
     if (currinf.set_char_p == set_char) {
@@ -2993,25 +3423,56 @@ text_do_char(FILE *fp, struct scan_info 
 	}
 #ifdef TEXXET
 	if (geom_scan_frame == NULL) {
-	    long dvi_h_sav = DVI_H;
-	    if (currinf.dir < 0)
-		DVI_H -= g->dvi_adv;
+	    DEFINE_POSITION_VAL;
+	    PUSH_POSITION;
+	    if (! TATE && currinf.dir < 0)
+		moveH(1, -g->dvi_adv);
 #endif
 	    x = G_PXL_H - g->x;
 	    y = PXL_V - g->y;
 	    do_char(ch, currinf, info, PXL_V, y, x, x + g->bitmap.w - 1, g);
 #ifdef TEXXET
-	    DVI_H = dvi_h_sav;
+	    POP_POSITION;
+	}
+#endif
+	return DIR * g->dvi_adv;
+    }
+#ifdef PTEX
+    else if (currinf.set_char_p == set_char2) {
+	struct glyph *g;
+	long x, y;
+
+	g = currinf.fontp->kglyph[ch];
+	if (g == NULL || g->bitmap.bits == NULL) {
+	    (*currinf.fontp->read_char)(currinf.fontp, ch);
+	    g = currinf.fontp->kglyph[ch];
+	    free_bitmap2(g);
+	    g->tdir = currinf.fontp->dir;
+	}
+
+#ifdef TEXXET
+	if (geom_scan_frame == NULL) {
+	    DEFINE_POSITION_VAL;
+	    PUSH_POSITION;
+	    if (! TATE && currinf.dir < 0)
+		moveH(1, -g->dvi_adv);
+#endif
+	    x = G_PXL_H - g->x;
+	    y = PXL_V - g->y;
+	    do_char(ch, currinf, info, PXL_V, y, x, x + g->bitmap.w - 1, g);
+#ifdef TEXXET
+	    POP_POSITION;
 	}
 #endif
 	return DIR * g->dvi_adv;
     }
+#endif /* PTEX */
     else if (currinf.set_char_p == set_vf_char) {
 	struct macro *m;
 	struct drawinf oldinfo;
 	wide_ubyte oldmaxchar;
 #ifdef TEXXET
-	long dvi_h_sav;
+	DEFINE_POSITION_VAL;
 #endif
 
 	if (ch > maxchar)
@@ -3019,9 +3480,9 @@ text_do_char(FILE *fp, struct scan_info 
 	if ((m = &currinf.fontp->macro[ch])->pos == NULL)
 	    return 0;	/* catch the error later */
 #ifdef TEXXET
-	dvi_h_sav = DVI_H;
-	if (currinf.dir < 0)
-	    DVI_H -= m->dvi_adv;
+	PUSH_POSITION;
+	if (! TATE && currinf.dir < 0)
+	    moveH(1, -m->dvi_adv);
 	if (geom_scan_frame == NULL) {
 #endif
 	    oldinfo = currinf;
@@ -3037,7 +3498,7 @@ text_do_char(FILE *fp, struct scan_info 
 	    currinf = oldinfo;
 	    maxchar = oldmaxchar;
 #ifdef TEXXET
-	    DVI_H = dvi_h_sav;
+	    POP_POSITION;
 	}
 #endif
 	return DIR * m->dvi_adv;
@@ -3049,6 +3510,11 @@ text_do_char(FILE *fp, struct scan_info 
     return 0;
 }
 
+#define xmoveH(dir,dx)   \
+	do { moveH(dir,dx); PXL_V = xpixel_conv(DVI_V); } while(0)
+#define xmoveV(dir,dy)   \
+	do { moveV(dir,dy); PXL_V = xpixel_conv(DVI_V); } while(0)
+
 /*
  *	Handle a character in geometric scanning routine.
  */
@@ -3064,6 +3530,10 @@ geom_do_char(FILE *fp, struct scan_info 
 	    return 0;	/* error; we'll catch it later */
 	maxchar = currinf.fontp->maxchar;
 	currinf.set_char_p = currinf.fontp->set_char_p;
+#if FREETYPE
+        if (currinf.set_char_p == set_ft_char)
+	    do_load_freetype_font();
+#endif
     }
 
     if (currinf.set_char_p == set_empty_char)
@@ -3091,10 +3561,6 @@ geom_do_char(FILE *fp, struct scan_info 
 	}
 	maxchar = currinf.fontp->maxchar;
 	currinf.set_char_p = currinf.fontp->set_char_p;
-#if FREETYPE
-	if (currinf.set_char_p == set_ft_char)
-	    do_load_freetype_font();
-#endif
     }
 
     if (currinf.set_char_p == set_char) {
@@ -3122,27 +3588,58 @@ geom_do_char(FILE *fp, struct scan_info 
 	}
 #ifdef TEXXET
 	if (geom_scan_frame == NULL) {
-	    long dvi_h_sav = DVI_H;
-	    if (currinf.dir < 0)
-		DVI_H -= g->dvi_adv;
+	    DEFINE_POSITION_VAL;
+	    PUSH_POSITION;
+	    if (! TATE && currinf.dir < 0)
+		moveH(1, -g->dvi_adv);
 #endif
 	    x = G_PXL_H - g->x;
 	    y = PXL_V - g->y;
 	    g_info->geom_box(info, x, y,
 			     x + g->bitmap.w - 1, y + g->bitmap.h - 1);
+#ifdef TEXXET
+	    POP_POSITION;
+	}
+#endif
+	return DIR * g->dvi_adv;
+    }
+#ifdef PTEX
+    else if (currinf.set_char_p == set_char2) {
+	struct glyph *g;
+	long x, y;
+
+	g = currinf.fontp->kglyph[ch];
+	if (g == NULL || g->bitmap.bits == NULL) {
+	    (*currinf.fontp->read_char)(currinf.fontp, ch);
+	    g = currinf.fontp->kglyph[ch];
+	    free_bitmap2(g);
+	    g->tdir = currinf.fontp->dir;
+	}
 
 #ifdef TEXXET
-	    DVI_H = dvi_h_sav;
+	if (geom_scan_frame == NULL) {
+	    DEFINE_POSITION_VAL;
+	    PUSH_POSITION;
+	    if (! TATE && currinf.dir < 0)
+		moveH(1, -g->dvi_adv);
+#endif
+	    x = G_PXL_H - g->x;
+	    y = PXL_V - g->y;
+	    g_info->geom_box(info, x, y,
+			     x + g->bitmap.w - 1, y + g->bitmap.h - 1);
+#ifdef TEXXET
+	    POP_POSITION;
 	}
 #endif
 	return DIR * g->dvi_adv;
     }
+#endif /* PTEX */
     else if (currinf.set_char_p == set_vf_char) {
 	struct macro *m;
 	struct drawinf oldinfo;
 	wide_ubyte oldmaxchar;
 #ifdef TEXXET
-	long dvi_h_sav;
+	DEFINE_POSITION_VAL;
 #endif
 
 	if (ch > maxchar)
@@ -3150,9 +3647,9 @@ geom_do_char(FILE *fp, struct scan_info 
 	if ((m = &currinf.fontp->macro[ch])->pos == NULL)
 	    return 0;	/* catch the error later */
 #ifdef TEXXET
-	dvi_h_sav = DVI_H;
-	if (currinf.dir < 0)
-	    DVI_H -= m->dvi_adv;
+	PUSH_POSITION;
+	if (! TATE && currinf.dir < 0)
+	    moveH(1, -m->dvi_adv);
 	if (geom_scan_frame == NULL) {
 #endif
 	    oldinfo = currinf;
@@ -3168,7 +3665,7 @@ geom_do_char(FILE *fp, struct scan_info 
 	    currinf = oldinfo;
 	    maxchar = oldmaxchar;
 #ifdef TEXXET
-	    DVI_H = dvi_h_sav;
+	    POP_POSITION;
 	}
 #endif
 	return DIR * m->dvi_adv;
@@ -3188,21 +3685,35 @@ static void
 geom_do_rule(struct scan_info *info, long h, long w)
 {
     long x, y;
+    struct geom_info *g_info = info->data;
 #ifdef TEXXET
-    long dvi_h_save = DVI_H;
+    DEFINE_POSITION_VAL;
+    PUSH_POSITION;
 #endif
-    struct geom_info *g_info = info->data;
-    
+
+    if (bbox_rotated) {
+	fprintf(stderr, "geom_do_rotated_rule(h, w) is not implemented!\n");
+	return;
+    }
+    h = h * bbox_matrix[1][1];
+    w = w * bbox_matrix[0][0];
+
 #ifdef TEXXET
-    if (currinf.dir < 0)
-	DVI_H -= w - 1;
+    if (! TATE && currinf.dir < 0)
+	moveH(1, - w + 1);
 #endif
     x = G_PXL_H;
     y = PXL_V;
+#ifdef PTEX
+    if (TATE)
+	g_info->geom_box(info, x, y, x + xpixel_round(h) - 1,
+			 y + xpixel_round(w) - 1);
+    else
+#endif /* PTEX */
     g_info->geom_box(info, x, y - xpixel_round(h) + 1,
 		     x + xpixel_round(w) - 1, y);
 #ifdef TEXXET
-    DVI_H = dvi_h_save;
+    POP_POSITION;
 #endif
 }
 
@@ -3232,7 +3743,7 @@ geom_scan_part(long(*char_proc)(FILE *, 
     for (;;) {
 	ch = xone(fp);
 	if (ch <= (ubyte)(SETCHAR0 + 127))
-	    DVI_H += char_proc(fp, info, ch);
+	    xmoveH(1, char_proc(fp, info, ch));
 	else if (FNTNUM0 <= ch && ch <= (ubyte) (FNTNUM0 + 63)) {
 	    change_font((unsigned long)(ch - FNTNUM0));
 	}
@@ -3244,7 +3755,7 @@ geom_scan_part(long(*char_proc)(FILE *, 
 	    case PUT1:
 		a = char_proc(fp, info, xone(fp));
 		if (ch != PUT1)
-		    DVI_H += a;
+		    xmoveH(1, a);
 		break;
 
 	    case SET2:
@@ -3258,7 +3769,39 @@ geom_scan_part(long(*char_proc)(FILE *, 
 #else
 		    a = char_proc(fp, info, xnum(fp, 2));
 		    if (ch != PUT2)
-			DVI_H += a;
+			xmoveH(1, a);
+#endif
+		}
+		break;
+
+	    case SET3:
+	    case PUT3:
+		if (!resource.omega)
+		    dvi_fmt_error("%s:%d: draw_part: op-code %d only works with the \"-omega\" option",
+				  __FILE__, __LINE__, ch);
+		else {
+#ifdef TEXXET
+		    char_proc(fp, info, xnum(fp, 3));
+#else
+		    a = char_proc(fp, info, xnum(fp, 3));
+		    if (ch != PUT3)
+			xmoveH(1, a);
+#endif
+		}
+		break;
+
+	    case SET4:
+	    case PUT4:
+		if (!resource.omega)
+		    dvi_fmt_error("%s:%d: draw_part: op-code %d only works with the \"-omega\" option",
+				  __FILE__, __LINE__, ch);
+		else {
+#ifdef TEXXET
+		    char_proc(fp, info, xnum(fp, 4));
+#else
+		    a = char_proc(fp, info, xnum(fp, 4));
+		    if (ch != PUT4)
+			xmoveH(1, a);
 #endif
 		}
 		break;
@@ -3278,7 +3821,7 @@ geom_scan_part(long(*char_proc)(FILE *, 
 		    if (info->geom_special != NULL)
 			geom_do_rule(info, xspell_conv(a), b);
 		}
-		DVI_H += DIR * b;
+		moveH(DIR, b);
 		break;
 
 	    case PUTRULE:
@@ -3399,7 +3942,7 @@ geom_scan_part(long(*char_proc)(FILE *, 
 	    case RIGHT2:
 	    case RIGHT3:
 	    case RIGHT4:
-		DVI_H += DIR * xspell_conv(xsnum(fp, ch - RIGHT1 + 1));
+		xmoveH(DIR, xspell_conv(xsnum(fp, ch - RIGHT1 + 1)));
 		break;
 
 	    case W1:
@@ -3408,7 +3951,7 @@ geom_scan_part(long(*char_proc)(FILE *, 
 	    case W4:
 		WW = xspell_conv(xsnum(fp, ch - W0));
 	    case W0:
-		DVI_H += DIR * WW;
+		xmoveH(DIR, WW);
 		break;
 
 	    case X1:
@@ -3417,15 +3960,14 @@ geom_scan_part(long(*char_proc)(FILE *, 
 	    case X4:
 		XX = xspell_conv(xsnum(fp, ch - X0));
 	    case X0:
-		DVI_H += DIR * XX;
+		xmoveH(DIR, XX);
 		break;
 
 	    case DOWN1:
 	    case DOWN2:
 	    case DOWN3:
 	    case DOWN4:
-		DVI_V += xspell_conv(xsnum(fp, ch - DOWN1 + 1));
-		PXL_V = xpixel_conv(DVI_V);
+		xmoveV(1, xspell_conv(xsnum(fp, ch - DOWN1 + 1)));
 		break;
 
 	    case Y1:
@@ -3434,8 +3976,7 @@ geom_scan_part(long(*char_proc)(FILE *, 
 	    case Y4:
 		YY = xspell_conv(xsnum(fp, ch - Y0));
 	    case Y0:
-		DVI_V += YY;
-		PXL_V = xpixel_conv(DVI_V);
+		xmoveV(1, YY);
 		break;
 
 	    case Z1:
@@ -3444,8 +3985,7 @@ geom_scan_part(long(*char_proc)(FILE *, 
 	    case Z4:
 		ZZ = xspell_conv(xsnum(fp, ch - Z0));
 	    case Z0:
-		DVI_V += ZZ;
-		PXL_V = xpixel_conv(DVI_V);
+		xmoveV(1, ZZ);
 		break;
 
 	    case FNT1:
@@ -3482,6 +4022,12 @@ geom_scan_part(long(*char_proc)(FILE *, 
 		xskip(fp, a + (long)xone(fp));
 		break;
 
+#ifdef PTEX
+	    case TDIR:
+		TATE = xone(fp);
+		break;
+#endif /* PTEX */
+
 #ifndef TEXXET
 	    case SREFL:
 	    case EREFL:
--- texk/xdvik/dvi-draw.h.orig	2013-04-05 00:14:54 UTC
+++ texk/xdvik/dvi-draw.h
@@ -82,6 +82,11 @@ extern void src_parse(const char *str, i
 #define XX      currinf.data.x
 #define YY      currinf.data.y
 #define ZZ      currinf.data.z
+#ifdef PTEX
+#define TATE    currinf.data.tdir
+#else /* !PTEX */
+#define TATE    False
+#endif /* !PTEX */
 
 extern void draw_page(void);
 extern void source_reverse_search(int, int, wide_bool);
@@ -120,6 +125,13 @@ extern setcharRetvalT set_char(
 			       wide_ubyte cmd,
 #endif
 			       wide_ubyte ch);
+#ifdef PTEX
+extern setcharRetvalT set_char2(
+#ifdef TEXXET
+				wide_ubyte cmd,
+#endif
+				wide_ubyte ch);
+#endif /* PTEX */
 extern setcharRetvalT load_n_set_char(
 #ifdef TEXXET
 				      wide_ubyte cmd,
--- texk/xdvik/dvi-init.c.orig	2013-04-05 00:14:54 UTC
+++ texk/xdvik/dvi-init.c
@@ -31,6 +31,10 @@ in xdvi.c.
 
 #include "dvi-init.h"
 #include "dvi-draw.h"
+#ifdef PTEX
+#include "ptexvf.h"
+#include "ptexmap.h"
+#endif
 #include "util.h"
 #include "x_util.h"
 #include "exit-handlers.h"
@@ -53,6 +57,9 @@ in xdvi.c.
 #include "statusline.h"
 #include "events.h"
 #include "font-open.h"
+#ifdef HAVE_LIBPAPER
+#include <paper.h>
+#endif
 
 #if FREETYPE
 # include FT_SIZES_H
@@ -67,6 +74,10 @@ in xdvi.c.
 #define	VF_PRE		247
 #define	VF_ID_BYTE	202
 #define	VF_MAGIC	((VF_PRE << 8) | VF_ID_BYTE)
+#ifdef PTEX
+#define	JFMS_MAGIC	11
+#define	JFMS_TATEMAGIC	9
+#endif /* PTEX */
 
 /* font stuff */
 struct font *tn_table[TNTABLELEN];
@@ -170,8 +181,22 @@ static void
 delete_glyphs(struct font *fontp)
 {
     struct glyph *g;
+#ifdef PTEX
+    int n, maxchar;
 
+    maxchar = fontp->maxchar + 1;
+    for (n = 0; n < maxchar; ++n) {
+	g = (fontp->flags & FONT_KANJI) ? fontp->kglyph[n] : &fontp->glyph[n];
+	if (g == NULL) continue;
+#else /* !PTEX */
     for (g = fontp->glyph; g <= fontp->glyph + fontp->maxchar; ++g) {
+#endif /* !PTEX */
+	free_bitmap2(g);
+    }
+}
+
+void free_bitmap2(struct glyph *g) {
+    {
 	if (g->bitmap2.bits) {
 	    free(g->bitmap2.bits);
 	    g->bitmap2.bits = NULL;
@@ -283,7 +308,23 @@ free_unused_fonts(void)
 		}
 		else {
 		    delete_glyphs(fontp);
+#ifdef PTEX
+		    if (fontp->flags & FONT_KANJI) {
+			int n;
+			for (n = 0; n < (int)fontp->maxchar + 1; ++n) {
+			    if (fontp->kglyph[n] != NULL) {
+				free(fontp->kglyph[n]);
+			    }
+			}
+			free(fontp->kglyph);
+		    }
+		    else {
+#endif /* PTEX */
 		    free((char *)fontp->glyph);
+		    fontp->glyph = NULL;
+#ifdef PTEX
+		    }
+#endif /* PTEX */
 		}
 		free((char *)fontp);
 	    }
@@ -324,7 +365,11 @@ reset_colors(void)
 	struct glyph *g;
 
 	for (f = font_head; f != NULL; f = f->next)
-	    if ((f->flags & FONT_LOADED) && !(f->flags & FONT_VIRTUAL))
+	    if ((f->flags & FONT_LOADED) && !(f->flags & FONT_VIRTUAL)
+#ifdef PTEX
+		&& !(f->flags & FONT_KANJI)
+#endif /* PTEX */
+		)
 		for (g = f->glyph; g <= f->glyph + f->maxchar; ++g)
 		    g->fg = NULL;
     }
@@ -447,6 +492,10 @@ load_font(struct font *fontp
      * appear before the main window comes up ...
      */
 
+#ifdef PTEX
+    fontp->dir = 0;
+#endif /* PTEX */
+
     fontp->file = font_open(
 #if DELAYED_MKTEXPK
 			    load_font_now,
@@ -511,6 +560,12 @@ load_font(struct font *fontp
     fontp->fsize = size_found;
     fontp->timestamp = ++current_timestamp;
     fontp->maxchar = maxchar = 255;
+#ifdef PTEX
+    if (iskanjifont(fontp->fontname)) {
+	fontp->flags |= FONT_KANJI;
+	fontp->set_char_p = set_char2;
+    } else
+#endif /* PTEX */
     fontp->set_char_p = set_char;
     magic = get_bytes(fontp->file, 2);
 
@@ -529,6 +584,13 @@ load_font(struct font *fontp
 	else
 	    (void)read_VF_index(fontp, (wide_bool)hushcs);
 	break;
+#ifdef PTEX
+    case JFMS_MAGIC:
+    case JFMS_TATEMAGIC:
+	fontp->dir = (magic == JFMS_TATEMAGIC);
+	read_PTEXVF_index(fontp);
+	return True;
+#endif /* PTEX */
     default:
 	XDVI_FATAL((stderr, "Cannot recognize format for font file %s",
 	  fontp->filename));
@@ -783,7 +845,13 @@ process_preamble(FILE *fp, dviErrFlagT *
 	TRACE_FILES((stderr, "process_preamble: fp = %p, errflag = %d, returning False", (void *)fp, *errflag));
 	return False;
     }
-    if (get_byte(fp) != 2) {
+#ifdef PTEX
+    k = get_byte(fp);
+    if (k != 2 && k != 3)
+#else /* !PTEX */
+    if (get_byte(fp) != 2)
+#endif /* !PTEX */
+    {
 	*errflag = WRONG_DVI_VERSION;
 	TRACE_FILES((stderr, "process_preamble: fp = %p, errflag = %d, returning False", (void *)fp, *errflag));
 	return False;
@@ -845,7 +913,12 @@ find_postamble(FILE *fp, dviErrFlagT *er
 	fseek(fp, --pos, SEEK_SET);
 	byte = get_byte(fp);
     }
-    if (byte != 2) {
+#ifdef PTEX
+    if (byte != 2 && byte != 3)
+#else /* !PTEX */
+    if (byte != 2)
+#endif /* !PTEX */
+    {
 	*errflag = WRONG_DVI_VERSION;
 	TRACE_FILES((stderr, "find_postamble: returning FALSE"));
 	return False;
@@ -865,9 +938,14 @@ set_paper_type(const char *arg)
     char temp[21];
     const char **p;
     char *q;
+#ifdef HAVE_LIBPAPER
+    const struct paper *pp;
+    int landscape = 0;
+#else
     const char **paper_types = get_paper_types();
     size_t paper_types_size = get_paper_types_size();
-    
+#endif
+
     if (*arg == '+') {
 	++arg;
 	ignore_papersize_specials = True;
@@ -884,6 +962,57 @@ set_paper_type(const char *arg)
 	    break;
     }
     arg = temp;
+#ifdef HAVE_LIBPAPER
+    paperinit();
+    if (strcmp(temp, "libpaper") == 0) {
+	const char *name;
+
+	name = systempapername();
+	if (name == NULL)
+		name = defaultpapername();
+	if (strcmp(name, "libpaper") == 0)
+		name = "a4";
+
+	strncpy(temp, name, sizeof(temp));
+	temp[sizeof(temp) - 1] = '\0';
+    }
+    if (strcmp(temp, "letter") != 0 &&
+	strcmp(temp, "ledger") != 0) {
+	if (temp[strlen(temp) - 1] == 'r') {
+		temp[strlen(temp) - 1] = '\0';
+		landscape = 1;
+	}
+    }
+    for (pp = paperfirst(); pp; pp = papernext(pp)) {
+	if (strcmp(temp, papername(pp)) == 0) {
+		double w, h;
+		char wstr[256];
+		char hstr[256];
+		
+		if (landscape == 0) {
+			w = paperpswidth(pp);
+			h = paperpsheight(pp);
+		} else {
+			h = paperpswidth(pp);
+			w = paperpsheight(pp);
+		}
+		w = w / 72.0 * 10 * 2.54;
+		h = h / 72.0 * 10 * 2.54;
+		snprintf(wstr, sizeof(wstr), "%f mm", w);
+		snprintf(hstr, sizeof(hstr), "%f mm", h);
+		wstr[sizeof(wstr) - 1] = '\0';
+		hstr[sizeof(hstr) - 1] = '\0';
+		m_paper_unshrunk_w = atopix(wstr, False);
+		m_paper_unshrunk_h = atopix(hstr, False);
+    		globals.grid_paper_unit = atopixunit("mm");
+
+		break;
+	}
+    }
+    paperdone();
+    if (pp == NULL)
+	return (False);
+#else
     /* perform substitutions */
     for (p = paper_types; p < paper_types + paper_types_size; p += 2) {
 	if (strcmp(temp, *p) == 0) {
@@ -898,6 +1027,7 @@ set_paper_type(const char *arg)
     m_paper_unshrunk_h = atopix(arg1 + 1, False);
 
     globals.grid_paper_unit = atopixunit(arg);
+#endif
     
     return (m_paper_unshrunk_w != 0 && m_paper_unshrunk_h != 0);
 }
--- texk/xdvik/dvi-init.h.orig	2013-03-31 05:28:20 UTC
+++ texk/xdvik/dvi-init.h
@@ -100,6 +100,12 @@ struct glyph {
     char *pixmap2_gc2;	    /* separate image data for drawing image to globals.gc.fore2 */
 #endif /* GREY */
     struct bitmap bitmap2;  /* shrunken bitmap for character */
+#ifdef PTEX
+    int     tdir;
+#endif /* PTEX */
+    short x3, y3;		/* x and y offset in pixels (backup) */
+    struct bitmap bitmap3;	/* bitmap for character (backup) */
+    float matrix[2][2];
 };
 
 /*
@@ -131,6 +137,9 @@ struct macro {
 #define	FONT_IN_USE	1	/* used for housekeeping */
 #define	FONT_LOADED	2	/* if font file has been read */
 #define	FONT_VIRTUAL	4	/* if font is virtual */
+#ifdef PTEX
+#define	FONT_KANJI	8	/* if font is kanji */
+#endif
 
 /* forward declarations */
 struct font;
@@ -156,6 +165,11 @@ struct font {
     struct glyph *glyph;
     /* these fields are used by (loaded) virtual fonts */
     struct font **vf_table;	/* list of fonts used by this vf */
+#ifdef PTEX
+    struct glyph **kglyph;
+    int ft2_index;
+    int dir;
+#endif /* PTEX */
     struct tn *vf_chain;	/* ditto, if TeXnumber >= VFTABLELEN */
     struct font *first_font;	/* first font defined */
     struct macro *macro;
@@ -175,6 +189,7 @@ struct tn {
 };
 
 
+extern void free_bitmap2(struct glyph *g);
 extern void reset_fonts(void);
 #if COLOR
 extern void reset_colors(void);
--- texk/xdvik/dvi.h.orig	2001-04-18 14:24:42 UTC
+++ texk/xdvik/dvi.h
@@ -5,9 +5,13 @@
 #define	SETCHAR0	0
 #define	SET1		128
 #define	SET2		129
+#define	SET3		130
+#define	SET4		131
 #define	SETRULE		132
 #define	PUT1		133
 #define	PUT2		134
+#define	PUT3		135
+#define	PUT4		136
 #define	PUTRULE		137
 #define	NOP		138
 #define	BOP		139
@@ -61,4 +65,8 @@
 #define	SREFL		250
 #define	EREFL		251
 
+#ifdef PTEX
+#define TDIR            255
+#endif  /* PTEX */
+
 #define	TRAILER		223	/* Trailing bytes at end of file */
--- texk/xdvik/dvisel.c.orig	2008-02-11 22:47:58 UTC
+++ texk/xdvik/dvisel.c
@@ -28,6 +28,7 @@
 #include <string.h>
 #include <ctype.h>
 
+#include "xdvi-config.h"
 #include "dvi.h"
 #include "pagesel.h"
 #include "dvisel.h"
@@ -510,6 +511,12 @@ WriteDVI(FILE *fin, FILE *fout, long *fo
 	    n += 4;
 	    /* fall through */
 	    
+	case SET4:
+	case PUT4: 
+	    if (!resource.omega) {
+		dvi_fmt_error("%s:%d: WriteDVI: op-code %d only works with the \"-omega\" option",
+			      __FILE__, __LINE__, c);
+	    }
 	case RIGHT4:
 	case W4:
 	case X4:
@@ -519,6 +526,12 @@ WriteDVI(FILE *fin, FILE *fout, long *fo
 	    n++;
 	    /* fall through */
 
+	case SET3:
+	case PUT3: 
+	    if (!resource.omega) {
+		dvi_fmt_error("%s:%d: WriteDVI: op-code %d only works with the \"-omega\" option",
+			      __FILE__, __LINE__, c);
+	    }
 	case RIGHT3:
 	case W3:
 	case X3:
--- texk/xdvik/encodings.c.orig	2013-03-31 05:28:20 UTC
+++ texk/xdvik/encodings.c
@@ -69,10 +69,18 @@ OTHER DEALINGS IN THE SOFTWARE.
 #if HAVE_ICONV_H
 # include <iconv.h>
 static iconv_t m_iconv_gb_ucs4 = (iconv_t)(-1);
+static iconv_t m_iconv_jis_ucs4 = (iconv_t)(-1);
 #endif /* HAVE_ICONV_H */
 
 #include <ctype.h>
 
+#ifdef PTEX
+#include "ptexmap.h"
+#if HAVE_PTEXENC
+#include <ptexenc/unicode-jp.h>
+#include <ptexenc/ptexenc.h>
+#endif
+#endif
 #include "util.h"
 #include "encodings.h"
 #include "my-snprintf.h"
@@ -3021,8 +3029,74 @@ close_iconv(void *dummy)
 	iconv_close(m_iconv_gb_ucs4);
 	m_iconv_gb_ucs4 = (iconv_t)(-1);
     }
+    if (m_iconv_jis_ucs4 != (iconv_t)(-1)) {
+	iconv_close(m_iconv_jis_ucs4);
+	m_iconv_jis_ucs4 = (iconv_t)(-1);
+    }
+#endif /* HAVE_ICONV_H */
+}
+
+#ifdef PTEX
+/* convert a JIS char to unicode (UCS-4) using iconv() */
+uint32_t
+jis2unicode(wide_ubyte jis)
+{
+#if HAVE_ICONV_H
+    uint32_t u = 0;
+    unsigned char jis_seq[8] = { 
+	0x1b, 0x24, 0x42, /* JIS X 0208-1983 */
+	(unsigned char)(jis >> 8), (unsigned char)jis,
+	0x1b, 0x28, 0x42, /* ASCII */
+    };
+    unsigned char unicode[4];
+    size_t from = sizeof jis_seq;
+    size_t to = sizeof unicode;
+    static Boolean initialized = False;
+    char *from_ptr = (char *)jis_seq;
+    char *to_ptr = (char *)unicode;
+
+    if (m_iconv_jis_ucs4 == (iconv_t)(-1)) {
+	if (initialized)
+	    return 0;
+	initialized = True;
+	m_iconv_jis_ucs4 = iconv_open(
+#ifdef WORDS_BIGENDIAN
+				     "UCS-4BE",
+#else
+				     "UCS-4LE",
+#endif
+				     "ISO-2022-JP");
+	if (m_iconv_jis_ucs4 == (iconv_t)(-1)) {
+	    XDVI_ERROR((stderr, "jis2unicode: iconv_open() failed: %s", strerror(errno)));
+	    return 0;
+	}
+    }
+    if (iconv(m_iconv_jis_ucs4, (iconv_char_pptrT)&from_ptr, &from, &to_ptr, &to) == (size_t)(-1)) {
+	XDVI_ERROR((stderr, "jis2unicode: can't convert JIS to unicode: %s", strerror(errno)));
+	return 0;
+    }
+    memcpy(&u, unicode, sizeof unicode);
+    return u;
+#elif HAVE_PTEXENC
+    uint32_t u = 0;
+    u = JIStoUCS2(jis);
+    if (u == 0) {
+	XDVI_ERROR((stderr, "jis2unicode: can't convert JIS (%04x) to unicode in ptexenc library", jis));
+    }
+    return u;
+#else /* !HAVE_ICONV_H && !HAVE_PTEXENC */
+    static Boolean warned = False;
+
+    if (!warned) {
+        popup_message(globals.widgets.top_level,
+                      MSG_WARN, NULL, "This version of xdvi has been compiled without iconv support - "
+                      "cannot convert Kanji character to UTF-8");
+        warned = True;
+    }
+    return 0;
 #endif /* HAVE_ICONV_H */
 }
+#endif /* PTEX */
 
 /* convert a CJK char to unicode (UCS-4) using iconv() */
 static uint32_t
@@ -3577,6 +3651,24 @@ guess_encoding(wide_ubyte ch, const char
     
     TRACE_FIND_VERBOSE((stderr, "guess_encoding: |%s|, char 0x%.4X", fontname, ch));
 
+#ifdef PTEX
+    if (iskanjifont(fontname)) {
+	struct ptexmap *map = getkanjifont(fontname);
+	switch (map->encoding) {
+	case ENC_JIS_H:
+	case ENC_JIS_V:
+	    TRACE_FIND_VERBOSE((stderr, "guess_encoding: Kanji fonts (JIS encoding)"));
+	    return jis2unicode(ch);
+	case ENC_UNICODE_H:
+	case ENC_UNICODE_V:
+	    TRACE_FIND_VERBOSE((stderr, "guess_encoding: Kanji fonts (Unicode encoding)"));
+	    return ch;
+	default:
+	    TRACE_FIND_VERBOSE((stderr, "guess_encoding: Kanji fonts (Unsupported encoding)"));
+	    return '?';
+	}
+    }
+#endif  /* PTEX */
     /* our encoding vectors only have size 256 */
     if (ch > 255) {
 	XDVI_WARNING((stderr, "guess_encoding: font index %lu too large", (unsigned long)ch));
--- texk/xdvik/encodings.h.orig	2004-11-01 23:15:22 UTC
+++ texk/xdvik/encodings.h
@@ -53,5 +53,7 @@ extern int str_iso_8859_1_to_utf8(const 
 extern Boolean is_hyphenchar(uint32_t unicode);
 extern Boolean is_ideograph(uint32_t unicode);
 
+extern uint32_t jis2unicode(wide_ubyte jis);
+
 #endif /* ENCODINGS_H_ */
 
--- texk/xdvik/font-open.c.orig	2013-05-14 05:26:19 UTC
+++ texk/xdvik/font-open.c
@@ -27,6 +27,9 @@
 #include "xdvi-config.h"
 #include "xdvi.h"
 #include "dvi-draw.h"
+#ifdef PTEX
+#include "ptexmap.h"
+#endif
 #include "util.h"
 #include "events.h"
 #include "dvi-init.h"
@@ -213,6 +216,38 @@ getdefaults(FILE *f)
 		p_node->value = xmemdup(p, len + 1);
 		*p_tail = p_node;
 		p_tail = &p_node->next;
+	    } else if (*p == 'x') {
+		char *name;
+
+		name = NULL;
+		do ++p;
+		while (*p == ' ' || *p == '\t');
+
+		if (*p == '+')
+		    do ++p;
+		    while (*p == ' ' || *p == '\t');
+
+		name = strtok(p, " \t");
+		if (name == NULL) {
+		    XDVI_WARNING((stderr, "Syntax error in entry \"%s\" "
+			"(ignored)", ffline));
+		    continue;
+		}
+		read_ptexmap_file(name);
+	    } else if (*p == 'r') {
+		char *name, *ptr;
+
+		name = ptr = NULL;
+		do ++p;
+		while (*p == ' ' || *p == '\t');
+		name = strtok(p, " \t");
+		if ((name == NULL) ||
+		    (ptr  = strtok(NULL, " \t")) == NULL) {
+		    XDVI_WARNING((stderr, "Syntax error in entry \"%s\" "
+			"(ignored)", ffline));
+		    continue;
+		}
+		add_replace_dictionary(name, ptr);
 	    }
 	}
 
@@ -446,13 +481,38 @@ init_t1_lookup(void)
 		TRACE_FT((stderr, "Encoding[%d]: '%s' = '%s' -> '%s'",
 		  i, enc, name, ptr));
 #  endif
+#ifdef PTEX
+	    }
+	    else if (strcmp(keyword, "ptexmap") == 0) {
+		if ((ptr = strtok(NULL, delim)) == NULL) {
+		    XDVI_WARNING((stderr,
+			    "Syntax error in entry \"%s\" (skipping line)",
+			    ffline));
+		    continue;
+		}
+		read_ptexmap_file(ptr);
+	    }
+	    else if (strcmp(keyword, "replace") == 0) {
+		if ((name = strtok(NULL, delim)) == NULL ||
+		    (ptr  = strtok(NULL, delim)) == NULL) {
+		    XDVI_WARNING((stderr,
+			    "Syntax error in entry \"%s\" (skipping line)",
+			    ffline));
+		    continue;
+		}
+		add_replace_dictionary(name, ptr);
+#endif
 	    } else {
 		/* again, nag them with a popup so that they'll do something
 		   about this ... */
 		popup_message(globals.widgets.top_level,
 			  MSG_ERR,
 			  "Please check the syntax of your config file.  "
+#ifdef PTEX
+			  "Valid keywords are: \"enc\", \"dvipsmap\", \"ptexmap\" and \"replace\".",
+#else
 			  "Valid keywords are: \"enc\" and \"dvipsmap\".",
+#endif
 			  "Skipping unknown keyword \"%s\" in config file %s.",
 			  keyword, filename);
 	    }
@@ -1103,7 +1163,7 @@ process_gs_fontmap(FILE *f)
 	    if (ttype == GS_EOF || ttype == GS_ERR)
 		break;
 	    if (ttype == LPAREN) {
-		Boolean	quiet = False;
+	        Boolean quiet = False;
 		FILE	*f1;
 
 		ttype = get_gs_token(&gsf, pos1, &pos2, "Fontmap");
@@ -1692,7 +1752,7 @@ font_open(
 	  const char **font_ret,
 	  int *dpi_ret)
 {
-    char *name;
+    char *name = NULL;
     kpse_glyph_file_type file_ret;
 #if DELAYED_MKTEXPK
     Boolean message_done = False;
@@ -1706,6 +1766,12 @@ font_open(
     fontp->filename = NULL;
     *dpi_ret = fontp->fsize;
 
+#ifdef PTEX
+     /* for kanji, first try jfm's, then 8-bit vf's (not 16bit ovf's). */
+    if (iskanjifont(fontp->fontname))
+	name = kpse_find_tfm(fontp->fontname);
+    else
+#endif /* PTEX */
     if (resource.omega) { /* for omega, first try 16-bit ovf's, then 8-bit vf's. */
 	name = kpse_find_ovf(fontp->fontname);
 	if (name == NULL)
--- texk/xdvik/fontconfig.c.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/fontconfig.c
@@ -0,0 +1,92 @@
+#include "xdvi-config.h"
+#include "xdvi.h"
+#include <stdio.h>
+#include "util.h"
+#include "string-utils.h"
+
+#ifdef	PTEX
+#include "kpathsea/tex-file.h"
+
+#if	HAVE_FONTCONFIG
+#include <fontconfig/fontconfig.h>
+
+char *fc_match(char *name)
+{
+    FcFontSet   *fs;
+    FcPattern   *pat;
+    FcResult    result;
+    FcPattern   *match;
+    char        *ret = NULL;
+    static int inited = false;
+
+    if (!inited) {
+        if (FcInit() == 0) {
+            XDVI_WARNING((stderr, "fontconfig: Can't init library.\n"));
+            return NULL;
+        }
+        inited = true;
+    }
+
+    pat = FcNameParse((FcChar8 *)name);
+    FcConfigSubstitute(0, pat, FcMatchPattern);
+    FcDefaultSubstitute(pat);
+    fs = FcFontSetCreate();
+    match = FcFontMatch(0, pat, &result);
+    if (match != NULL) FcFontSetAdd(fs, match);
+    if (pat != NULL) FcPatternDestroy(pat);
+
+    if (fs != NULL) {
+        if (fs->nfont > 0) {
+            FcChar8   *file;
+            if (FcPatternGetString(fs->fonts[0], FC_FILE, 0, &file)
+                == FcResultMatch) {
+                ret = strdup(file);
+            }
+        }
+        FcFontSetDestroy(fs);
+    }
+    if (kpathsea_debug) {
+        fprintf(stderr, "fontconfig:fc_match(%s) => %s\n", name, ret);
+    }
+    return ret;
+}
+
+char *fc_convert(char *name) {
+    char *tmp, *s;
+
+    if (str_is_suffix(".otf", name, false)) return NULL;
+    if (str_is_suffix(".ttf", name, false)) return NULL;
+    if (str_is_suffix(".ttc", name, false)) return NULL;
+    tmp = strdup(name);
+    s = strstr(tmp, "-Light");   if (s != NULL) *s = '\0';
+    s = strstr(tmp, "-Medium");  if (s != NULL) *s = '\0';
+    s = strstr(tmp, "-Regular"); if (s != NULL) *s = '\0';
+    s = fc_match(tmp);
+    free(tmp);
+    return s;
+}
+#endif	/* HAVE_FONTCONFIG */
+
+
+const char *get_ptex_font_pathname(char *name)
+{
+    char *s = NULL;
+    FILE *fp;
+
+    if ((fp=XFOPEN(name, "r")) != NULL) {
+	fclose(fp);
+	s = name;
+    }
+
+    if (s == NULL) s = kpse_find_file(name, kpse_opentype_format, true);
+    if (s == NULL) s = kpse_find_file(name, kpse_truetype_format, true);
+    if (s == NULL) s = kpse_find_file(name, kpse_miscfonts_format, true);
+    if (s == NULL) s = kpse_find_file(name, kpse_program_text_format, true);
+#if	HAVE_FONTCONFIG
+    if (s == NULL) s = fc_convert(name);
+#endif	/* HAVE_FONTCONFIG */
+    if (s == NULL) s = name;
+    return s;
+}
+
+#endif	/* PTEX */
--- texk/xdvik/fontconfig.h.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/fontconfig.h
@@ -0,0 +1,11 @@
+
+#ifndef FONTCONFIG_H_
+#define FONTCONFIG_H_
+
+#ifdef	PTEX
+
+char *get_ptex_font_pathname(char *name);
+
+#endif /* PTEX */
+
+#endif /* FONTCONFIG_H_ */
--- texk/xdvik/ft2.c.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ft2.c
@@ -0,0 +1,285 @@
+/*========================================================================*\
+
+Copyright (C) 2002-2013 The Xdvik-jp project http://xdvi.sourceforge.jp/
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to
+deal in the Software without restriction, including without limitation the
+rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+sell copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
+THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES
+OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
+ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
+OTHER DEALINGS IN THE SOFTWARE.
+
+NOTE:
+This module is based on prior work, as noted in the modification history
+in README.xdvik-jp and changelog.
+
+\*========================================================================*/
+
+#include "xdvi-config.h"
+#include "xdvi.h"
+#include <stdio.h>
+#include <stdlib.h>
+
+#ifdef	PTEX
+#include <ft2build.h>
+#include FT_FREETYPE_H
+#include FT_SYNTHESIS_H
+
+#include "kpathsea/tex-file.h"
+#include "ft2.h"
+#include "dvi-init.h"
+#include "util.h"
+#include "ptexmap.h"
+#include "ft2vert.h"
+#include "fontconfig.h"
+#include "encodings.h"
+#include "AJ16.c"
+
+static struct jisv_st {
+    int low, hi;
+} jisv[] = {
+    /* converted from CMap 'V' */
+    /* sed -e '/^</!d' -e 's|<\(....\)> <\(....\)>.*|  { 0x\1, 0x\2 },|' < V */
+    { 0x2122, 0x2123 },
+    { 0x2131, 0x2132 },
+    { 0x213c, 0x213e },
+    { 0x2141, 0x2145 },
+    { 0x214a, 0x215b },
+    { 0x2161, 0x2161 },
+    { 0x2421, 0x2421 },
+    { 0x2423, 0x2423 },
+    { 0x2425, 0x2425 },
+    { 0x2427, 0x2427 },
+    { 0x2429, 0x2429 },
+    { 0x2443, 0x2443 },
+    { 0x2463, 0x2463 },
+    { 0x2465, 0x2465 },
+    { 0x2467, 0x2467 },
+    { 0x246e, 0x246e },
+    { 0x2521, 0x2521 },
+    { 0x2523, 0x2523 },
+    { 0x2525, 0x2525 },
+    { 0x2527, 0x2527 },
+    { 0x2529, 0x2529 },
+    { 0x2543, 0x2543 },
+    { 0x2563, 0x2563 },
+    { 0x2565, 0x2565 },
+    { 0x2567, 0x2567 },
+    { 0x256e, 0x256e },
+    { 0x2575, 0x2576 },
+};
+
+Boolean is_jis_vertical(int jis)
+{
+    size_t l,r,m;
+
+    l=0; r=sizeof(jisv)/sizeof(*jisv)-1;
+    while (l<r) {
+	m=(l+r)/2;
+	if   (jisv[m].hi < jis) l=m+1;
+	else r=m;
+    }
+    if (jisv[l].low <= jis && jis <= jisv[l].hi) return True;
+    return False;
+}
+
+static FT_Library  library = NULL;
+
+static int ft_fonts_num = 0;
+static int ft_fonts_max = 0;
+static struct ft_font {
+    FT_Face face;
+    short   height;
+    short   width;
+    short   ascend;
+    int     encoding;
+    Boolean bold;
+    struct ft2vert_st *ft2vert;
+} *ft_fonts;
+
+static void ft2_init(void)
+{
+    int ft_error = FT_Init_FreeType( &library );
+    if (ft_error != 0) {
+	XDVI_WARNING(( stderr, "FreeType2: Initialization error.\n" ));
+	exit(100);
+    }
+}
+
+int ft2_open_font(struct ptexmap *map)
+{
+    int ft_error;
+    char *fontpath = get_ptex_font_pathname(map->font_filename);
+    struct ft_font *font;
+
+    if (library == NULL) ft2_init();
+    if (map->ft2_index >= 0) {  /* already opened */
+	return map->ft2_index;
+    }
+
+    if (ft_fonts_num == ft_fonts_max) {
+	if (ft_fonts_max == 0) ft_fonts_max = 8;
+	else                   ft_fonts_max *= 2;
+	ft_fonts = xrealloc(ft_fonts, sizeof(ft_fonts[0]) * ft_fonts_max);
+    }
+    font = &ft_fonts[ft_fonts_num];
+
+    memset(font, 0, sizeof(*font));
+    ft_error = FT_New_Face(library, fontpath, map->face_index, &font->face);
+    free(fontpath);
+    if (ft_error != 0) {
+	XDVI_WARNING(( stderr, "FreeType2: Open Font Error (%s).  "
+		       "Error code = %d \n", fontpath, ft_error ));
+    } else {
+	font->encoding = map->encoding;
+	if (map->encoding == ENC_JIS_V || map->encoding == ENC_UNICODE_V) {
+	    font->ft2vert = ft2vert_init(font->face);
+	}
+	font->bold = (map->variant & VAR_BOLD);
+	if (map->variant & VAR_ITALIC) map->slant = 0.3;
+	if (map->extend != 1.0 || map->slant != 0.0) {
+	    /* for debug (attention upper if condition) */
+	    /* FT_Vector vector = { 30 * (1<<6), -30 * (1<<6) }; */
+
+	    /* t1_modify_fm() in tetex-src-3.0/texk/dvipsk/writet1.c */
+	    FT_Matrix matrix;
+	    matrix.xx = (int)(map->extend * (1<<16));
+	    matrix.xy = (int)(map->extend * map->slant * (1<<16));
+	    matrix.yx = 0;
+	    matrix.yy = 1<<16;
+	    FT_Set_Transform( font->face, &matrix, 0 );
+	    /* TODO: vertical font */
+	}
+    }
+    return (map->ft2_index = ft_fonts_num++);
+}
+
+static FT_UInt glyph_index(const int char_code, struct ft_font *font)
+{
+    FT_UInt i = char_code;  /* JIS or UNICODE or GID */
+
+    if (font->encoding == ENC_JIS_H || font->encoding == ENC_JIS_V) {
+	i = jis2unicode(i);
+    }
+    else if (font->encoding == ENC_AJ16_H || font->encoding == ENC_AJ16_V) {
+	i = AJ162uni(i);
+    }
+    if (font->encoding != ENC_IDENTITY) { /* unicode -> gid */
+	i = FT_Get_Char_Index(font->face, i);
+    }
+    if ((font->encoding == ENC_JIS_V && is_jis_vertical(char_code)) ||
+	font->encoding == ENC_UNICODE_V || font->encoding == ENC_AJ16_V) {
+      if (font->ft2vert != NULL) i = ft2vert_get_gid(font->ft2vert, i);
+    }
+    return i;
+}
+
+static void glyph_to_bitmap(struct bitmap *bm, FT_GlyphSlot g, int ascend)
+{
+    int x, xmax, xshift;
+    int y, ymax, yoffset;
+    unsigned char *src, *dst;
+
+    dst  = bm->bits;
+    src  = g->bitmap.buffer;
+    xmax = g->bitmap.pitch;
+    ymax = g->bitmap.rows;
+
+    if ( g->bitmap_left >= 0 ) {  /* to right */
+	if ( g->bitmap_left % 8 != 0 ) xmax++;
+	if ( xmax > bm->bytes_wide - g->bitmap_left/8 ) {
+	    xmax = bm->bytes_wide - g->bitmap_left/8;
+	}
+	dst   += g->bitmap_left / 8;
+	xshift = g->bitmap_left % 8;
+    } else { /* to left */
+	xmax  -=   (-g->bitmap_left) / 8;
+	src   +=   (-g->bitmap_left) / 8;
+	xshift = -((-g->bitmap_left) % 8);
+	if ( xmax > bm->bytes_wide ) xmax = bm->bytes_wide;
+    } /* We love plus % plus, we hate minus % plus. */
+    assert( xmax <= bm->bytes_wide );
+
+    yoffset = ascend - g->bitmap_top;
+    if ( yoffset >= 0 ) { /* to down */
+	dst += yoffset * bm->bytes_wide;
+	if (ymax > bm->h - yoffset) ymax = bm->h - yoffset;
+    } else { /* to up */
+	src  += (-yoffset) * g->bitmap.pitch;
+	ymax -= (-yoffset);
+	if ( ymax > bm->h ) ymax = bm->h;
+    }
+
+    if ( xmax<=0 || ymax<=0 ) return;
+    for ( y=0; y<ymax; y++ ) {
+	if ( xshift == 0 ) {
+	    for ( x=0; x<xmax; x++ ) *dst++ = *src++;
+	} else if ( xshift > 0 ) {
+	    for ( x=0; x<xmax-1; x++ ) {
+		*dst++ |= *src   >> xshift;
+		*dst   |= *src++ << (8 - xshift);
+	    }
+	    dst++; src++;
+	} else {
+	    for ( x=0; x<xmax-1; x++ ) {
+		*dst   |= *src++ << -xshift;
+		*dst++ |= *src   >> (8 + xshift);
+	    }
+	    *dst++ |= *src++ << -xshift;
+	}
+	src += g->bitmap.pitch - xmax;
+	dst += bm->bytes_wide  - xmax;
+    }
+    dst -= bm->bytes_wide - xmax;
+    /* fprintf(stderr, "dst-bm->bits=%d, ", (char*)dst-(char*)bm->bits); */
+    /* fprintf(stderr, "size=%d\n", bm->bytes_wide * bm->h); */
+    assert((char*)dst <= (char*)bm->bits + bm->bytes_wide * bm->h);
+}
+
+int ft2_get_bitmap(long char_code, int ft2_index, struct bitmap *bm)
+{
+    struct ft_font *font = &ft_fonts[ft2_index];
+    FT_Face face = font->face;
+
+    clear_bitmap(bm);
+    if (face == NULL) return 0;
+
+    if ( font->width != bm->w || font->height != bm->h ) {
+	FT_Set_Pixel_Sizes( face, bm->w, bm->h );
+	font->width  = bm->w;
+	font->height = bm->h;
+	font->ascend =
+	    bm->h * face->ascender
+	    /  (face->ascender - face->descender);
+    }
+
+    if ( FT_Load_Glyph( face, glyph_index(char_code,font), FT_LOAD_DEFAULT )
+	 != 0 ) {
+	XDVI_WARNING(( stderr, "FreeType2: Failed in load glyph. "
+		       "(char=0x%X)\n", char_code ));
+	fill_bitmap(bm);
+	return 0;
+    }
+    if ( font->bold ) FT_GlyphSlot_Embolden( face->glyph );
+    if ( FT_Render_Glyph( face->glyph, FT_RENDER_MODE_MONO ) != 0 ) {
+	XDVI_WARNING(( stderr, "FreeType2: Failed in render glyph. "
+		       "(char=0x%X)\n", char_code ));
+	fill_bitmap(bm);
+	return 0;
+    }
+    glyph_to_bitmap( bm, face->glyph, font->ascend );
+    return font->ascend;
+}
+
+#endif	/* PTEX */
--- texk/xdvik/ft2.h.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ft2.h
@@ -0,0 +1,33 @@
+/*========================================================================*\
+
+Copyright (C) 2002-2013 The Xdvik-jp project http://xdvi.sourceforge.jp/
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to
+deal in the Software without restriction, including without limitation the
+rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+sell copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
+THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES
+OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
+ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
+OTHER DEALINGS IN THE SOFTWARE.
+
+NOTE:
+This module is based on prior work, as noted in the modification history
+in README.xdvik-jp and changelog.
+
+\*========================================================================*/
+
+struct ptexmap;	/* forward declaration */
+struct bitmap;	/* forward declaration */
+
+int ft2_open_font(struct ptexmap *map);
+int ft2_get_bitmap(long char_code, int ft2_index, struct bitmap *bm);
--- texk/xdvik/ft2vert.c.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ft2vert.c
@@ -0,0 +1,399 @@
+/*
+ * "ft2vert.c"
+ * 
+ * Converter to vertical glyph ID by handling GSUB vrt2/vert feature
+ * requires FreeType-2.1.10 or latter
+ *
+ * (C) 2005 Nobuyuki TSUCHIMURA
+ *
+ * This file is free
+ * software; you can redistribute it and/or modify it under the terms of
+ * the GNU Library General Public License as published by the Free
+ * Software Foundation; either version 2 of the License, or (at your
+ * option) any later version.  This library is distributed in the hope
+ * that it will be useful, but WITHOUT ANY WARRANTY; without even the
+ * implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
+ * PURPOSE.  See the GNU Library General Public License for more details.
+ * You should have received a copy of the GNU Library General Public
+ * License along with this library; if not, write to the Free Software
+ * Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ *
+ * using such Lookup
+ *   ScriptTag == 'kana'
+ *   DefaultLangSys or LangSysTag == 'JAN '
+ *   FeatureTag == 'vrt2' or 'vert'
+ *
+ * [reference]
+ * http://partners.adobe.com/public/developer/opentype/index_table_formats1.html
+ * http://partners.adobe.com/public/developer/opentype/index_table_formats.html
+ * http://partners.adobe.com/public/developer/opentype/index_tag9.html#vrt2
+ */
+
+#include "xdvi-config.h"
+#include "xdvi.h"
+#ifdef	PTEX
+
+#include <ft2build.h>
+#include FT_FREETYPE_H
+#include FT_OPENTYPE_VALIDATE_H
+
+#include <stdio.h>
+#include <stdlib.h>
+#include "ft2vert.h"
+
+#define TAG_KANA FT_MAKE_TAG('k', 'a', 'n', 'a')
+#define TAG_JAN  FT_MAKE_TAG('J', 'A', 'N', ' ')
+#define TAG_VERT FT_MAKE_TAG('v', 'e', 'r', 't')
+#define TAG_VRT2 FT_MAKE_TAG('v', 'r', 't', '2')
+
+#define MALLOC(ptr, size) ptr = xmalloc(sizeof((ptr)[0]) * (size))
+#define BYTE2(p) ((p) += 2, (int)(p)[-2] << 8  | (p)[-1])
+#define BYTE4(p) ((p) += 4, (int)(p)[-4] << 24 | (int)(p)[-3] << 16 | \
+		  (int)(p)[-2] << 8 | (p)[-1])
+
+struct ft2vert_st {
+    int SubTableCount;
+    struct SubTable_st {
+	struct SingleSubst_st {
+	    FT_UInt SubstFormat;
+	    FT_UInt DeltaGlyphID; /* SubstFormat == 1 */
+	    int     GlyphCount;   /* SubstFormat == 2 */
+	    FT_UInt *Substitute;  /* SubstFormat == 2 */
+	} SingleSubst;
+	struct Coverage_st {
+	    FT_UInt CoverageFormat;
+	    int     GlyphCount;   /* CoverageFormat == 1 */
+	    FT_UInt *GlyphArray;  /* CoverageFormat == 1 */
+	    int     RangeCount;   /* CoverageFormat == 2 */
+	    struct  RangeRecord_st
+		   *RangeRecord;  /* CoverageFormat == 2 */
+	} Coverage;
+    } *SubTable;
+    FT_Bytes kanaFeature;
+    FT_Bytes vertLookup;
+    FT_Bytes vrt2Lookup;
+};
+
+struct RangeRecord_st {
+    FT_UInt Start;
+    FT_UInt End;
+};
+
+
+int isInIndex(FT_Bytes s, int index) {
+    int i, count;
+
+    if (s == NULL) return FALSE;
+    count = BYTE2(s);
+    for (i=0; i<count; i++) {
+	if (index == BYTE2(s)) return TRUE;
+    }
+    return FALSE;
+}
+
+
+/**********  Debug ***************/
+
+#ifdef DEBUG
+static FT_Bytes gsub_top;
+
+void print_offset(char *message, const FT_Bytes ptr) {
+    printf("%s offset = %x\n", message, ptr - gsub_top);
+}
+
+char *tag_to_string(FT_Tag tag) {
+    static char str[5];
+    str[0] = tag >> 24;
+    str[1] = tag >> 16;
+    str[2] = tag >> 8;
+    str[3] = tag;
+    return str;
+}
+
+void hex_dump(const FT_Bytes top) {
+    int i, j;
+    FT_Bytes s = top;
+
+    for (j=0; j<100; j++) {
+	printf("%04x : ", j*8);
+	for (i=0; i<8; i++) {
+	    printf("%02x ", s[i+j*8]);
+	}
+	printf("\n");
+    }
+}
+#endif /* DEBUG */
+
+/**********  Lookup part ***************/
+
+void scan_Coverage(struct ft2vert_st *ret, const FT_Bytes top) {
+    int i;
+    FT_Bytes s = top;
+    struct Coverage_st *t;
+
+    t = &ret->SubTable[ret->SubTableCount].Coverage;
+    t->CoverageFormat = BYTE2(s);
+    switch (t->CoverageFormat) {
+    case 1: 
+	t->GlyphCount = BYTE2(s);
+	MALLOC(t->GlyphArray, t->GlyphCount);
+	for (i=0; i<t->GlyphCount; i++) {
+	    t->GlyphArray[i] = BYTE2(s);
+	}
+	break;
+    case 2:
+	t->RangeCount = BYTE2(s);
+	MALLOC(t->RangeRecord, t->RangeCount);
+	for (i=0; i<t->RangeCount; i++) {
+	    t->RangeRecord[i].Start = BYTE2(s);
+	    t->RangeRecord[i].End   = BYTE2(s);
+	    s += 2; /* drop StartCoverageIndex */
+	}
+	break;
+    default:
+	fprintf(stderr, "scan_Coverage: unknown CoverageFormat (%d).",
+		t->CoverageFormat);
+	exit(1);
+    }
+    ret->SubTableCount++;
+}
+
+void scan_SubTable(struct ft2vert_st *ret, const FT_Bytes top) {
+    int i;
+    FT_Bytes s = top;
+    FT_Offset Coverage;
+    struct SingleSubst_st *t;
+
+    t = &ret->SubTable[ret->SubTableCount].SingleSubst;
+    t->SubstFormat = BYTE2(s);
+    Coverage       = BYTE2(s);
+    scan_Coverage(ret, top + Coverage);
+    switch (t->SubstFormat) {
+    case 1: /* SingleSubstFormat1 */
+	t->DeltaGlyphID = BYTE2(s);
+	break;
+    case 2: /* SingleSubstFormat2 */
+	t->GlyphCount   = BYTE2(s);
+	MALLOC(t->Substitute, t->GlyphCount);
+	for (i=0; i<t->GlyphCount; i++) {
+	    t->Substitute[i] = BYTE2(s);
+	}
+	break;
+    default:
+	fprintf(stderr, "scan_SubTable: unknown SubstFormat (%d).",
+		t->SubstFormat);
+	exit(1);
+    }
+}
+
+void scan_Lookup(struct ft2vert_st *ret, const FT_Bytes top) {
+    int i;
+    FT_Bytes s = top;
+    FT_UShort LookupType;
+    FT_UShort LookupFlag;
+    FT_UShort SubTableCount;
+    FT_UShort SubTable;
+
+    LookupType    = BYTE2(s);
+    LookupFlag    = BYTE2(s);
+    SubTableCount = BYTE2(s);
+    SubTable      = BYTE2(s);
+
+    MALLOC(ret->SubTable, SubTableCount);
+    for (i=0; i<SubTableCount; i++) {
+	scan_SubTable(ret, top + SubTable);
+    }
+    if (ret->SubTableCount != SubTableCount) {
+	fprintf(stderr, "warning (scan_Lookup): "
+		"SubTableCount (=%d) is not expected (=%d).\n",
+		ret->SubTableCount, SubTableCount);
+    }
+}
+
+
+void scan_LookupList(struct ft2vert_st *ret, const FT_Bytes top) {
+    int i;
+    FT_Bytes s = top;
+    int LookupCount;
+
+    LookupCount = BYTE2(s);
+
+    for (i=0; i<LookupCount; i++) {
+	FT_Bytes t = top + BYTE2(s);
+	if (isInIndex(ret->vertLookup, i)) {
+	    scan_Lookup(ret, t);
+	}
+    }
+}
+
+/********** Feature part ****************/
+
+void scan_FeatureList(struct ft2vert_st *ret, const FT_Bytes top) {
+    int i;
+    FT_Bytes s = top;
+    int FeatureCount;
+
+    FeatureCount = BYTE2(s);
+
+    for (i=0; i<FeatureCount; i++) {
+	FT_Tag FeatureTag = BYTE4(s);
+	FT_Offset Feature = BYTE2(s);
+	if (!isInIndex(ret->kanaFeature, i)) continue;
+	if (FeatureTag == TAG_VERT) {
+	    ret->vertLookup = top + Feature + 2;
+	} else if (FeatureTag == TAG_VRT2) {
+	    ret->vrt2Lookup = top + Feature + 2;
+	}
+    }
+}
+
+/********** Script part ****************/
+
+void scan_LangSys(struct ft2vert_st *ret, const FT_Bytes top) {
+    if (ret->kanaFeature == NULL) ret->kanaFeature = top + 4;
+}
+
+void scan_Script(struct ft2vert_st *ret, const FT_Bytes top) {
+    int i;
+    FT_Bytes s = top;
+    FT_Offset DefaultLangSys;
+    int LangSysCount;
+
+    DefaultLangSys = BYTE2(s);
+    if (DefaultLangSys != 0) {
+	scan_LangSys(ret, top + DefaultLangSys);
+    }
+    LangSysCount = BYTE2(s);
+
+    for (i=0; i<LangSysCount; i++) {
+	FT_Tag LangSysTag = BYTE4(s);
+	FT_Bytes t = top + BYTE2(s);
+	if (LangSysTag == TAG_JAN) {
+	    scan_LangSys(ret, t);
+	}
+    }
+}
+
+void scan_ScriptList(struct ft2vert_st *ret, const FT_Bytes top) {
+    int i;
+    FT_Bytes s = top;
+    int ScriptCount;
+
+    ScriptCount = BYTE2(s);
+
+    for (i=0; i<ScriptCount; i++) {
+	FT_Tag ScriptTag = BYTE4(s);
+	FT_Bytes t = top + BYTE2(s);
+	if (ScriptTag == TAG_KANA) {
+	    scan_Script(ret, t);
+	}
+    }
+}
+
+/********** header part *****************/
+
+void scan_GSUB_Header(struct ft2vert_st *ret, const FT_Bytes top) {
+    FT_Bytes s = top;
+    FT_Fixed  Version;
+    FT_Offset ScriptList;
+    FT_Offset FeatureList;
+    FT_Offset LookupList;
+
+#ifdef DEBUG
+    gsub_top    = top;
+#endif /* DEBUG */
+    Version     = BYTE4(s);
+    ScriptList  = BYTE2(s);
+    FeatureList = BYTE2(s);
+    LookupList  = BYTE2(s);
+
+    if (Version != 0x00010000) {
+	fprintf(stderr, "warning: GSUB Version (=%.1f) is not 1.0\n",
+		(double)Version / 0x10000);
+    }
+
+    scan_ScriptList (ret, top + ScriptList);
+    scan_FeatureList(ret, top + FeatureList);
+    /* vrt2 has higher priority over vert */
+    if (ret->vrt2Lookup != NULL) ret->vertLookup = ret->vrt2Lookup;
+    scan_LookupList (ret, top + LookupList);
+}
+
+struct ft2vert_st *ft2vert_init(FT_Face face) {
+    struct ft2vert_st *ret;
+    int ft_error;
+    FT_Bytes dummy, GSUB_table;
+
+    MALLOC(ret, 1);
+    ret->SubTableCount = 0;
+    ret->vertLookup  = NULL;
+    ret->vrt2Lookup  = NULL;
+    ret->kanaFeature = NULL;
+    ft_error =
+	FT_OpenType_Validate( face, FT_VALIDATE_GSUB,
+			      &dummy, &dummy, &dummy, &GSUB_table, &dummy);
+    if (ft_error == FT_Err_Unimplemented_Feature) {
+        fprintf(stderr, "warning: FT_OpenType_Validate is disabled. "
+                "Replace FreeType2 with otvalid-enabled version.\n");
+        return ret;
+    } else if (ft_error != 0 || GSUB_table == 0) {
+	fprintf(stderr, "warning: %s has no GSUB table.\n",
+		face->family_name);
+	return ret;
+    }
+    scan_GSUB_Header(ret, GSUB_table);
+    if (ret->SubTableCount == 0) {
+	fprintf(stderr, "warning: %s has no vrt2/vert feature.\n",
+		face->family_name);
+    }
+    free((void*)GSUB_table);
+    return ret;
+}
+
+/********** converting part *****************/
+
+static FT_UInt get_vert_nth_gid(struct SubTable_st *t, FT_UInt gid, int n) {
+    switch (t->SingleSubst.SubstFormat) {
+    case 1:
+	return gid + t->SingleSubst.DeltaGlyphID;
+    case 2:
+	return t->SingleSubst.Substitute[n];
+    }
+    fprintf(stderr, "get_vert_nth_gid: internal error");
+    exit(1);
+    return 0;
+}
+
+
+FT_UInt ft2vert_get_gid(struct ft2vert_st *ft2vert, FT_UInt gid) {
+    int i, k;
+    int j = 0; /* StartCoverageIndex */
+
+    for (k=0; k<ft2vert->SubTableCount; k++) {
+	struct SubTable_st *t = &ft2vert->SubTable[k];
+	switch (t->Coverage.CoverageFormat) {
+	case 1:
+	    for (i=0; i<t->Coverage.GlyphCount; i++) {
+		if (t->Coverage.GlyphArray[i] == gid) {
+		    return get_vert_nth_gid(t, gid, i);
+		}
+	    }
+	    break;
+	case 2:
+	    for (i=0; i<t->Coverage.RangeCount; i++) {
+		struct RangeRecord_st *r = &t->Coverage.RangeRecord[i];
+		if (r->Start <= gid && gid <= r->End) {
+		    return get_vert_nth_gid(t, gid, gid - r->Start + j);
+		}
+		j += r->End - r->Start + 1;
+	    }
+	    break;
+	default:
+	    fprintf(stderr, "ft2vert_get_gid: internal error");
+	    exit(1);
+	}
+    }
+    return gid;
+}
+
+#endif	/* PTEX */
--- texk/xdvik/ft2vert.h.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ft2vert.h
@@ -0,0 +1,30 @@
+/*
+ * "ft2vert.h"
+ * 
+ * (C) 2005 Nobuyuki TSUCHIMURA
+ *
+ * This file is free
+ * software; you can redistribute it and/or modify it under the terms of
+ * the GNU Library General Public License as published by the Free
+ * Software Foundation; either version 2 of the License, or (at your
+ * option) any later version.  This library is distributed in the hope
+ * that it will be useful, but WITHOUT ANY WARRANTY; without even the
+ * implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
+ * PURPOSE.  See the GNU Library General Public License for more details.
+ * You should have received a copy of the GNU Library General Public
+ * License along with this library; if not, write to the Free Software
+ * Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ *
+ */
+
+#ifndef FT2VERT_H_
+#define FT2VERT_H_
+
+/* store GSUB feature vert/vrt2 */
+struct ft2vert_st *ft2vert_init(FT_Face face);
+
+/* convert horizontal glyph index to vertical glyph index
+ */
+FT_UInt ft2vert_get_gid(struct ft2vert_st *ft2vert, FT_UInt gid);
+
+#endif /* FT2VERT_H_ */
--- texk/xdvik/gui/help-window.c.orig	2013-03-31 05:28:21 UTC
+++ texk/xdvik/gui/help-window.c
@@ -314,6 +314,9 @@ initialize_items(struct topic_info *info
 #if FREETYPE
 	"- freetype2 (direct rendering of PS fonts) enabled\n",
 #endif
+#ifdef PTEX
+	"- FreeType2 (Kanji font rendering) enabled\n",
+#endif /* PTEX */
 #if HAVE_ICONV_H
 	"- Iconv support compiled in\n",
 #if USE_LANGINFO
--- texk/xdvik/hypertex.h.orig	2004-05-07 22:10:22 UTC
+++ texk/xdvik/hypertex.h
@@ -21,7 +21,7 @@
  */
 
 #ifndef HYPERTEX_H_
-#define HTEXTEX_H_
+#define HYPERTEX_H_
 
 /* fallbacks if parsing user-specified colors fails */
 #define LINK_COLOR_FALLBACK "BLUE2"
@@ -68,4 +68,4 @@ extern void htex_forward(void);
 
 extern Boolean htex_scan_anchor(const char *special, size_t len);
 
-#endif /* HTEXTEX_H_ */
+#endif /* HYPERTEX_H_ */
--- texk/xdvik/jfm.c.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/jfm.c
@@ -0,0 +1,143 @@
+/*========================================================================*\
+
+Copyright (C) Atsuo Kawaguchi, 1987.
+Copyright (C) 1993-2013 The Xdvik-jp project http://xdvi.sourceforge.jp/
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to
+deal in the Software without restriction, including without limitation the
+rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+sell copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
+THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES
+OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
+ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
+OTHER DEALINGS IN THE SOFTWARE.
+
+NOTE:
+This module is based on prior work, as noted below and
+in the modification history in README.xdvik-jp and changelog.
+
+\*========================================================================*/
+
+/*------------------------------------------------------------------------
+  The function read_jfm0() and jfm.h are derived from
+    drivers/jxdvi.NEWS/font.{c,h}
+    in ascii jtex1.7.tar.Z (1992, ASCII CORPORATION).
+  The original author and copyright notice is shown below (in UTF-8):
+
+ *
+ * Copyright (C) Atsuo Kawaguchi, 1987.
+ * 
+ *      (...)
+ *      (...)
+ *          
+ *        (atsuo@sanken.osaka-u.junet)
+ * 
+ * Everyone is permitted to do anything on this program
+ * including copying, porting, debugging, and modifying.
+ *
+
+ -------------------------------------------------------------------------*/
+
+#include "xdvi-config.h"
+#include "xdvi.h"
+#ifdef	PTEX
+
+#include "jfm.h"
+#include "util.h"
+
+#ifndef	SEEK_SET
+#define	SEEK_SET	0
+#endif
+
+/**** read_jfm0: borrowed from jxdvi-NEWS ****/
+static int read_jfm0(FILE *fp, struct jfm *j)
+{
+	int i;
+
+	fseek(fp, 0L, SEEK_SET);
+
+	/* read jfm table field. */
+	for (i = 0; i <= J_NP; i++)
+	    j->table[i] = (short) get_bytes(fp, 2);
+
+	/* read jfm header */
+	j->check_sum = get_bytes(fp, 4);
+	j->design_size = get_bytes(fp, 4);
+	fseek(fp, (long) (4 * (j->table[J_LH] - 2)), 1);
+    
+	/* read jfm char_type */
+	j->type = xmalloc(sizeof(struct jfm_char_type) * j->table[J_NT]);
+	for (i=0; i < j->table[J_NT]; i++) {
+	    j->type[i].code = (short) get_bytes(fp, 2);
+	    j->type[i].index = (short) get_bytes(fp, 2);
+	}
+    
+	/* read jfm char_info */
+	j->info = xmalloc(sizeof(struct jfm_char_info) * (j->table[J_EC] + 1));
+	for (i = 0; i <= j->table[J_EC]; i++) {
+	    j->info[i].width_ix = (unsigned char) get_byte(fp);
+	    j->info[i].height_depth_ix = (unsigned char) get_byte(fp);
+	    j->info[i].italic_ix_tag = (unsigned char) get_byte(fp);
+	    j->info[i].remainder_ix = (unsigned char) get_byte(fp);
+	}
+    
+	/* read jfm width */
+	j->width = xmalloc(sizeof(unsigned long) * j->table[J_NW]);
+	for (i = 0; i < j->table[J_NW]; i++)
+	    j->width[i] = get_bytes(fp, 4);
+
+	/* read jfm height */
+	j->height = xmalloc(sizeof(unsigned long) * j->table[J_NH]);
+	for (i = 0; i < j->table[J_NH]; i++)
+	    j->height[i] = get_bytes(fp, 4);
+
+	/* read jfm depth */
+	j->depth = xmalloc(sizeof(unsigned long) * j->table[J_ND]);
+	for (i = 0; i < j->table[J_ND]; i++)
+	    j->depth[i] = get_bytes(fp, 4);
+
+	/* read jfm italic */
+	j->italic = xmalloc(sizeof(unsigned long) * j->table[J_NI]);
+	for (i = 0; i < j->table[J_NI]; i++)
+	    j->italic[i] = get_bytes(fp, 4);
+	return 0;
+}
+
+static int jfms_max = 0;
+static int jfms_num = 0;
+static struct jfm *jfms = NULL;
+
+struct jfm *read_jfm(FILE *fp, char *fontname)
+{
+	int i;
+	struct jfm *j;
+
+	for (i=0; i<jfms_num; i++) {
+	    if (strcmp(fontname, jfms[i].fontname) == 0) return &jfms[i];
+	}
+
+	if (jfms_num == jfms_max) {
+	    if (jfms_max == 0) jfms_max = 8;
+	    else               jfms_max *= 2;
+	    jfms = xrealloc( jfms, sizeof(jfms[0]) * jfms_max );
+	}
+	j = &jfms[jfms_num];
+
+	if (read_jfm0(fp, j)) {
+	    fprintf(stderr, "Cannot open metric file: %s\n", fontname);
+	    return NULL;
+	}
+	j->fontname = xstrdup(fontname);
+	jfms_num++;
+	return j;
+}
+#endif	/* PTEX */
--- texk/xdvik/jfm.h.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/jfm.h
@@ -0,0 +1,54 @@
+/**********************************************
+ *  Copyright (C) Atsuo Kawaguchi, 1987.
+ *         (atsuo@sanken.osaka-u.junet)
+ *  Modified by Y. Hayashi from jxdvi-NEWS
+ *	   (hayashi@me.aoyama.ac.jp)
+ **********************************************/
+/* Lisense is shown in jfm.c */
+
+#ifndef JFM_H_
+#define JFM_H_
+
+#define	J_ID 0		/* id */
+#define	J_NT 1		/* number of words in the char_type table */
+#define	J_LF 2		/* length of entire file */
+#define	J_LH 3		/* length of header */
+#define	J_BC 4		/* smallest char_type */
+#define	J_EC 5		/* largest char_type */
+#define	J_NW 6		/* number of width table */
+#define	J_NH 7		/* number of height table */
+#define	J_ND 8		/* number of depth table */
+#define	J_NI 9		/* number of italic correctiuon table */
+#define	J_NL 10		/* number of glue/kern talbe */
+#define	J_NK 11
+#define	J_NG 12
+#define	J_NP 13
+
+struct jfm_char_type {
+    unsigned short	code;		/* JIS code */
+    unsigned short	index;		/* index to char_info */
+};
+
+struct jfm_char_info {
+    unsigned char	width_ix;		/* index to width */
+    unsigned char	height_depth_ix;	/* index to height & depth */
+    unsigned char	italic_ix_tag;		/* index to italic & tag */
+    unsigned char	remainder_ix;		/* index to remainder */
+};
+
+struct jfm {
+    char	*fontname;			/* font name (min10, etc.) */
+    short	table[(J_NP+1)];		/* table */
+    unsigned long check_sum;			/* header */
+    unsigned long design_size;		
+    struct jfm_char_type *type;
+    struct jfm_char_info *info;
+    unsigned long *width;
+    unsigned long *height;
+    unsigned long *depth;
+    unsigned long *italic;
+};
+
+struct jfm *read_jfm(FILE *fp, char *fontname);
+
+#endif /* JFM_H_ */
--- texk/xdvik/main.c.orig	2014-04-03 01:17:12 UTC
+++ texk/xdvik/main.c
@@ -39,6 +39,9 @@
 #include "filehist.h"
 #include "mag.h"
 #include "message-window.h"
+#ifdef HAVE_LIBPAPER
+#include <paper.h>
+#endif
 
 #if FREETYPE
 # include <ft2build.h>
@@ -54,6 +57,14 @@ static const char *xdvi_kpse_prog_name =
 #undef STRINGIFY
 #undef TOSTRING
 
+#ifdef	PTEX
+#include <ft2build.h>
+#include FT_FREETYPE_H
+#if	HAVE_FONTCONFIG
+#include <fontconfig/fontconfig.h>
+#endif	/* HAVE_FONTCONFIG */
+#endif	/* PTEX */
+
 static char XtRBool3[] = "Bool3";	/* resource for Bool3 */
 
 /* get these before setting `application_resources' */
@@ -651,8 +662,16 @@ init_check_resources(void)
 
     /* paper type */
     if (!set_paper_type(resource.paper)) {
-	const char **p;
 	char *helpmsg = xstrdup("Possible paper types are:\n    ");
+#ifdef HAVE_LIBPAPER
+	const struct paper *pp;
+
+	for (pp = paperfirst(); pp; pp = papernext(pp)) {
+		helpmsg = xstrcat(helpmsg, papername(pp));
+		helpmsg = xstrcat(helpmsg, " ");
+	}
+#else
+	const char **p;
 	const char **paper_types = get_paper_types();
 	for (p = paper_types; p < paper_types + get_paper_types_size(); p += 2) {
 	    if (**p == '\0') { /* next line of list */
@@ -663,6 +682,7 @@ init_check_resources(void)
 		helpmsg = xstrcat(helpmsg, " ");
 	    }
 	}
+#endif
 	helpmsg = xstrcat(helpmsg,
 			  "\n(the names ending with `r' are `rotated' or `landscape' variants).\n"
 			  "Alternatively, you can specify the dimensions as `WIDTHxHEIGHT', followed "
@@ -778,6 +798,9 @@ static void
 display_version_info(void)
 {
     printf("%s version %s ", XDVIK_PROGNAME, XDVI_VERSION);
+#ifdef JPVERSION
+    printf("%s ", JPVERSION);
+#endif
 #ifdef MOTIF
     printf("(%s, runtime version %d.%d)\n",
 	   /* 	   XmVERSION, XmREVISION, XmUPDATE_LEVEL, */
@@ -786,12 +809,19 @@ display_version_info(void)
 #else
     printf("%s\n", XDVI_GUI);
 #endif
+    printf("Libraries: %s", kpathsea_version_string);
+#ifdef HAVE_LIBPAPER
+    printf(", libpaper");
+#endif
 #if FREETYPE
-    printf("Libraries: %s, freetype version %d.%d.%d\n",
-      kpathsea_version_string, FREETYPE_MAJOR, FREETYPE_MINOR, FREETYPE_PATCH);
-#else
-    printf("Libraries: %s\n", kpathsea_version_string);
+    printf(", freetype version %d.%d.%d", FREETYPE_MAJOR, FREETYPE_MINOR, FREETYPE_PATCH);
 #endif
+#ifdef PTEX
+#if HAVE_FONTCONFIG
+    printf(", fontconfig version %d.%d.%d", FC_MAJOR, FC_MINOR, FC_REVISION);
+#endif /* HAVE_FONTCONFIG */
+#endif /* !PTEX */
+    printf("\n");
 }
 
 
--- texk/xdvik/pk.c.orig	2009-03-02 21:43:37 UTC
+++ texk/xdvik/pk.c
@@ -201,6 +201,9 @@ read_PK_char(struct font *fontp,
 
     g->dvi_adv = fontp->dimconv * fpwidth;
 
+#ifdef PTEX
+    g->tdir = fontp->dir;
+#endif /* PTEX */
     if (globals.debug & DBG_PK) {
 	if (g->bitmap.w != 0)
 	    printf(", size=%dx%d, dvi_adv=%ld", g->bitmap.w, g->bitmap.h,
--- texk/xdvik/ptexmap.c.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ptexmap.c
@@ -0,0 +1,254 @@
+#include "xdvi-config.h"
+#include "xdvi.h"
+#include "ptexmap.h"
+#include "util.h"
+#include "kpathsea/tex-file.h"
+#ifdef	PTEX
+#include "ft2.h"
+#include <ctype.h>
+
+#define NUM(a)	  ((int)(sizeof(a)/sizeof(*(a))))
+
+static int dictionaries_num = 0;
+static int dictionaries_max = 0;
+static struct dictionary {
+  char *key, *word;
+} *dictionaries = NULL;
+
+static struct dictionary *get_dictionary(char *key)
+{
+    int i;
+
+    if (key == NULL) return NULL;
+    for (i=0; i<dictionaries_num; i++) {
+	if (strcmp(key, dictionaries[i].key) == 0) {
+	    return &dictionaries[i];
+	}
+    }
+    return NULL;
+}
+
+void add_replace_dictionary(char *key, char *word)
+{
+    struct dictionary *d;
+
+    d = get_dictionary(key);
+    if (d == NULL) {
+	if (dictionaries_num == dictionaries_max) {
+	    if (dictionaries_max == 0) dictionaries_max = 16;
+	    else		       dictionaries_max *= 2;
+	    dictionaries = xrealloc(dictionaries,
+			     sizeof(dictionaries[0]) * dictionaries_max);
+	}
+	d = &dictionaries[dictionaries_num++];
+	d->key  = xstrdup(key);
+    } else {
+	XDVI_WARNING((stderr, "Duplication of replace entry '%s' was found. "
+		      "Overwrites '%s' with '%s'.\n", key, d->word, word));
+	free(d->word);
+    }
+
+    d->word = xstrdup(word);
+}
+
+static char *replace_string(char *key)
+{
+    struct dictionary *d = get_dictionary(key);
+    if (d == NULL) return key;
+    return d->word;
+}
+
+
+static int ptexmaps_num = 0;
+static int ptexmaps_max = 0;
+static struct ptexmap *ptexmaps = NULL;
+
+struct ptexmap *getkanjifont(const char *jfm_name)
+{
+    int i;
+
+    for (i=0; i<ptexmaps_num; i++) {
+	if (strcmp(jfm_name, ptexmaps[i].jfm_name) == 0) {
+	    return &ptexmaps[i];
+	}
+    }
+    return NULL;
+}
+
+static struct ptexmap *add_fontmap2(char *jfm, char *font, int encoding,
+				    char *map_filename, char *enc)
+{
+    struct ptexmap *map;
+
+    map = getkanjifont(jfm);
+    if (map == NULL) {
+	if (ptexmaps_num == ptexmaps_max) {
+	    if (ptexmaps_max == 0) ptexmaps_max = 8;
+	    else		   ptexmaps_max *= 2;
+	    ptexmaps = xrealloc(ptexmaps, sizeof(ptexmaps[0]) * ptexmaps_max);
+	}
+	map = &ptexmaps[ptexmaps_num++];
+	map->jfm_name = xstrdup(jfm);
+    } else {
+	XDVI_WARNING((stderr, "A ptexmap entry for '%s' in \"%s\" duplicates "
+		      "a former entry in \"%s\". Overwrites.\n",
+		      jfm, map_filename, map->map_filename));
+	free(map->font_filename);
+    }
+
+    map->face_index = 0;
+    map->ft2_index = -1;
+    if (sscanf(font, ":%d:", &map->face_index) == 1) {
+	font = strchr(font+1, ':') + 1;
+    }
+
+    font = replace_string(font);
+    if (strlen(font) >6 && strstr(font + (strlen(font) - 5), "/AJ16") != NULL) {
+      if (strcmp(enc, "Identity-H") == 0) {
+	encoding = ENC_AJ16_H;
+	if (globals.debug & DBG_PTEXFNT)
+	  fprintf(stderr, "The encoding is replaced by \"AJ16-H\" .\n");
+      }
+      else if (strcmp(enc, "Identity-V") == 0) {
+	encoding = ENC_AJ16_V;
+	if (globals.debug & DBG_PTEXFNT)
+	  fprintf(stderr, "The encoding is replaced by \"AJ16-V\" .\n");
+      }
+      map->font_filename  = xstrndup(font, strlen(font) - 5);
+    } else {
+      map->font_filename  = xstrdup(font);
+    }
+    map->encoding = encoding;
+    map->extend = 1.0;
+    map->slant  = 0.0;
+    map->variant = 0;
+    map->map_filename = map_filename;
+    return map;
+}
+
+int str2encoding(char *enc_name) {
+    int i;
+    static struct {
+	char *enc_name;
+	int encoding;
+    } encodes[] = {
+	{ "JIS-H",      ENC_JIS_H },
+	{ "JIS-V",      ENC_JIS_V },
+	{ "Unicode-H",  ENC_UNICODE_H },
+	{ "Unicode-V",  ENC_UNICODE_V },
+	{ "Unicode-V",  ENC_UNICODE_V },
+	{ "AJ16-H",     ENC_AJ16_H },
+	{ "AJ16-V",     ENC_AJ16_V },
+	{ "Identity-H", ENC_IDENTITY },
+	{ "Identity-V", ENC_IDENTITY },
+	/* caution: Identity-H = Identity-V */
+    };
+
+    if (enc_name == NULL) return ENC_UNKNOWN;
+    for (i=0; i<NUM(encodes); i++) {
+	if (strcmp(enc_name, encodes[i].enc_name) == 0) {
+	    return encodes[i].encoding;
+	}
+    }
+    return ENC_UNKNOWN;
+}
+
+static int add_fontmap(char *line, char *map_filename)
+{
+    struct ptexmap *map;
+    char *s, *jfm, *font, *enc;
+    int encoding = 0;
+    float *ptr = NULL;
+
+    jfm  = strtok(line, " \t");
+    enc  = replace_string(strtok(NULL, " \t"));
+    font = strtok(NULL, " \t,!");
+
+    if (jfm == NULL) return true; /* empty line */
+
+    if (font == NULL) {
+	XDVI_WARNING((stderr, "A font name for \"%s\" is empty.\n",
+		      jfm));
+	return true;
+    }
+
+    if (strlen(font) >6 && strstr(font + (strlen(font) - 5), "/AJ16") != NULL) {
+      if (strcmp(enc, "Identity-H") == 0) enc = "AJ16-H";
+      else if (strcmp(enc, "Identity-V") == 0) enc = "AJ16-V";
+      font[strlen(font) - 5] = '\0';
+    }
+    encoding = str2encoding(enc);
+
+    if (encoding == ENC_UNKNOWN) {
+	XDVI_WARNING((stderr, "Unknown encode \"%s\" for \"%s\".\n",
+		      enc, jfm));
+	return true;
+    }
+
+    if (globals.debug & DBG_PTEXFNT) {
+	fprintf(stderr, "JFM name is \"%s\".\n", jfm);
+	fprintf(stderr, "Font filename is \"%s\".\n", font);
+	fprintf(stderr, "Font is %s encode (#%d).\n", enc, encoding);
+    }
+
+    map = add_fontmap2(jfm, font, encoding, map_filename, enc);
+
+    while ((s=strtok(NULL, " \t,\r\n")) != NULL) {
+	if      (strcmp(s, "-e") == 0) ptr = &map->extend;
+	else if (strcmp(s, "-s") == 0) ptr = &map->slant;
+	else if (strcmp(s, "Bold") == 0)   map->variant |= VAR_BOLD;
+	else if (strcmp(s, "Italic") == 0) map->variant |= VAR_ITALIC;
+	else if (strcmp(s, "BoldItalic") == 0) {
+	    map->variant |= VAR_BOLD | VAR_ITALIC;
+	} else if ((isdigit(*s) || *s == '.' || *s == '-') && ptr != NULL) {
+	    *ptr = atof(s);
+	} else return false;
+    }
+    return true;
+}
+
+
+char *get_ptexmap_name(char *filename)
+{
+    char *s = NULL;
+    FILE *fp;
+
+    if ((fp=fopen(filename, "r")) != NULL) {
+	fclose(fp);
+	s = xstrdup(filename);
+    }
+    if (s == NULL) s = kpse_find_file(filename, kpse_fontmap_format, true);
+    return s;
+}
+
+
+void read_ptexmap_file(char *filename)
+{
+    FILE *fp;
+    char *s;
+    char line[BUFSIZ], line_orig[BUFSIZ];
+
+    filename = get_ptexmap_name(filename);
+    /* 'filename' will stored in ptexmap structure,
+       so we can't free(filename) in this function. */
+    if ((fp = fopen(filename, "r")) == NULL) {
+	XDVI_WARNING((stderr, "Warning: Can't open \"%s\"\n", filename));
+	return;
+    }
+    if (globals.debug & DBG_FILES) {
+	TRACE_FILES((stderr, "read_ptexmap_file for |%s|", filename));
+    }
+
+    while (fgets(line, BUFSIZ, fp) != NULL) {
+	if ((s=strchr(line,'\n')) != NULL) *s = '\0'; /* break \n */
+	strcpy(line_orig, line);
+	if ((s=strchr(line,'%'))  != NULL) *s = '\0'; /* break comment */
+	if ((s=strchr(line,'#'))  != NULL) *s = '\0'; /* break comment */
+
+	if (!add_fontmap(line, filename)) {
+	    XDVI_WARNING((stderr, "'%s', Unknown option.\n", line_orig));
+	}
+    }
+    fclose(fp);
+}
+#endif	/* PTEX */
--- texk/xdvik/ptexmap.h.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ptexmap.h
@@ -0,0 +1,27 @@
+#ifndef PTEXMAP_H_
+#define PTEXMAP_H_
+
+#ifdef PTEX
+struct ptexmap {
+    char *jfm_name;
+    char *font_filename;
+    int ft2_index;
+    int face_index;
+    enum { ENC_UNKNOWN, ENC_JIS_H, ENC_JIS_V, ENC_UNICODE_H, ENC_UNICODE_V,
+	   ENC_AJ16_H, ENC_AJ16_V, 
+	   ENC_IDENTITY } encoding;
+    enum { VAR_BOLD = 0x01, VAR_ITALIC = 0x02 } variant;
+    float extend, slant;
+    char *sfd_name;
+    char *csi;
+    char *map_filename; /* only for warning message */
+};
+
+void read_ptexmap_file(char *filename);
+struct ptexmap *getkanjifont(const char *jfm_name);
+#define iskanjifont(jfm_name) (getkanjifont(jfm_name) != NULL)
+
+void add_replace_dictionary(char *key, char *word);
+#endif	/* PTEX */
+
+#endif /* PTEXMAP_H_ */
--- texk/xdvik/ptexvf.c.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ptexvf.c
@@ -0,0 +1,147 @@
+/*========================================================================*\
+
+Copyright (C) 1993 Yasuhisa Hayashi
+Copyright (C) 1999-2013 The Xdvik-jp project http://xdvi.sourceforge.jp/
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to
+deal in the Software without restriction, including without limitation the
+rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+sell copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
+THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES
+OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
+ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
+OTHER DEALINGS IN THE SOFTWARE.
+
+NOTE:
+This module is based on prior work, as noted below and
+in the modification history in README.xdvik-jp and changelog.
+
+\*========================================================================*/
+
+/*------------------------------------------------------------------------
+  This module is based on "zeit.c" in
+    "xdvi patch level 17 zeit  patch"
+    xdvi-zeit (1993/8, fj.sources)
+  The original author is Yasuhisa Hayashi ( , hayashi@me.aoyama.ac.jp)
+  and copyright notice is shown below (in UTF-8):
+
+copyright
+
+    
+    
+
+ -------------------------------------------------------------------------*/
+
+/*******************************************************
+ *  Zeit Shotai Kurabu interface routine for xdvi pl.17
+ *  Written by Y. Hayashi   (hayashi@me.aoyama.ac.jp)
+ ******************************************************/
+
+#include "xdvi-config.h"
+#include "xdvi.h"
+#include "dvi-init.h"
+#include "util.h"
+
+#ifndef       X_NOT_STDC_ENV
+#include <stdlib.h>
+#endif
+
+#include "ptexmap.h"
+#include "ptexvf.h"
+#include "jfm.h"
+
+#ifdef PTEX
+#include "ft2.h"
+
+static void read_PTEXVF_char(struct font *fontp, wide_ubyte ch)
+{
+    struct glyph *g;
+    int ascend;
+
+    if (ch > fontp->maxchar) {
+	int j;
+	int i = KTABLESIZE * ((int)(ch / KTABLESIZE)+1);
+	fontp->kglyph = xrealloc(fontp->kglyph, sizeof(struct glyph *) * i);
+	for (j=fontp->maxchar+1; j<i; j++) {
+	    fontp->kglyph[j] = NULL;
+	}
+	fontp->maxchar = i-1;
+    }
+    g = fontp->kglyph[ch];
+    if (g == NULL) {
+	struct glyph *orig = fontp->kglyph[0];
+	ASSERT(orig != NULL, "Unexpected error.");
+	g = fontp->kglyph[ch] = xcalloc(1, sizeof(struct glyph));
+	g->bitmap.w = orig->bitmap.w;
+	g->bitmap.h = orig->bitmap.h;
+	g->x        = orig->x;
+	g->y        = orig->y;
+	g->dvi_adv  = orig->dvi_adv;
+    }
+    alloc_bitmap(&g->bitmap);
+    ascend = ft2_get_bitmap(ch, fontp->ft2_index, &g->bitmap);
+#ifndef WORDS_BIGENDIAN
+    order_reverse_bitmap(&g->bitmap);
+#endif  /* !WORDS_BIGENDIAN */
+    g->tdir = fontp->dir;
+    if (fontp->dir) {  /* tate */
+	int swap = g->x;
+	g->x     = g->y;
+	g->y     = swap;
+    } else {  /* yoko */
+	g->y = ascend;
+    }
+}
+
+int read_PTEXVF_index(struct font *fontp)
+{
+    int n;
+    struct glyph *g;
+    struct jfm *jfm;
+    const double dimconv = fontp->dimconv;
+
+    fontp->read_char = read_PTEXVF_char;
+    fontp->kglyph = xcalloc(KTABLESIZE, sizeof(struct glyph *));
+    fontp->maxchar = KTABLESIZE - 1;
+
+    jfm = read_jfm(fontp->file, fontp->fontname);
+    if (jfm == NULL) return -1;
+    fontp->ft2_index = ft2_open_font(getkanjifont(fontp->fontname));
+    if (fontp->ft2_index < 0) return -1;
+
+    for (n=0; n<jfm->table[J_NT]; n++) {
+	int code  =  jfm->type[n].code;
+	int index =  jfm->type[n].index;
+	int width =  jfm->width[jfm->info[index].width_ix];
+	int height= jfm->height[jfm->info[index].height_depth_ix / 0x10];
+	int depth =  jfm->depth[jfm->info[index].height_depth_ix % 0x10];
+
+	g = xcalloc(1, sizeof(struct glyph));
+	g->bitmap.w = (int)(dimconv * width) >> 16;
+	g->bitmap.h = (int)(dimconv * (height + depth)) >> 16;
+	if (g->bitmap.w != g->bitmap.h) {
+	  if (code<0xFF61 || code>0xFFDC) /* HALFWIDTH in Unicode: U+FF61 -- U+FFDC */
+	    fprintf(stderr, "Warning: '%s' (code=0x%X) is not square.\n",
+		    fontp->fontname, code);
+	}
+	g->bitmap.bits = NULL;
+	g->x = 0;
+	g->y = (int) (dimconv * height) >> 16;
+	g->dvi_adv = dimconv * width;
+	fontp->kglyph[code] = g;
+    }
+    g = fontp->kglyph[0];
+    alloc_bitmap(&g->bitmap);
+    fill_bitmap(&g->bitmap);
+    return 0;
+}
+#endif  /* PTEX */
--- texk/xdvik/ptexvf.h.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/ptexvf.h
@@ -0,0 +1,36 @@
+/*========================================================================*\
+
+Copyright (C) 2002-2013 The Xdvik-jp project http://xdvi.sourceforge.jp/
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to
+deal in the Software without restriction, including without limitation the
+rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+sell copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
+THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES
+OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
+ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
+OTHER DEALINGS IN THE SOFTWARE.
+
+NOTE:
+This module is based on prior work, as noted below and
+in the modification history in README.xdvik-jp and changelog.
+
+\*========================================================================*/
+
+/*******************************************************
+ *  Zeit Shotai Kurabu interface routine for xdvi-22.40k
+ *  Written by tutimura(a)nn.iij4u.or.jp
+ ******************************************************/
+
+#ifdef PTEX
+int	read_PTEXVF_index(struct font *);
+#endif  /* PTEX */
--- texk/xdvik/special.c.orig	2008-02-16 21:43:15 UTC
+++ texk/xdvik/special.c
@@ -691,6 +691,12 @@ static size_t g_bbox_info_max_size = 0;
   contains these coordinates.
 */
 
+double	bbox_matrix[2][2] = {{1.0, 0.0}, {0.0, 1.0}};
+Boolean	bbox_scaled = False, bbox_rotated = False;
+
+#define	bbox_xscale	bbox_matrix[0][0]
+#define	bbox_yscale	bbox_matrix[1][1]
+
 static void
 append_bbox_info(int x, int y, int w, int h, int angle)
 {
@@ -735,25 +741,25 @@ draw_bbox0(int xcorner, int ycorner)
 	    do_color_change();
 #endif
 
-	if (bbox_angle == 0) {
-	    ycorner -= bbox_voffset;
-	    XDrawRectangle(DISP, currwin.win, globals.gc.high, xcorner, ycorner, bbox_width, bbox_height);
+	if (! bbox_rotated) {
+	    ycorner -= bbox_voffset * bbox_yscale;
+	    XDrawRectangle(DISP, currwin.win, globals.gc.high, xcorner, ycorner,
+			   bbox_width * bbox_xscale, bbox_height * bbox_yscale);
 	    if (resource.postscript == 0) {
 		if (htex_inside_href) {
-		    htex_set_anchorsize(xcorner, ycorner, xcorner + bbox_width, ycorner + bbox_height);
+		    htex_set_anchorsize(xcorner, ycorner, xcorner + bbox_width * bbox_xscale,
+					ycorner + bbox_height * bbox_yscale);
 		    htex_set_objecttype(HTEX_IMG);
 		}
 	    }
 	}
 	else {
-	    float sin_a = sin(bbox_angle * (TWOPI / 360));
-	    float cos_a = cos(bbox_angle * (TWOPI / 360));
 	    float a, b, c, d;
 
-	    a = cos_a * bbox_width;
-	    b = -sin_a * bbox_width;
-	    c = -sin_a * bbox_height;
-	    d = -cos_a * bbox_height;
+	    a = bbox_matrix[0][0] * bbox_width;
+	    b = bbox_matrix[1][0] * bbox_width;
+	    c = -bbox_matrix[0][1] * bbox_height;
+	    d = -bbox_matrix[1][1] * bbox_height;
 
 	    XDrawLine(DISP, currwin.win, globals.gc.high,
 		      xcorner, ycorner,
@@ -782,27 +788,27 @@ display_bboxes(void)
     size_t i;
     
     for (i = 0; i < g_bbox_info_size; i++) {
-	if (globals.debug & DBG_PS) {
-	    fprintf(stderr, "drawing bbox %lu at %d %d, %d x %d, angle %d\n",
-		    (unsigned long)i,
-		    g_bbox_info[i].x,
-		    g_bbox_info[i].y,
-		    g_bbox_info[i].w,
-		    g_bbox_info[i].h,
-		    g_bbox_info[i].angle);
-	}
+       if (globals.debug & DBG_PS) {
+           fprintf(stderr, "drawing bbox %lu at %d %d, %d x %d, angle %d\n",
+                   (unsigned long)i,
+                   g_bbox_info[i].x,
+                   g_bbox_info[i].y,
+                   g_bbox_info[i].w,
+                   g_bbox_info[i].h,
+                   g_bbox_info[i].angle);
+       }
 #if 0
-	XDrawRectangle(DISP, currwin.win, globals.gc.high,
-		       g_bbox_info[i].x,
-		       g_bbox_info[i].y,
-		       g_bbox_info[i].w,
-		       g_bbox_info[i].h);
+       XDrawRectangle(DISP, currwin.win, globals.gc.high,
+                      g_bbox_info[i].x,
+                      g_bbox_info[i].y,
+                      g_bbox_info[i].w,
+                      g_bbox_info[i].h);
 #else
-	bbox_valid = True;
-	bbox_width = g_bbox_info[i].w;
-	bbox_height = bbox_voffset = g_bbox_info[i].h;
-	bbox_angle = g_bbox_info[i].angle;
-	draw_bbox0(g_bbox_info[i].x, g_bbox_info[i].y + bbox_height);
+       bbox_valid = True;
+       bbox_width = g_bbox_info[i].w;
+       bbox_height = bbox_voffset = g_bbox_info[i].h;
+       bbox_angle = g_bbox_info[i].angle;
+       draw_bbox0(g_bbox_info[i].x, g_bbox_info[i].y + bbox_height);
 #endif
     }
     bbox_angle = 0;
@@ -829,6 +835,9 @@ save_bbox(void)
 	
 	ycorner -= bbox_voffset;
 	append_bbox_info(xcorner, ycorner, bbox_width, bbox_height, bbox_angle);
+	if (currwin.win == mane.win && resource.postscript != 1) {
+	    draw_bbox();
+	}
 
 	/* register boundaries of this box as anchor boundaries */
 	if (htex_inside_href) {
@@ -907,6 +916,11 @@ ps_startup2(void)
 }
 
 
+typedef struct {
+  double matrix[2][2];
+  double x, y;
+} ROTATE_STACK;
+
 /*
  * dumb parsing of PostScript - search for rotation H. Zeller 1/97
  * Returns true if we find a potentially non-supported command that
@@ -916,6 +930,52 @@ static Boolean
 ps_parseraw(const char *PostScript_cmd)
 {
     const char *p;
+    double xscale, yscale, angle, sin_a, cos_a, a, b, c, d;
+    int n;
+    static int rotate_stack_len = 0;
+    static int rotate_stack_ptr = 0;
+    static ROTATE_STACK *rotate_stack = NULL;
+
+    p = strstr(PostScript_cmd, "currentpoint grestore moveto");
+    if (p != NULL) {
+	if (rotate_stack_ptr > 0) {
+	    double r;
+	    rotate_stack_ptr--;
+	    r = sqrt(((DVI_H - rotate_stack[rotate_stack_ptr].x)
+		      * (DVI_H - rotate_stack[rotate_stack_ptr].x)
+		      + (DVI_V - rotate_stack[rotate_stack_ptr].y)
+		      * (DVI_V - rotate_stack[rotate_stack_ptr].y))
+		     / (bbox_matrix[0][0] * bbox_matrix[0][0]
+			+ bbox_matrix[1][0] * bbox_matrix[1][0]))
+		* (rotate_stack[rotate_stack_ptr].matrix[0][0]
+		   * bbox_matrix[1][0]
+		   - rotate_stack[rotate_stack_ptr].matrix[1][0]
+		   * bbox_matrix[0][0])
+		/ (rotate_stack[rotate_stack_ptr].matrix[0][0]
+		   * rotate_stack[rotate_stack_ptr].matrix[0][0]
+		   + rotate_stack[rotate_stack_ptr].matrix[1][0]
+		   * rotate_stack[rotate_stack_ptr].matrix[1][0]);
+	    DVI_H += r * rotate_stack[rotate_stack_ptr].matrix[1][0];
+	    DVI_V += r * rotate_stack[rotate_stack_ptr].matrix[0][0];
+	    PXL_V = pixel_conv(DVI_V);
+	    bcopy(rotate_stack[rotate_stack_ptr].matrix, bbox_matrix,
+		  sizeof(bbox_matrix));
+	    bbox_rotated
+		= (bbox_matrix[0][1] != 0.0 || bbox_matrix[1][0] != 0.0)
+		? True : False;
+	    bbox_scaled
+		= (bbox_rotated
+		   || bbox_matrix[0][0] != 1.0 || bbox_matrix[1][1] != 1.0)
+		? True : False;
+	}
+	if (globals.debug & DBG_PS)
+	    fprintf(stderr, "current angle %f: %s\n",
+		    bbox_matrix[0][0] != 0
+		    ? -atan(bbox_matrix[1][0] / bbox_matrix[0][0])
+		    * (360 / TWOPI)
+		    : bbox_matrix[1][0] >= 0 ? (double)90 : (double)-90,
+		    PostScript_cmd);
+    }
 
     bbox_angle = 0;
     p = strstr(PostScript_cmd, "rotate");
@@ -924,9 +984,137 @@ ps_parseraw(const char *PostScript_cmd)
 	    --p;
 	while (*p != '\0' && isdigit((int)*p))
 	    --p;
+	if (*p == '.') --p;
+	while (*p != '\0' && isdigit(*p)) --p;
 	if (*p != '+' && *p != '-')
 	    ++p;
-	sscanf(p, "%d neg rotate", &bbox_angle);
+	n = sscanf(p, "%lf neg rotate", &angle);
+	if (n != 1) {
+	    fprintf(stderr, "%s:  cannot get angle.\n", globals.program_name);
+	    angle = 0.0;
+	}
+	bbox_angle = angle;
+	if (rotate_stack_ptr >= rotate_stack_len) {
+	    rotate_stack_len += 0x10;
+	    rotate_stack = (ROTATE_STACK *)
+		xrealloc(rotate_stack,
+			 sizeof(ROTATE_STACK) * rotate_stack_len);
+	}
+	bcopy(bbox_matrix, rotate_stack[rotate_stack_ptr].matrix,
+	      sizeof(bbox_matrix));
+	rotate_stack[rotate_stack_ptr].x = DVI_H;
+	rotate_stack[rotate_stack_ptr].y = DVI_V;
+	rotate_stack_ptr++;
+
+	sin_a = sin(-angle * (TWOPI / 360));
+	cos_a = cos(-angle * (TWOPI / 360));
+	a =   bbox_matrix[0][0] * cos_a + bbox_matrix[0][1] * sin_a;
+	b = - bbox_matrix[0][0] * sin_a + bbox_matrix[0][1] * cos_a;
+	c =   bbox_matrix[1][0] * cos_a + bbox_matrix[1][1] * sin_a;
+	d = - bbox_matrix[1][0] * sin_a + bbox_matrix[1][1] * cos_a;
+	bbox_matrix[0][0] = a;
+	bbox_matrix[0][1] = b;
+	bbox_matrix[1][0] = c;
+	bbox_matrix[1][1] = d;
+	bbox_rotated = (b != 0.0 || c != 0.0) ? True : False;
+	bbox_scaled
+	    = (bbox_rotated
+	       || bbox_matrix[0][0] != 1.0 || bbox_matrix[1][1] != 1.0)
+	    ? True : False;
+	if (globals.debug & DBG_PS)
+	    fprintf(stderr, "current angle %f: %s\n",
+		    bbox_matrix[0][0] != 0
+		    ? -atan(bbox_matrix[1][0] / bbox_matrix[0][0])
+		    * (360 / TWOPI)
+		    : bbox_matrix[1][0] >= 0 ? (double)90 : (double)-90,
+		    PostScript_cmd);
+    }
+
+    p = strstr(PostScript_cmd, "scale");
+    if (p != NULL) {
+	if (strncmp(p - 4, "div", 3) == 0) {
+	    while (*p != '\0' && !isdigit(*p)) --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    if (*p == '.') --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    while (*p != '\0' && !isdigit(*p)) --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    while (*p != '\0' && !isdigit(*p)) --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    if (*p == '.') --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    while (*p != '\0' && !isdigit(*p)) --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    ++p;
+	    n = sscanf(p, "1 %lf div 1 %lf div scale", &xscale, &yscale);
+	    if (n == 2) {
+#ifdef PTEX
+		if(TATE) {
+		    double temp;
+		    temp = xscale;
+		    xscale = 1.0/yscale;
+		    yscale = 1.0/temp;
+		}
+		else {
+		    xscale = 1.0/xscale;
+		    yscale = 1.0/yscale;
+		}
+#else
+		xscale = 1.0/xscale;
+		yscale = 1.0/yscale;
+#endif
+	    } else {
+		fprintf(stderr,
+			"%s:  cannot get scaling factors.\n",
+			globals.program_name);
+		xscale = yscale = 1.0;
+	    }
+	} else {
+	    while (*p != '\0' && !isdigit(*p)) --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    if (*p == '.') --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    while (*p != '\0' && !isdigit(*p)) --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    if (*p == '.') --p;
+	    while (*p != '\0' && isdigit(*p)) --p;
+	    if (*p != '+' && *p != '-') ++p;
+	    n = sscanf(p, "%lf %lf scale", &xscale, &yscale);
+#ifdef PTEX
+	    if(TATE) {
+		double temp;
+		temp = xscale;
+		xscale = yscale;
+		yscale = temp;
+	    }
+#endif
+	    if (n != 2) {
+		fprintf(stderr,
+			"%s:  cannot get scaling factors.\n",
+			globals.program_name);
+		xscale = yscale = 1.0;
+	    }
+	}
+	bbox_matrix[0][0] *= xscale;
+	bbox_matrix[0][1] *= yscale;
+	bbox_matrix[1][0] *= xscale;
+	bbox_matrix[1][1] *= yscale;
+	bbox_scaled
+	    = (bbox_rotated
+	       || bbox_matrix[0][0] != 1.0 || bbox_matrix[1][1] != 1.0)
+	    ? True : False;
+	if (globals.debug & DBG_PS)
+	    fprintf(stderr, "current scale %f,%f: %s\n",
+		    bbox_xscale, bbox_yscale, PostScript_cmd);
+	angle = 0.0;
+	if (strstr(PostScript_cmd, "neg rotate")) {
+	    n = sscanf(p, "%lf neg rotate", &angle);
+	    if (n != 1) {
+		fprintf(stderr, "%s:  cannot get angle. (%s)\n", globals.program_name,p);
+		angle = 0.0;
+	    }
+	}
+	bbox_angle = angle;
 	return True;
     }
     if (strstr(PostScript_cmd, " scale ") != NULL)
@@ -1477,10 +1665,10 @@ psfig_special(char *cp)
 #endif	    
 	/* also raw PostScript, but no extra colon to skip */
 #if PS
-	if (INSIDE_MANE_WIN) {
-	    if (ps_parseraw(cp))
+	if (ps_parseraw(cp) && INSIDE_MANE_WIN)
 		have_raw_postscript = True;
 	    
+	if (INSIDE_MANE_WIN) {
 	    if (psfig_begun)
 		psp.drawraw(cp);
 	    else {
@@ -2325,6 +2513,100 @@ scan_papersize(const char *cp0)
 }
 
 /*
+** Modified 22/3/95.
+*/
+
+typedef struct psh_node {
+    char *this_file;
+    struct psh_node *next;
+} t_pshnode;
+
+static t_pshnode *psh_head = (t_pshnode *) NULL, *psh_tail = (t_pshnode *) NULL;
+
+/*
+** Include one header file.
+*/
+
+static void psh_includehfile(cp, beginning)
+char *cp;
+int beginning;
+
+{
+    static char rawstring[] = " stop\n%%xdvimark\nH userdict begin\0";
+
+    if (!beginning)
+        psp.drawbegin(PXL_H - currwin.base_x, PXL_V - currwin.base_y, "");
+    psp.drawraw(rawstring);
+    send_ps_file(cp, kpse_pict_format);
+    psp.drawend(" end\n");
+}
+
+/*
+** Include all header files.
+*/
+
+void psh_includeall()
+
+{
+    t_pshnode *this_node;
+
+    this_node = psh_head;
+    while (this_node != (t_pshnode *) NULL) {
+	psh_includehfile(this_node->this_file, 1);
+	this_node = this_node->next;
+    }
+}
+
+/*
+** Deal with the "header=<file>" special.
+*/
+
+static void psh_header(cp)
+char *cp;
+
+{
+    t_pshnode *this_node;
+    char *psheader;
+
+    /*
+    ** Find the file.
+    */
+
+    psheader = kpse_find_file ( cp+7, kpse_tex_ps_header_format, true );
+
+    if (psheader) {
+
+        /*
+	** Include the file directly in /userdict.
+	*/
+
+	/* psh_includehfile(psheader, 0); */
+	/* deleted by Kazuaki NAKAYAMA (nakayama@ripms.shinshu-u.ac.jp) */
+
+	/*
+	** Add a new node to the list of header files.
+	*/
+
+	this_node = (t_pshnode *) xmalloc(sizeof(t_pshnode));
+	this_node->this_file = strcpy(xmalloc((strlen(psheader) + 1) * sizeof(char)), psheader);
+	this_node->next = (t_pshnode *) NULL;
+	if (psh_head == (t_pshnode *) NULL)
+	    psh_head = psh_tail = this_node;
+	else {
+	    psh_tail->next = this_node;
+	    psh_tail = this_node;
+	}
+
+    } else
+	XDVI_WARNING((stderr, "Included PostScript header file %s not found", cp + 7));
+}
+
+/*
+** End Modifications
+*/
+
+
+/*
  *	The following copyright message applies to the rest of this file.  --PV
  */
 
@@ -2555,6 +2837,8 @@ applicationDoSpecial(char *cp, size_t le
 	case CMD('b', 'k'):
 	    blacken_last();
 	    return;
+	case CMD('h', 'e'):
+	    psh_header(cp); return;
 	case CMD('i', 'p'):	/* throw away the path -- jansteen */
 	    path_len = 0;
 	    return;
--- texk/xdvik/tests/Makefile.am.orig	2013-03-13 20:24:29 UTC
+++ texk/xdvik/tests/Makefile.am
@@ -22,11 +22,17 @@ run_tests_SOURCES = \
 
 $(run_tests_OBJECTS): ../libxdvi.a $(common_dependencies)
 
-LDADD = ../libxdvi.a $(common_ldadd)
+LDADD = ../libxdvi.a $(common_ldadd) $(FREETYPE2_LIBS) $(ZLIB_LIBS)
 
 ../libxdvi.a: $(libxdvi_dependencies)
 	cd .. && $(MAKE) $(AM_MAKEFLAGS) libxdvi.a
 
+## Rebuild libfreetype
+@FREETYPE2_RULE@
+
+## Rebuild libz
+@ZLIB_RULE@
+
 ## Not used
 ##
 EXTRA_DIST = test1.c
--- texk/xdvik/texmf/XDvi.orig	2012-03-28 14:46:30 UTC
+++ texk/xdvik/texmf/XDvi
@@ -21,7 +21,7 @@
 !!! and greater flexibility for shrink values. Generating MF fonts shouldn't be an
 !!! issue when using T1lib.
 !*mfMode: ljfour
-*paper: a4
+*paper: libpaper
 
 !!! This should be the best choice for modern displays with large color depth.
 *thorough: true
@@ -118,14 +118,14 @@ Ctrl<Btn5Down>:set-shrink-factor(-)\n\
 
 
 !!! help topics label for Xaw
-*help_label.font: -*-helvetica-bold-r-*-*-14-*-*-*-*-*-*-*
+*help_label.font: -*-*-bold-r-*-*-14-*-*-*-*-*-*-*
 
 !!!------------------------------------------------------------------------------
 !!!-------------------------------- Motif tooltips ------------------------------
 !!!------------------------------------------------------------------------------
 !!! background color and font:
 *tipShell.background: cornsilk
-*tipShell.fontSet: -*-helvetica-medium-r-*-*-12-*-*-*-*-*-*
+*tipShell.fontSet: -*-*-medium-r-*-*-12-*-*-*-*-*-*-*
 
 !!! time the mouse needs to stay on a button until tooltips pop up,
 !!! in milliseconds; set to a negative value to disable:
@@ -133,11 +133,22 @@ Ctrl<Btn5Down>:set-shrink-factor(-)\n\
 
 
 !!!------------------------------------------------------------------------------
+!!!-------------------------------- Xaw i18n ------------------------------------
+!!!------------------------------------------------------------------------------
+!!! note: when i18n'ed, *font and *fontSet should have same size of font
+*international: true
+*inputMethod: kinput2
+*preeditType: OverTheSpot,OffTheSpot,Root
+!!! note: xdviSelFile can not be i18n'ed (bug?)
+xdviSelFile*international: false
+
+
+!!!------------------------------------------------------------------------------
 !!!------------------------------ Fonts and colors ------------------------------
 !!!------------------------------------------------------------------------------
-*font:     -*-helvetica-medium-r-*-*-12-*-*-*-*-*-*
+*font:     -*-*-medium-r-*-*-12-*-*-*-*-*-*-*
 !!! Use a smaller font for the statusline in the Xaw version:
-*statusline.font: -*-helvetica-medium-r-*-*-10-*-*-*-*-*-*
+*statusline.font: -*-*-medium-r-*-*-10-*-*-*-*-*-*-*
 
 !!! Motif fonts. Meaning of the tags is:
 !!! NORMAL: Ordinary text, labels etc.
@@ -147,11 +158,11 @@ Ctrl<Btn5Down>:set-shrink-factor(-)\n\
 !!! TOPIC_HEADING: Heading for help text in help window
 !!!
 *fontList: \
--*-helvetica-medium-r-*-*-12-*-*-*-*-*-*-*=NORMAL,\
--*-helvetica-medium-r-*-*-12-*-*-*-*-*-*-*=UNMARKED,\
--*-helvetica-bold-r-*-*-12-*-*-*-*-*-*-*=MARKED,\
--*-helvetica-bold-r-*-*-12-*-*-*-*-*-*-*=TOPIC_LABEL,\
--*-helvetica-bold-r-*-*-14-*-*-*-*-*-*-*=TOPIC_HEADING
+-*-*-medium-r-*-*-12-*-*-*-*-*-*-*=NORMAL,\
+-*-*-medium-r-*-*-12-*-*-*-*-*-*-*=UNMARKED,\
+-*-*-bold-r-*-*-12-*-*-*-*-*-*-*=MARKED,\
+-*-*-bold-r-*-*-12-*-*-*-*-*-*-*=TOPIC_LABEL,\
+-*-*-bold-r-*-*-14-*-*-*-*-*-*-*=TOPIC_HEADING
 
 
 !!! Color used for page border, image bounding boxes and the ruler in `Ruler mode'.
--- texk/xdvik/texmf/config.xdvi.orig	2013-04-03 06:32:57 UTC
+++ texk/xdvik/texmf/config.xdvi
@@ -37,4 +37,43 @@
 % because psfonts.map is (normally) a generated file (by the updmap
 % script).  Instead, map files should be added to the updmap.cfg file.
 %
+% pTeX Extensions:
+%
+% "x" and "x+" reads pTeX map file.
+%
+%	x kanjix.map
+%
+% "r" adds an entry into font replacement dictionary.
+%
+%	r FONT1 FONT2
+%
 % p psfonts.map
+x+ xdvi-ptex.map
+r H               JIS-H
+r V               JIS-V
+r UniJIS-UTF16-H  Unicode-H
+r UniJIS-UTF16-V  Unicode-V
+r UniJIS-UCS2-H   Unicode-H
+r UniJIS-UCS2-V   Unicode-V
+r UniJIS2004-UTF16-H      Unicode-H
+r UniJIS2004-UTF16-V      Unicode-V
+r UniKS-UTF16-H   Unicode-H
+r UniKS-UTF16-V   Unicode-V
+r UniKS-UCS2-H    Unicode-H
+r UniKS-UCS2-V    Unicode-V
+r UniGB-UTF16-H   Unicode-H
+r UniGB-UTF16-V   Unicode-V
+r UniGB-UCS2-H    Unicode-H
+r UniGB-UCS2-V    Unicode-V
+r UniCNS-UTF16-H  Unicode-H
+r UniCNS-UTF16-V  Unicode-V
+r UniCNS-UCS2-H   Unicode-H
+r UniCNS-UCS2-V   Unicode-V
+r Ryumin-Light		ipam.ttf/AJ16
+r GothicBBB-Medium	ipag.ttf/AJ16
+r MSung-Light		bsmi00lp.ttf
+r MHei-Medium		bkai00mp.ttf
+r STSong-Light		gbsn00lp.ttf
+r STHeitiStd-Regular	gkai00mp.ttf
+r HYSMyeongJo-Medium	UnBatang.ttf
+r HYGoThic-Medium		UnDotum.ttf
--- texk/xdvik/texmf/pxdvi.cfg.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/texmf/pxdvi.cfg
@@ -0,0 +1,109 @@
+% original xdvi.cfg -- Configuration file for the Type1 rendering module of xdvi.
+% (If you change or delete `original' in the first line of this file,
+% new xdvik installations won't overwrite the file.)
+%
+% Lines starting with `%' are comments.
+%
+% This file is not suitable for teTeX versions before 1.0.  Users of
+% such or non-teTeX installations should have a look at the following
+% files instead:
+%
+% ../texmf-alt/xdvi.cfg
+% ../README.t1fonts
+%
+% For using this file with teTeX-1.0.x, please uncomment the line with
+% `psfonts.map' (preserving the order of the lines).
+%
+% For any later version of teTeX, no modification is needed.
+%
+
+% File version 1.2
+% Original version by Nicolai Langfeldt 2001/06/05
+% Changes by Thomas Esser for teTeX, Sat Nov  3 23:33:54 CET 2001.
+
+% =============== Section 1: Encodings ===============
+%
+% Here we list all the encodings we want xdvi to recognize as an
+% "implied" encoding. This means that a font named `ptmr8r' will
+% be treated as font `ptmr' encoded with `8r', and `ptmr8y' as
+% `ptmr' encoded with `8y'. Fonts that don not follow this convention
+% must have an explicit encoding entry in the map file.
+%
+% The encoding files used by xdvi are similar to those used by dvips,
+% whith the important exception that xdvi _cannot_ parse postscript,
+% so the vectors mustn't require postscript execution.
+
+%Keyword	Suffix	Encoding name		Defined by this file
+enc		8r	TeXBase1Encoding	8r.enc
+enc		8c	CorkEncoding		cork.enc
+enc		8y	TeXnANSIEncoding	texnansi.enc
+
+
+
+% =============== Section 2: Map files ===============
+%
+% A font map file is a mapping of TeX font names (and encodings) to
+% Postscript Type1 font names, similar to dvips' psfonts.map. See the
+% dvips documentation for more information about the font map file
+% format, and the file `README.t1fonts' in the xdvik source
+% distribution for information on the differences between dvips and
+% xdvik font maps.
+%
+% Multiple map files are allowed. If a font entry is found in several
+% files, later entries will override earlier ones (and a warning
+% will be printed to stderr). 
+%
+% However, normally it isn't necessary to add any other map file here
+% because ps2pk.map is (normally) a generated file (by the updmap
+% script).  Instead, map files should be added to the updmap.cfg file.
+%
+% ps2pk has no "built-in" fonts, just like xdvik, so its map file is used
+% for xdvik too. For teTeX-1.0, psfonts.map is needed in addition.
+
+% dvipsmap psfonts.map
+dvipsmap ps2pk.map
+
+% =============== Section 3: pTeX Map files ===============
+
+replace H               JIS-H
+replace V               JIS-V
+replace UniJIS-UTF16-H  Unicode-H
+replace UniJIS-UTF16-V  Unicode-V
+replace UniJIS-UCS2-H   Unicode-H
+replace UniJIS-UCS2-V   Unicode-V
+replace UniJIS2004-UTF16-H      Unicode-H
+replace UniJIS2004-UTF16-V      Unicode-V
+replace UniKS-UTF16-H   Unicode-H
+replace UniKS-UTF16-V   Unicode-V
+replace UniKS-UCS2-H    Unicode-H
+replace UniKS-UCS2-V    Unicode-V
+replace UniGB-UTF16-H   Unicode-H
+replace UniGB-UTF16-V   Unicode-V
+replace UniGB-UCS2-H    Unicode-H
+replace UniGB-UCS2-V    Unicode-V
+replace UniCNS-UTF16-H  Unicode-H
+replace UniCNS-UTF16-V  Unicode-V
+replace UniCNS-UCS2-H   Unicode-H
+replace UniCNS-UCS2-V   Unicode-V
+
+% Japanese
+% IPA font (http://ossipedia.ipa.go.jp/ipafont/)
+replace Ryumin-Light		ipam.ttf/AJ16
+replace GothicBBB-Medium	ipag.ttf/AJ16
+
+% traditional Chinese
+% Arphic (http://www.ring.gr.jp/pub/GNU/non-gnu/chinese-fonts-truetype/)
+replace MSung-Light		bsmi00lp.ttf
+replace MHei-Medium		bkai00mp.ttf
+
+% simplified Chinese
+% Arphic (http://www.ring.gr.jp/pub/GNU/non-gnu/chinese-fonts-truetype/)
+replace STSong-Light		gbsn00lp.ttf
+replace STHeitiStd-Regular	gkai00mp.ttf
+
+% Korean
+% un-fonts (http://kldp.net/projects/unfonts/)
+replace HYSMyeongJo-Medium	UnBatang.ttf
+replace HYGoThic-Medium		UnDotum.ttf
+
+ptexmap kanjix.map
--- texk/xdvik/tounimap2h.lua.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/tounimap2h.lua
@@ -0,0 +1,80 @@
+-- Copyright (c) 2011-2013 Hironori KITAGAWA
+--
+-- Permission is hereby granted, free of charge, to any person
+-- obtaining a copy of this software and associated documentation
+-- files (the "Software"), to deal in the Software without
+-- restriction, including without limitation the rights to use, copy,
+-- modify, merge, publish, distribute, sublicense, and/or sell copies
+-- of the Software, and to permit persons to whom the Software is
+-- furnished to do so, subject to the following conditions:
+--
+-- The above copyright notice and this permission notice shall be
+-- included in all copies or substantial portions of the Software.
+--
+-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+-- EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+-- MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+-- NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
+-- BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
+-- ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+-- CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+-- SOFTWARE.
+
+-- usage: tounimap2h.lua <ToUniCode> <function name> <end cid number>
+
+local result = {}
+print("/* This file was generated by tounimap2h.lua.\n"
+	     .. "Used ToUnicode table is: " .. arg[1] .. ".*/\n")
+local line = io.read("*l")
+local function info(a) io.stderr:write(a) end
+
+local function bfchar() 
+   info('*')
+   line = io.read("*l")
+   while  line and line ~= "endbfchar" do
+      if string.len(line) == 13 then
+	 local cid = tonumber(string.sub(line,2,5), 16); 
+	 local code = tonumber(string.sub(line,9,12), 16); 
+	 result[cid] = code
+      end
+      line = io.read()
+   end
+end
+local function bfrange() 
+   info('+')
+   line = io.read("*l")
+   while  line and line ~= "endbfrange" do
+      if string.len(line) == 20 then
+	 local cidb = tonumber(string.sub(line,2,5), 16); 
+	 local cide = tonumber(string.sub(line,9,12), 16); 
+	 local code = tonumber(string.sub(line,16,19), 16); 
+	 for x = cidb, cide do result[x] = code+x-cidb end
+      end
+      line = io.read()
+   end
+end
+
+while  line do
+   if string.match(line,"beginbfchar") then
+      bfchar()
+   elseif string.match(line,"beginbfrange") then
+      bfrange()
+   elseif line~="" then 
+      info("-")
+   end
+   line = io.read()
+end
+
+info("\n")
+
+print("static unsigned short " .. arg[2] .. "2uni_table[] = {")
+
+for x=0,arg[3] do 
+   if x%10==0 then io.write("  ") end
+   io.write((result[x] or 0) .. ', ')
+   if x%10 == 9 then io.write("\n")  end
+end
+
+print("}; \n")
+
+print("#define " .. arg[2] .. "2uni(cid) (" .. arg[2] .. "2uni_table[cid])\n")
--- texk/xdvik/util.c.orig	2014-04-08 18:43:12 UTC
+++ texk/xdvik/util.c
@@ -215,6 +215,7 @@ struct debug_string_options debug_option
     {  DBG_GUI,		"gui",		", " },
     {  DBG_FIND,	"find",		", " },
     {  DBG_FILES,	"files",	", " },
+    {  DBG_PTEXFNT,	"ptexfnt",	", " },
     {  DBG_ALL,		"all",		"\n" },
     /* end marker */
     {  0,		NULL,		NULL }
@@ -708,6 +709,38 @@ alloc_bitmap(struct bitmap *bitmap)
     bitmap->bits = xmalloc(size != 0 ? size : 1);
 }
 
+void
+clear_bitmap(struct bitmap *bitmap)
+{
+    memset(bitmap->bits, 0, bitmap->bytes_wide * bitmap->h);
+}
+
+void
+fill_bitmap(struct bitmap *bitmap)
+{
+    memset(bitmap->bits, 0xff, bitmap->bytes_wide * bitmap->h);
+}
+
+void
+order_reverse_bitmap(struct bitmap *bitmap)
+{
+    int i, size = bitmap->bytes_wide * bitmap->h;
+    unsigned char *p = (unsigned char *)bitmap->bits;
+    static unsigned char reverse_byte[0x100];
+
+    if (reverse_byte[1] == 0) {  /* init reverse_byte[] */
+	for (i=0; i<0x100; i++) {
+	    int src, dst = 0;
+	    for (src=1; src<0x100; src<<=1) {
+		dst <<= 1;
+		if (i & src) dst |= 1;
+	    }
+	    reverse_byte[i] = dst;
+	}
+    }
+
+    for (i=0; i<size; i++) p[i] = reverse_byte[p[i]];
+}
 
 #ifndef HAVE_MEMICMP
 /*
@@ -1581,6 +1614,8 @@ put_str_int_hash(hashTableT *hashtable, 
 }
 
 
+#if FREETYPE || PS
+
 /*
  *	General AVL tree mechanism.  Search for a node, and return it if found.
  *	Otherwise insert a node.
@@ -1712,6 +1747,8 @@ avladd(const char *key, size_t key_len, 
 	return ap;
 }
 
+#endif /* FREETYPE || PS */
+
 
 /* set globals.dvi_name, globals.dvi_file.dirname and globals.dvi_file.dirlen */
 void
--- texk/xdvik/util.h.orig	2014-04-08 18:43:12 UTC
+++ texk/xdvik/util.h
@@ -73,6 +73,9 @@ extern void prep_fd(int fd, wide_bool no
 
 struct bitmap; /* forward declaration */
 extern void alloc_bitmap(struct bitmap *);
+extern void clear_bitmap(struct bitmap *);
+extern void fill_bitmap(struct bitmap *);
+extern void order_reverse_bitmap(struct bitmap *);
 
 extern char *my_realpath(const char *path, char *real);
 #ifdef HAVE_REALPATH
@@ -150,6 +153,7 @@ typedef hash_table_type hashTableT; /* f
 extern Boolean find_str_int_hash(hashTableT *hashtable, const char *key, size_t *val);
 extern void put_str_int_hash(hashTableT *hashtable, const char *key, size_t val);
 
+#if FREETYPE || PS
 
 /*
  *	AVL tree structures.
@@ -168,6 +172,8 @@ struct avl {		/* generic data structure 
 
 extern struct avl *avladd(const char *, size_t, struct avl **, size_t);
 
+#endif /* FREETYPE || PS */
+
 
 extern Boolean copy_file(const char *from, const char *to);
 extern Boolean copy_fp(FILE *in, FILE *out);
--- texk/xdvik/version.h.orig	2014-04-13 03:58:39 UTC
+++ texk/xdvik/version.h
@@ -3,6 +3,7 @@
 #define VERSION_H_
 
 #define XDVI_VERSION "22.87"
+#define JPVERSION "j1.42-freebsd"
 
 #ifdef MOTIF
 #define XDVI_GUI "(Motif toolkit)"
@@ -13,7 +14,7 @@
 #define	XDVIK_PROGNAME "xdvik"
 #define	XDVI_PROGNAME "xdvi"
 
-#define XDVI_VERSION_INFO XDVI_VERSION" "XDVI_GUI
-#define XDVI_TERSE_VERSION_INFO XDVI_VERSION
+#define XDVI_VERSION_INFO XDVI_VERSION" "JPVERSION" "XDVI_GUI
+#define XDVI_TERSE_VERSION_INFO XDVI_VERSION" "JPVERSION
 
 #endif /* VERSION_H_ */
--- texk/xdvik/vf.c.orig	2008-02-11 22:47:58 UTC
+++ texk/xdvik/vf.c
@@ -126,7 +126,7 @@ read_VF_index(struct font *fontp, wide_b
 	    len = get_bytes(VF_file, 4);
 	    cc = get_bytes(VF_file, 4);
 	    width = get_bytes(VF_file, 4);
-	    if ((resource.omega && cc >= 65536)
+	    if ((resource.omega && cc >= 0x110000)
 		|| (!resource.omega && cc >= 256)) {
 		XDVI_WARNING((stderr, "Virtual character %lu in font %s ignored.",
 			      cc, fontp->fontname));
@@ -141,6 +141,13 @@ read_VF_index(struct font *fontp, wide_b
 	}
 	if (resource.omega) {
 	    maxcc = (cc > maxcc) ? cc : maxcc;
+	    if (cc > fontp->maxchar) {
+		int i = 65536 * ((int)(cc / 65536)+1);
+		fontp->macro = xrealloc(fontp->macro, sizeof(struct macro) * i);
+		memset((char *)&fontp->macro[fontp->maxchar+1], 0,
+			(i-fontp->maxchar-1) * sizeof(struct macro));
+		fontp->maxchar = i-1;
+	    }
 	}
 	m = &fontp->macro[cc];
 	m->dvi_adv = width * fontp->dimconv;
--- texk/xdvik/xdvi-debug.h.orig	2013-03-31 05:28:21 UTC
+++ texk/xdvik/xdvi-debug.h
@@ -101,6 +101,7 @@
 #define DBG_GUI			131072
 #define DBG_FIND		262144
 #define DBG_FILES		524288
+#define DBG_PTEXFNT             1048576
 #define	DBG_ALL			(~DBG_BATCH)
 
 /* a mapping of numerical options to descriptive strings, defined in util.c */
--- texk/xdvik/xdvi-ptex.map.orig	2015-07-19 18:49:42 UTC
+++ texk/xdvik/xdvi-ptex.map
@@ -0,0 +1,91 @@
+%
+% Sample "xdvi-ptex.map"
+%
+% You can make this file by following process:
+% sed -e 's/ \([VH]\) / JIS-\1 /' \
+%     -e 's/ Uni.*-.*-\([VH]\) / Unicode-\1 /' \
+%     < ../dvipdfmx/cid-x.map > xdvi-ptex.map
+
+% format : "tfm name" "enc" "TTF/TTC/OTF font"
+% "enc" is one of following.
+%   "JIS-H" "Unicode-H" "Identity-H" "AJ16-H"
+%   "JIS-V" "Unicode-V" "Identity-V" "AJ16-V"
+%
+%             tfm      in font
+% JIS-?:      JIS      Unicode or other
+% Unicode-?:  Unicode  Unicode or other
+% AJ16-?:     AJ16     Unicode or other
+% Identity-?: (no conversion)
+
+% If "enc" is "Identity-?" and the end of fontname is "/AJ16",
+% the encoding spec. will be replaced by "AJ16-?". 
+
+% IPA font (http://ossipedia.ipa.go.jp/ipafont/)
+rml	   JIS-H	ipam.ttf
+rmlv	   JIS-V	ipam.ttf
+gbm	   JIS-H	ipag.ttf
+gbmv	   JIS-V	ipag.ttf
+
+fmin	   JIS-H	ipam.ttf,Bold
+fgoth	   JIS-H	ipag.ttf,Bold
+maru	   JIS-H	ipag.ttf,BoldItalic
+
+% OTF package
+otf-ujmr-h  Unicode-H	ipam.ttf
+otf-ujmr-v  Unicode-V	ipam.ttf
+otf-cjmr-h  AJ16-H	ipam.ttf
+otf-cjmr-v  AJ16-V	ipam.ttf
+hminr-h     JIS-H	ipam.ttf
+hminr-v     JIS-V	ipam.ttf
+
+otf-ujgr-h  Unicode-H	ipag.ttf
+otf-ujgr-v  Unicode-V	ipag.ttf
+otf-cjgr-h  Identity-H	ipag.ttf/AJ16
+otf-cjgr-v  Identity-V	ipag.ttf/AJ16
+hgothr-h    JIS-H	ipag.ttf
+hgothr-v    JIS-V	ipag.ttf
+
+otf-ujmb-h  Unicode-H	ipam.ttf,Bold
+otf-ujmb-v  Unicode-V	ipam.ttf,Bold
+otf-cjmb-h  Identity-H	ipam.ttf/AJ16,Bold
+otf-cjmb-v  Identity-V	ipam.ttf/AJ16,Bold
+hminb-h     JIS-H	ipam.ttf,Bold
+hminb-v     JIS-V	ipam.ttf,Bold
+
+otf-ujgb-h  Unicode-H	ipag.ttf,Bold
+otf-ujgb-v  Unicode-V	ipag.ttf,Bold
+otf-cjgb-h  AJ16-H	ipag.ttf,Bold
+otf-cjgb-v  AJ16-V	ipag.ttf,Bold
+hgothb-h    JIS-H	ipag.ttf,Bold
+hgothb-v    JIS-V	ipag.ttf,Bold
+
+otf-ujmgr-h  Unicode-H	ipag.ttf
+otf-ujmgr-v  Unicode-V	ipag.ttf
+otf-cjmgr-h  Identity-H	ipag.ttf/AJ16
+otf-cjmgr-v  Identity-V	ipag.ttf/AJ16
+hmgothr-h    JIS-H	ipag.ttf
+hmgothr-v    JIS-V	ipag.ttf
+
+%% traditional Chinese
+% Arphic (http://www.ring.gr.jp/pub/GNU/non-gnu/chinese-fonts-truetype/)
+otf-utmr-h  Unicode-H	bsmi00lp.ttf
+otf-utmr-v  Unicode-V	bsmi00lp.ttf
+
+otf-utgr-h  Unicode-H	bkai00mp.ttf
+otf-utgr-v  Unicode-V	bkai00mp.ttf
+
+%% simplified Chinese
+% Arphic (http://www.ring.gr.jp/pub/GNU/non-gnu/chinese-fonts-truetype/)
+otf-ucmr-h  Unicode-H	gbsn00lp.ttf
+otf-ucmr-v  Unicode-V	gbsn00lp.ttf
+
+otf-ucgr-h  Unicode-H	gkai00mp.ttf
+otf-ucgr-v  Unicode-V	gkai00mp.ttf
+
+%% Korean
+% un-fonts (http://kldp.net/projects/unfonts/)
+otf-ukmr-h  Unicode-H	UnBatang.ttf
+otf-ukmr-v  Unicode-V	UnBatang.ttf
+
+otf-ukgr-h  Unicode-H	UnDotum.ttf
+otf-ukgr-v  Unicode-V	UnDotum.ttf
--- texk/xdvik/xdvi.h.orig	2014-04-03 01:17:13 UTC
+++ texk/xdvik/xdvi.h
@@ -168,7 +168,7 @@ in xdvi.c.
 #include <X11/Intrinsic.h>
 
 #if HAVE_XI21
-# include <X11/extensions/XInput2.h>	/* for hi-res (smooth) scrolling */
+# include <X11/extensions/XInput2.h>   /* for hi-res (smooth) scrolling */
 #endif
 
 #ifndef MAXPATHLEN
@@ -285,6 +285,10 @@ extern unsigned long time_start, time_en
 #  define OPEN_MODE_ARGS const char *, const char *
 #endif
 
+#ifdef PTEX
+#define	KTABLESIZE	0x10000
+#endif /* PTEX */
+
 #ifndef __LINE__
 #  define __LINE__ 0
 #endif
@@ -335,6 +339,9 @@ struct frame {
     struct framedata {
 	long dvi_h, dvi_v, w, x, y, z;
 	int pxl_v;
+#ifdef PTEX
+	int tdir;
+#endif /* PTEX */
     } data;
     struct frame *next, *prev;
 };
@@ -493,7 +500,7 @@ extern struct x_resources {
 #endif
     Boolean	freetype;
 #if HAVE_XI21
-    Boolean	xi2scrolling;
+    Boolean    xi2scrolling;
 #endif
     const char *src_pos;
     const char *find_string;
@@ -625,6 +632,9 @@ extern struct x_resources {
     /* bitmask of current search window settings */
     unsigned int    search_window_defaults;
     /*     char *    _scroll_pages; */
+#ifdef PTEX
+    char       *ptexmap;
+#endif /* PTEX */
     char       *help_general;
     char       *help_hypertex;
     char       *help_othercommands;
@@ -964,47 +974,46 @@ extern unsigned int color_list_max;	/* a
 extern Boolean color_warned;
 #endif /* COLOR */
 
-
 #if HAVE_XI21
 struct xi2_valinfo {
-	int		number;
-	double		increment;
-	double		lastval;
-	double		lastexact;
-	double		factor;
-	unsigned long	serial;
+       int             number;
+       double          increment;
+       double          lastval;
+       double          lastexact;
+       double          factor;
+       unsigned long   serial;
 };
 
 struct xi2_slave {
-	int		id;			/* slave device id */
-	unsigned int	flags;
-	unsigned char	enabled;
-	unsigned char	btn_mask;	/* buttons corresponding to valuators */
-	struct xi2_valinfo vert, horiz;
-	struct xi2_slave *next;
+       int             id;                     /* slave device id */
+       unsigned int    flags;
+       unsigned char   enabled;
+       unsigned char   btn_mask;       /* buttons corresponding to valuators */
+       struct xi2_valinfo vert, horiz;
+       struct xi2_slave *next;
 };
 
-	/* flag bits */
-# define XI2_SLAVE_VERT			(1<<0)	/* if vert. valuator present */
-# define XI2_SLAVE_HORIZ		(1<<1)	/* if horiz. valuator present */
+       /* flag bits */
+# define XI2_SLAVE_VERT                        (1<<0)  /* if vert. valuator present */
+# define XI2_SLAVE_HORIZ               (1<<1)  /* if horiz. valuator present */
 
 struct xi2_master {
-	int		id;			/* master device id */
-	struct xi2_slave *slave;		/* currently active slave dev */
-	struct xi2_master *next;
+       int             id;                     /* master device id */
+       struct xi2_slave *slave;                /* currently active slave dev */
+       struct xi2_master *next;
 };
 
 
-extern	int		xi2_opcode;
-extern	Boolean		xi2_active;
-extern	struct xi2_master *xi2_masters;		/* linked list of master devs */
-extern	struct xi2_master *xi2_current;		/* current master device */
-extern	struct xi2_slave *xi2_slaves;		/* linked list of slave devs */
+extern int             xi2_opcode;
+extern Boolean         xi2_active;
+extern struct xi2_master *xi2_masters;         /* linked list of master devs */
+extern struct xi2_master *xi2_current;         /* current master device */
+extern struct xi2_slave *xi2_slaves;           /* linked list of slave devs */
 
-extern	struct xi2_slave xi2_no_slave;		/* if no slave assigned yet */
+extern struct xi2_slave xi2_no_slave;          /* if no slave assigned yet */
 
-extern	void	xi2_init_valuators(struct xi2_slave *, XIAnyClassInfo **, int);
-extern	void	xi2_activate(void);
+extern void    xi2_init_valuators(struct xi2_slave *, XIAnyClassInfo **, int);
+extern void    xi2_activate(void);
 
 #endif /* HAVE_XI21 */
 
